<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate f4 statistics — qpdstat • admixtools</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><script src="../extra.js"></script><meta property="og:title" content="Estimate f4 statistics — qpdstat"><meta property="og:description" content="Computes f4-statistics of the form \(f4(A, B; C, D)\). For allele frequencies a, b, c, d, f4(A, B; C, D) is computed as the average of (a-b)*(c-d) over all SNPs in each SNP block. This is equivalent to \((f2(A, D) + f2(B, C) - f2(A, C) - f2(B, D)) / 2\) (assuming no missing data). The input of this function can either be a 3d array of f2-statistics generated by f2_from_precomp or f2_from_geno, a directory with f2-statistics, or the prefix of genotype files. Computing f4 from genotype files directly is slower, but provides more flexibility in dealing with missing data (see details)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-9DRRL9PZD0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9DRRL9PZD0');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">admixtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/admixtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/fstats.html">f-statistics</a>
    </li>
    <li>
      <a href="../articles/graphs.html">Admixture graphs</a>
    </li>
    <li>
      <a href="../articles/io.html">Data formats</a>
    </li>
    <li>
      <a href="../articles/paper.html">Paper notes</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallelization</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/qpadm.html">qpWave and qpAdm</a>
    </li>
    <li>
      <a href="../articles/resampling.html">Standard errors</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/uqrmaie1/admixtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate f4 statistics</h1>
    <small class="dont-index">Source: <a href="https://github.com/uqrmaie1/admixtools/blob/HEAD/R/qpdstat.R" class="external-link"><code>R/qpdstat.R</code></a></small>
    <div class="hidden name"><code>qpdstat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes f4-statistics of the form \(f4(A, B; C, D)\). For allele frequencies <code>a</code>, <code>b</code>, <code>c</code>, <code>d</code>, <code>f4(A, B; C, D)</code> is computed as the average of <code>(a-b)*(c-d)</code> over all SNPs in each SNP block. This is equivalent to \((f2(A, D) + f2(B, C) - f2(A, C) - f2(B, D)) / 2\) (assuming no missing data). The input of this function can either be a 3d array of f2-statistics generated by <code><a href="f2_from_precomp.html">f2_from_precomp</a></code> or <code><a href="f2_from_geno.html">f2_from_geno</a></code>, a directory with f2-statistics, or the prefix of genotype files. Computing f4 from genotype files directly is slower, but provides more flexibility in dealing with missing data (see details).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">qpdstat</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  pop1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop4 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  boot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sure <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  unique_only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  comb <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  blgsize <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  block_lengths <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  f4mode <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  afprod <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cpp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>Input data in one of three forms:</p><ol><li><p>A 3d array of blocked f2 statistics, output of <code><a href="f2_from_precomp.html">f2_from_precomp</a></code> or <code><a href="f2_from_geno.html">f2_from_geno</a></code> (fastest option)</p></li>
<li><p>A directory which contains pre-computed f2-statistics</p></li>
<li><p>The prefix of genotype files (slowest option)</p></li>
</ol></dd>


<dt>pop1</dt>
<dd><p>One of the following four:</p><ol><li><p><code>NULL</code>: all possible population combinations will be returned</p></li>
<li><p>A vector of population labels. All combinations with the other <code>pop</code> arguments will be returned</p></li>
<li><p>A matrix with population combinations to be tested, with one population per column and one
combination per row. Other <code>pop</code> arguments will be ignored.</p></li>
<li><p>the location of a file (<code>poplistname</code> or <code>popfilename</code>) which specifies the populations or
population combinations to be tested. Other <code>pop</code> arguments will be ignored.</p></li>
</ol></dd>


<dt>pop2</dt>
<dd><p>A vector of population labels</p></dd>


<dt>pop3</dt>
<dd><p>A vector of population labels</p></dd>


<dt>pop4</dt>
<dd><p>A vector of population labels</p></dd>


<dt>boot</dt>
<dd><p>If <code>FALSE</code> (the default), block-jackknife resampling will be used to compute standard errors.
Otherwise, block-bootstrap resampling will be used to compute standard errors. If <code>boot</code> is an integer, that number
will specify the number of bootstrap resamplings. If <code>boot = TRUE</code>, the number of bootstrap resamplings will be
equal to the number of SNP blocks.</p></dd>


<dt>sure</dt>
<dd><p>The number of population combinations can get very large. This is a safety option that stops you
from accidently computing all combinations if that number is large.</p></dd>


<dt>unique_only</dt>
<dd><p>If <code>TRUE</code> (the default), redundant combinations will be excluded</p></dd>


<dt>comb</dt>
<dd><p>Generate all combinations of <code>pop1</code>, <code>pop2</code>, <code>pop3</code>, <code>pop4</code>. If <code>FALSE</code>, <code>pop1</code>, <code>pop2</code>, <code>pop3</code>, <code>pop4</code> should all be vectors of the same length.</p></dd>


<dt>blgsize</dt>
<dd><p>SNP block size in Morgan. Default is 0.05 (5 cM). Only used when <code>data</code> is the prefix of genotype files</p></dd>


<dt>block_lengths</dt>
<dd><p>Vector with lengths of each jackknife block. <code>sum(block_lengths)</code> has to
match the number of SNPs. only used when <code>data</code> is the prefix of genotype files</p></dd>


<dt>f4mode</dt>
<dd><p>Set this to <code>FALSE</code> to compute D-statistics instead of f4. This only has an effect if the first argument is a genotype prefix. D-statistics are computed as <code>(a-b)*(c-d) / ((a + b - 2*a*b) * (c + d - 2*c*d))</code>, which is the same as <code>(P(ABBA) - P(BABA)) / (P(ABBA) + P(BABA))</code></p></dd>


<dt>afprod</dt>
<dd><p>Compute f4 from allele frequency products instead of f2 (default <code>TRUE</code>). Only used if <code>data</code> is a directory with precomputed data. For populations with lots of missing data, this option reduces bias that can result from setting <code>maxmiss</code> to values greater than 0. In all other cases it should not make a difference.</p></dd>


<dt>cpp</dt>
<dd><p>Use C++ functions. Setting this to <code>FALSE</code> will be slower but can help with debugging.</p></dd>


<dt>verbose</dt>
<dd><p>Print progress updates</p></dd>


<dt>...</dt>
<dd><p>Additional arguments passed to <code><a href="f4blockdat_from_geno.html">f4blockdat_from_geno</a></code> if <code>data</code> is a genotype file prefix or <code><a href="f2_from_precomp.html">f2_from_precomp</a></code> if <code>data</code> is a directory with f2-statistics</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>qpdstat</code> returns a data frame with f4 statistics</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>f4- and D-statistics are informative about how four populations are related to one another. Estimates of f4 are unbiased as long as assumptions about SNP ascertainment and mutation rates are met. Missing data can violate the ascertainment assumptions: an f4-statistic may be significantly different when it is calculated from all non-missing SNPs, compared to what it would be if it were calculated from all SNPs in the genome. However, because this difference is often small, f4 is often calculated using samples or populations with missing data, on a particular subset of all SNPs. There are different strategies for choosing the SNPs in this case, and these strategies differ in how many SNPs they use, how likely they lead to bias, and whether pre-computed f2-statistics can be used.</p><ul><li><p>Use the same SNPs for every f4-statistic<br>
This is the most conservative option, but also the option which will use the smallest number of SNPs, which may result in a lack of power. It is the default option when pre-computing f2-statistics (<code>maxmiss = 0</code> in <code><a href="extract_f2.html">extract_f2</a></code> or <code><a href="f2_from_geno.html">f2_from_geno</a></code>).</p></li>
<li><p>Use different SNPs for each f4-statistic<br>
This option strikes a balance between avoiding bias and using a larger number of SNPs. For each f4-statistic it selects all SNPs which are present in all four populations. This option only works when the first argument is a genotype prefix (it doesn't work with pre-computed f2-statistics). In that case, this option is used by default. To turn it off and instead use the same SNPs for every f4-statistic, set <code>allsnps = FALSE</code>. This option is the default option in the original qpDstat program (it is in fact the only option for selecting SNPs in the original qpDstat; however in the original qpAdm and qpGraph programs, this mode of selecting SNPs can be enabled with the <code>allsnps</code> option, whereas the default mode in qpAdm and qpGraph is equivalent to <code>maxmiss = 0</code>)</p></li>
<li><p>Use different SNPs for each f2-statistic<br>
This is the least conservative option, but also the option which uses most of the available information. It makes it possible to use pre-computed f2-statistics for a large number of populations without losing a large number of SNPs. To use this option, set the <code>maxmiss</code> parameter to a value greater than 0 (and not larger than 1) in <code><a href="extract_f2.html">extract_f2</a></code> or <code><a href="f2_from_geno.html">f2_from_geno</a></code>. When using this option, be aware that bias is possible, in particular for f4-statistics where some populations have large amounts of missing data. To reduce the bias that can result from using this option, you may want to combine it with using the option <code>afprod = TRUE</code> in <code><a href="f2_from_precomp.html">f2_from_precomp</a></code>.
In summary, whenever you work with populations with missing data, there is no guarantee that f4- or D-statistics involving these populations are not skewed in some way. If you choose to analyze these populations anyway, and you decide which SNPs to use, there is a trade-off between maximizing power and minimizing the risk of bias. One strategy might be to first use the least conservative option (setting <code>maxmiss = 1</code> in <code><a href="extract_f2.html">extract_f2</a></code>) to get an overview, and then spot-check individual results using more conservative options.</p></li>
</ul></div>
    <div id="alias">
    <h2>Alias</h2>
    

<p><code>f4</code></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Patterson, N. et al. (2012) <em>Ancient admixture in human history</em> Genetics</p>
<p>Peter, B. (2016) <em>Admixture, Population Structure, and F-Statistics</em> Genetics</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">pop1</span> <span class="op">=</span> <span class="st">'Denisova.DG'</span></span></span>
<span class="r-in"><span><span class="va">pop2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Altai_Neanderthal.DG'</span>, <span class="st">'Vindija.DG'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pop3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Chimp.REF'</span>, <span class="st">'Mbuti.DG'</span>, <span class="st">'Russia_Ust_Ishim.DG'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pop4</span> <span class="op">=</span> <span class="st">'Switzerland_Bichon.SG'</span></span></span>
<span class="r-in"><span><span class="fu">qpdstat</span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">pop1</span>, <span class="va">pop2</span>, <span class="va">pop3</span>, <span class="va">pop4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pop1        pop2                 pop3  pop4       est      se      z         p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Denisova.DG Altai_Neanderthal.DG Chim… Swit…  1.50<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 4.64<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 32.3   6.06<span style="color: #949494;">e</span><span style="color: #BB0000;">-229</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Denisova.DG Altai_Neanderthal.DG Mbut… Swit…  2.03<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 3.53<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  5.75  8.85<span style="color: #949494;">e</span><span style="color: #BB0000;">-  9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> Denisova.DG Altai_Neanderthal.DG Russ… Swit… -<span style="color: #BB0000;">2.17</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 3.73<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> -<span style="color: #BB0000;">0.580</span> 5.62<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> Denisova.DG Vindija.DG           Chim… Swit…  1.54<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span> 4.78<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 32.2   5.81<span style="color: #949494;">e</span><span style="color: #BB0000;">-228</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> Denisova.DG Vindija.DG           Mbut… Swit…  2.33<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span> 3.63<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  6.42  1.40<span style="color: #949494;">e</span><span style="color: #BB0000;">- 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> Denisova.DG Vindija.DG           Russ… Swit… -<span style="color: #BB0000;">2.40</span><span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> 3.87<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> -<span style="color: #BB0000;">0.620</span> 5.35<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu">qpdstat</span><span class="op">(</span><span class="va">f2_dir</span>, <span class="va">pop1</span>, <span class="va">pop2</span>, <span class="va">pop3</span>, <span class="va">pop4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># compute D-statistics instead</span></span></span>
<span class="r-in"><span><span class="fu">qpdstat</span><span class="op">(</span><span class="st">"/geno/prefix"</span>, <span class="va">pop1</span>, <span class="va">pop2</span>, <span class="va">pop3</span>, <span class="va">pop4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># make a data frame with the population combinations for which f4 should be computed</span></span></span>
<span class="r-in"><span><span class="va">combinations</span> <span class="op">=</span> <span class="fu">tibble</span><span class="op">(</span>pop1 <span class="op">=</span> <span class="va">pop1</span>, pop2 <span class="op">=</span> <span class="va">pop2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, pop3 <span class="op">=</span> <span class="va">pop3</span>, pop4 <span class="op">=</span> <span class="va">pop4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">qpdstat</span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">combinations</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robert Maier, Nick Patterson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'c30b6be96312414d83a0ba52b94b558b',
    indexName: 'admixtools',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

