<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate admixture weights — qpadm • admixtools</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous"><link href="../docsearch.css" rel="stylesheet"><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><script src="../extra.js"></script><meta property="og:title" content="Estimate admixture weights — qpadm"><meta property="og:description" content="qpadm models a target population as a mixture of left (source) populations, given a set of right (outgroup) populations.
It can be used to estimate whether the left populations explain all genetic variation in the target population, relative to the right populations, and to estimate admixture proportions of the left populations to the target population."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-9DRRL9PZD0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9DRRL9PZD0');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">admixtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/admixtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/fstats.html">f-statistics</a>
    </li>
    <li>
      <a href="../articles/graphs.html">Admixture graphs</a>
    </li>
    <li>
      <a href="../articles/io.html">Data formats</a>
    </li>
    <li>
      <a href="../articles/paper.html">Paper notes</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallelization</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/qpadm.html">qpWave and qpAdm</a>
    </li>
    <li>
      <a href="../articles/resampling.html">Standard errors</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/uqrmaie1/admixtools/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul><form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off"></div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate admixture weights</h1>
    <small class="dont-index">Source: <a href="https://github.com/uqrmaie1/admixtools/blob/HEAD/R/qpadm.R" class="external-link"><code>R/qpadm.R</code></a></small>
    <div class="hidden name"><code>qpadm.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>qpadm</code> models a target population as a mixture of left (source) populations, given a set of right (outgroup) populations.
It can be used to estimate whether the left populations explain all genetic variation in the target population, relative to the right populations, and to estimate admixture proportions of the left populations to the target population.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">qpadm</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">left</span>,</span>
<span>  <span class="va">right</span>,</span>
<span>  <span class="va">target</span>,</span>
<span>  f4blocks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fudge <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  fudge_twice <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  boot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  getcov <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  constrained <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_f4 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cpp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>data</dt>
<dd><p>The input data in the form of:</p><ul><li><p>A 3d array of blocked f2 statistics, output of <code><a href="f2_from_precomp.html">f2_from_precomp</a></code> or <code><a href="extract_f2.html">extract_f2</a></code></p></li>
<li><p>A directory with f2 statistics</p></li>
<li><p>The prefix of a genotype file</p></li>
</ul></dd>


<dt>left</dt>
<dd><p>Left populations (sources)</p></dd>


<dt>right</dt>
<dd><p>Right populations (outgroups)</p></dd>


<dt>target</dt>
<dd><p>Target population</p></dd>


<dt>f4blocks</dt>
<dd><p>Instead of f2 blocks, f4 blocks can be supplied. This is used by <code><a href="qpadm_multi.html">qpadm_multi</a></code></p></dd>


<dt>fudge</dt>
<dd><p>Value added to diagonal matrix elements before inverting</p></dd>


<dt>fudge_twice</dt>
<dd><p>Setting this to <code>TRUE</code> should result in p-values that better match those in the original qpAdm program</p></dd>


<dt>boot</dt>
<dd><p>If <code>FALSE</code> (the default), block-jackknife resampling will be used to compute standard errors.
Otherwise, block-bootstrap resampling will be used to compute standard errors. If <code>boot</code> is an integer, that number
will specify the number of bootstrap resamplings. If <code>boot = TRUE</code>, the number of bootstrap resamplings will be
equal to the number of SNP blocks.</p></dd>


<dt>getcov</dt>
<dd><p>Compute weights covariance. Setting <code>getcov = FALSE</code> will speed up the computation.</p></dd>


<dt>constrained</dt>
<dd><p>Constrain admixture weights to be non-negative</p></dd>


<dt>return_f4</dt>
<dd><p>Return f4-statistics</p></dd>


<dt>cpp</dt>
<dd><p>Use C++ functions. Setting this to <code>FALSE</code> will be slower but can help with debugging.</p></dd>


<dt>verbose</dt>
<dd><p>Print progress updates</p></dd>


<dt>...</dt>
<dd><p>If <code>data</code> is the prefix of genotype files, additional arguments will be passed to <code><a href="f4blockdat_from_geno.html">f4blockdat_from_geno</a></code></p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>qpadm</code> returns a list with up to four data frames describing the model fit:</p><ol><li><p><code>weights</code>: A data frame with estimated admixture proportions where each row is a left population.</p></li>
<li><p><code>f4</code>: A data frame with estimated and fitted f4-statistics</p></li>
<li><p><code>rankdrop</code>: A data frame describing model fits with different ranks, including <em>p</em>-values for the overall fit
and for nested models (comparing two models with rank difference of one). A model with <code>L</code> left populations and <code>R</code> right populations has an f4-matrix of dimensions <code>(L-1)*(R-1)</code>. If no two left population form a clade with respect to all right populations, this model will have rank <code>(L-1)*(R-1)</code>.</p><ul><li><p><code>f4rank</code>: Tested rank</p></li>
<li><p><code>dof</code>: Degrees of freedom of the chi-squared null distribution: <code>(L-1-f4rank)*(R-1-f4rank)</code></p></li>
<li><p><code>chisq</code>: Chi-sqaured statistic, obtained as <code>E'QE</code>, where <code>E</code> is the difference between estimated and fitted f4-statistics, and <code>Q</code> is the f4-statistic covariance matrix.</p></li>
<li><p><code>p</code>: p-value obtained from <code>chisq</code> as <code>pchisq(chisq, df = dof, lower.tail = FALSE)</code></p></li>
<li><p><code>dofdiff</code>: Difference in degrees of freedom between this model and the model with one less rank</p></li>
<li><p><code>chisqdiff</code>: Difference in chi-squared statistics</p></li>
<li><p><code>p_nested</code>: <em>p</em>-value testing whether the difference between two models of rank difference 1 is significant</p></li>
</ul></li>
<li><p><code>popdrop</code>: A data frame describing model fits with different populations. Note that all models with fewer populations use the same set of SNPs as the first model.</p><ul><li><p><code>pat</code>: A binary code indicating which populations are present in this model. A <code>1</code> represents dropped populations. The full model is all zeros.</p></li>
<li><p><code>wt</code>: Number of populations dropped</p></li>
<li><p><code>dof</code>: Degrees of freedom of the chi-squared null distribution: <code>(L-1-f4rank)*(R-1-f4rank)</code></p></li>
<li><p><code>chisq</code>: Chi-sqaured statistic, obtained as <code>E'QE</code>, where <code>E</code> is the difference between estimated and fitted f4-statistics, and <code>Q</code> is the f4-statistic covariance matrix.</p></li>
<li><p><code>p</code>: <em>p</em>-value obtained from <code>chisq</code> as <code>pchisq(chisq, df = dof, lower.tail = FALSE)</code></p></li>
<li><p><code>f4rank</code>: Tested rank</p></li>
<li><p><code>feasible</code>: A model is feasible if all weights fall between 0 and 1</p></li>
<li><p><code>&lt;population name&gt;</code>: The weights for each population in this model</p></li>
</ul></li>
</ol></div>
    <div id="references">
    <h2>References</h2>
    <p>Haak, W. et al. (2015) <em>Massive migration from the steppe was a source for Indo-European
languages in Europe.</em> Nature (SI 10)</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="qpwave.html">qpwave</a></code>, <code><a href="lazadm.html">lazadm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">left</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Altai_Neanderthal.DG'</span>, <span class="st">'Vindija.DG'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">right</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Chimp.REF'</span>, <span class="st">'Mbuti.DG'</span>, <span class="st">'Russia_Ust_Ishim.DG'</span>, <span class="st">'Switzerland_Bichon.SG'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">=</span> <span class="st">'Denisova.DG'</span></span></span>
<span class="r-in"><span><span class="fu">qpadm</span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">left</span>, <span class="va">right</span>, <span class="va">target</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ Computing f4 stats...</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ Computing admixture weights...</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ Computing standard errors...</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ Computing number of admixture waves...</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   target      left                 weight    se     z</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> Denisova.DG Altai_Neanderthal.DG   49.6  23.3  2.13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> Denisova.DG Vindija.DG            -<span style="color: #BB0000;">48.6</span>  23.3 -<span style="color: #BB0000;">2.08</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $f4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 36 × 9</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    pop1        pop2        pop3  pop4       est      se       z         p weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> Denisova.DG Altai_Nean… Chim… Mbut…  0.012<span style="text-decoration: underline;">9</span>  3.64<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  35.6   2.22<span style="color: #949494;">e</span><span style="color: #BB0000;">-277</span>   49.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> Denisova.DG Vindija.DG  Chim… Mbut…  0.013<span style="text-decoration: underline;">1</span>  3.73<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  35.0   7.55<span style="color: #949494;">e</span><span style="color: #BB0000;">-269</span>  -<span style="color: #BB0000;">48.6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> Denisova.DG fit         Chim… Mbut…  0.006<span style="text-decoration: underline;">93</span> 6.60<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>   1.05  2.94<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span>   <span style="color: #BB0000;">NA</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> Denisova.DG Altai_Nean… Chim… Russ…  0.015<span style="text-decoration: underline;">2</span>  4.46<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  34.0   4.67<span style="color: #949494;">e</span><span style="color: #BB0000;">-254</span>   49.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> Denisova.DG Vindija.DG  Chim… Russ…  0.015<span style="text-decoration: underline;">6</span>  4.53<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  34.5   2.14<span style="color: #949494;">e</span><span style="color: #BB0000;">-261</span>  -<span style="color: #BB0000;">48.6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> Denisova.DG fit         Chim… Russ… -<span style="color: #BB0000;">0.006</span><span style="color: #BB0000; text-decoration: underline;">42</span> 8.03<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>  -<span style="color: #BB0000;">0.800</span> 4.23<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span>   <span style="color: #BB0000;">NA</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> Denisova.DG Altai_Nean… Chim… Swit…  0.015<span style="text-decoration: underline;">0</span>  4.64<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  32.3   6.06<span style="color: #949494;">e</span><span style="color: #BB0000;">-229</span>   49.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> Denisova.DG Vindija.DG  Chim… Swit…  0.015<span style="text-decoration: underline;">4</span>  4.78<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span>  32.2   5.81<span style="color: #949494;">e</span><span style="color: #BB0000;">-228</span>  -<span style="color: #BB0000;">48.6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> Denisova.DG fit         Chim… Swit… -<span style="color: #BB0000;">0.005</span><span style="color: #BB0000; text-decoration: underline;">52</span> 8.43<span style="color: #949494;">e</span><span style="color: #BB0000;">-3</span>  -<span style="color: #BB0000;">0.654</span> 5.13<span style="color: #949494;">e</span><span style="color: #BB0000;">-  1</span>   <span style="color: #BB0000;">NA</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> Denisova.DG Altai_Nean… Mbut… Chim… -<span style="color: #BB0000;">0.012</span><span style="color: #BB0000; text-decoration: underline;">9</span>  3.64<span style="color: #949494;">e</span><span style="color: #BB0000;">-4</span> -<span style="color: #BB0000;">35.6</span>   2.22<span style="color: #949494;">e</span><span style="color: #BB0000;">-277</span>   49.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 26 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $rankdrop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2 × 7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   f4rank   dof   chisq      p dofdiff chisqdiff p_nested</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span>      1     2    7.15 0.028<span style="text-decoration: underline;">0</span>       4     <span style="text-decoration: underline;">1</span>572.        0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span>      0     6 <span style="text-decoration: underline;">1</span>580.   0           <span style="color: #BB0000;">NA</span>       <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $popdrop</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 3 × 13</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   pat      wt   dof    chisq      p f4rank Altai_Neanderthal.DG Vindija.DG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> 00        0     2     7.15 0.028<span style="text-decoration: underline;">0</span>      1                 49.6      -<span style="color: #BB0000;">48.6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> 01        1     3 <span style="text-decoration: underline;">11</span>412.   0           0                  1         <span style="color: #BB0000;">NA</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> 10        1     3 <span style="text-decoration: underline;">11</span>449.   0           0                 <span style="color: #BB0000;">NA</span>          1  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 5 more variables: feasible &lt;lgl&gt;, best &lt;lgl&gt;, dofdiff &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   chisqdiff &lt;dbl&gt;, p_nested &lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># The original ADMIXTOOLS qpAadm program has an option called "allsnps"</span></span></span>
<span class="r-in"><span><span class="co"># that selects different SNPs for each f4-statistic, which is</span></span></span>
<span class="r-in"><span><span class="co"># useful when working with sparse genotype data.</span></span></span>
<span class="r-in"><span><span class="co"># To get the same behavior in ADMIXTOOLS 2, supply the genotype data prefix</span></span></span>
<span class="r-in"><span><span class="co"># and set `allsnps = TRUE`</span></span></span>
<span class="r-in"><span><span class="fu">qpadm</span><span class="op">(</span><span class="st">"/my/geno/prefix"</span>, <span class="va">left</span>, <span class="va">right</span>, <span class="va">target</span>, allsnps <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Robert Maier, Nick Patterson.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'c30b6be96312414d83a0ba52b94b558b',
    indexName: 'admixtools',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script></body></html>

