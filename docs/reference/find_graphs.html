<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Find well fitting admixture graphs — find_graphs • admixtools</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>


  
  <script src="../extra.js"></script>
<meta property="og:title" content="Find well fitting admixture graphs — find_graphs" />

<meta property="og:description" content="This function generates and evaluates admixture graphs in numgen iterations across numrep independent repeats
to find well fitting admixturegraphs. It uses the function future_map
to parallelize across the independent repeats. The function plan can be called
to specify the details of the parallelization. This can be used to parallelize across cores or across nodes on
a compute cluster. Setting numadmix to 0 will search for well fitting trees, which is much faster than searching
for admixture graphs with many admixture nodes." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-155330476-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155330476-1');
</script>


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">admixtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/admixtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/fstats.html">f-statistics</a>
    </li>
    <li>
      <a href="../articles/graphs.html">Admixture graphs</a>
    </li>
    <li>
      <a href="../articles/io.html">Genotype data</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallelization</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/resampling.html">Standard errors</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Find well fitting admixture graphs</h1>
    
    <div class="hidden name"><code>find_graphs.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function generates and evaluates admixture graphs in <code>numgen</code> iterations across <code>numrep</code> independent repeats
to find well fitting admixturegraphs. It uses the function <code><a href='https://rdrr.io/pkg/furrr/man/future_map.html'>future_map</a></code>
to parallelize across the independent repeats. The function <code><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></code> can be called
to specify the details of the parallelization. This can be used to parallelize across cores or across nodes on
a compute cluster. Setting <code>numadmix</code> to 0 will search for well fitting trees, which is much faster than searching
for admixture graphs with many admixture nodes.</p>
    
    </div>

    <pre class="usage"><span class='fu'>find_graphs</span>(
  <span class='no'>f2_data</span>,
  <span class='kw'>pops</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>outpop</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>numrep</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>numgraphs</span> <span class='kw'>=</span> <span class='fl'>50</span>,
  <span class='kw'>numgen</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>numsel</span> <span class='kw'>=</span> <span class='fl'>5</span>,
  <span class='kw'>numadmix</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>numstart</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>keep</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"all"</span>, <span class='st'>"best"</span>, <span class='st'>"last"</span>),
  <span class='kw'>initgraph</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>mutfuns</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"spr_leaves"</span>, <span class='st'>"spr_all"</span>, <span class='st'>"swap_leaves"</span>, <span class='st'>"move_admixedge_once"</span>,
    <span class='st'>"flipadmix_random"</span>),
  <span class='kw'>store_intermediate</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>parallel</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>stop_after</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>verbose</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>f2_data</th>
      <td><p>A 3d array of blocked f2 statistics, output of <code><a href='f2_from_precomp.html'>f2_from_precomp</a></code>.
alternatively, a directory with precomputed data. see <code><a href='extract_f2.html'>extract_f2</a></code> and <code><a href='extract_counts.html'>extract_counts</a></code>.</p></td>
    </tr>
    <tr>
      <th>pops</th>
      <td><p>Populations for which to fit admixture graphs</p></td>
    </tr>
    <tr>
      <th>outpop</th>
      <td><p>Outgroup population</p></td>
    </tr>
    <tr>
      <th>numrep</th>
      <td><p>Number of independent repetitions (each repetition can be run in parallel)</p></td>
    </tr>
    <tr>
      <th>numgraphs</th>
      <td><p>Number of graphs in each generation</p></td>
    </tr>
    <tr>
      <th>numgen</th>
      <td><p>Number of generations</p></td>
    </tr>
    <tr>
      <th>numsel</th>
      <td><p>Number of graphs which are selected in each generation. Should be less than <code>numgraphs</code>.</p></td>
    </tr>
    <tr>
      <th>numadmix</th>
      <td><p>Number of admixture events within each graph</p></td>
    </tr>
    <tr>
      <th>numstart</th>
      <td><p>Number of random initializations in each call to <code>qpgraph</code>. Defaults to 1, to speed up the graph optimization.</p></td>
    </tr>
    <tr>
      <th>keep</th>
      <td><p>Which models should be returned. One of <code>all</code>, <code>best</code>, <code>last</code></p><ul>
<li><p><code>all</code> (default): Return all evaluated graphs</p></li>
<li><p><code>best</code>: Return only the best fitting graph from each repeat and each generation</p></li>
<li><p><code>last</code>: Return all graphs from the last generation</p></li>
</ul></td>
    </tr>
    <tr>
      <th>initgraph</th>
      <td><p>Optional graph to start with. If <code>NULL</code>, optimization will start with random graphs.</p></td>
    </tr>
    <tr>
      <th>mutfuns</th>
      <td><p>The names of funcations used to modify graphs.</p><ul>
<li><p><code>spr_leaves</code>: Subtree prune and regraft leaves. Cuts a leaf node and attaches it to a random other edge in the graph.</p></li>
<li><p><code>spr_all</code>: Subtree prune and regraft. Cuts any edge and attaches the new orphan node to a random other edge in the graph, keeping the number of admixture nodes constant.</p></li>
<li><p><code>swap_leaves</code>: Swaps two leaf nodes.</p></li>
<li><p><code>move_admixedge_once</code>: Moves an admixture edge to a nearby location.</p></li>
<li><p><code>flipadmix_random</code>: Flips the direction of an admixture edge (if possible).</p></li>
</ul></td>
    </tr>
    <tr>
      <th>store_intermediate</th>
      <td><p>Path and prefix of files for intermediate results to <code>.rds</code>. Can be useful if <code>find_graphs</code> doesn't finish sucessfully.</p></td>
    </tr>
    <tr>
      <th>parallel</th>
      <td><p>Parallelize over repeats (if <code>numrep &gt; 1</code>) or graphs (if <code>numrep == 1</code>) by replacing <code><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></code> with <code><a href='https://rdrr.io/pkg/furrr/man/future_map.html'>future_map</a></code>. Will only be effective if <code><a href='https://rdrr.io/pkg/future/man/plan.html'>plan</a></code> has been set.</p></td>
    </tr>
    <tr>
      <th>stop_after</th>
      <td><p>Stop optimization after <code>stop_after</code> seconds (and after finishing the current generation).</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Print progress updates</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments passed to <code><a href='qpgraph.html'>qpgraph</a></code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A nested data frame with one model per line</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='qpgraph.html'>qpgraph</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='fu'>find_graphs</span>(<span class='no'>example_f2_blocks</span>, <span class='kw'>numrep</span> <span class='kw'>=</span> <span class='fl'>200</span>, <span class='kw'>numgraphs</span> <span class='kw'>=</span> <span class='fl'>100</span>,
            <span class='kw'>numgen</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>numsel</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>numadmix</span> <span class='kw'>=</span> <span class='fl'>3</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert Maier, Nick Patterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '',
    indexName: 'admixtools',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


