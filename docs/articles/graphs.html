<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admixture graphs â€¢ admixtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><script src="../extra.js"></script><meta property="og:title" content="Admixture graphs">
<meta property="og:description" content="admixtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-9DRRL9PZD0"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-9DRRL9PZD0');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">admixtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/admixtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fstats.html">f-statistics</a>
    </li>
    <li>
      <a href="../articles/graphs.html">Admixture graphs</a>
    </li>
    <li>
      <a href="../articles/io.html">Data formats</a>
    </li>
    <li>
      <a href="../articles/paper.html">Paper notes</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallelization</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/qpadm.html">qpWave and qpAdm</a>
    </li>
    <li>
      <a href="../articles/resampling.html">Standard errors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/uqrmaie1/admixtools/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="graphs_files/header-attrs-2.23/header-attrs.js"></script><script src="graphs_files/htmlwidgets-1.5.3/htmlwidgets.js"></script><script src="graphs_files/plotly-binding-4.9.4.1/plotly.js"></script><script src="graphs_files/typedarray-0.1/typedarray.min.js"></script><script src="graphs_files/jquery-3.5.1/jquery.min.js"></script><link href="graphs_files/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="graphs_files/crosstalk-1.1.1/js/crosstalk.min.js"></script><link href="graphs_files/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="graphs_files/plotly-main-1.57.1/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Admixture graphs</h1>
                        <h4 class="author">Robert Maier</h4>
            
            <h4 class="date">2022-11-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/uqrmaie1/admixtools/blob/master/vignettes/graphs.Rmd"><code>vignettes/graphs.Rmd</code></a></small>
      <div class="hidden name"><code>graphs.Rmd</code></div>

    </div>

    
    
<p>Admixture graphs are models of the demographic history of a set of
individuals or populations. Genetic data, in particular
<em>f</em>-statistics, are informative about the topology (the shape)
and the parameters (drift and admixture weights) of a graph, which
allows us to favor some models and to reject others.</p>
<p><em>ADMIXTOOLS 2</em> makes it easy to work with admixture graphs. It
allows you to read and write them in a number of different formats,
create them from scratch, and modify them in a number of ways.</p>
<p><code><a href="../reference/qpgraph.html">qpgraph()</a></code> evaluates a single graph by finding the best
combination of weights for a specific topology.
<code><a href="../reference/find_graphs.html">find_graphs()</a></code> tries to find the best fitting graph
topologies for a set of <em>f</em>-statistics.</p>
<p>In addition to that there are a number of functions for exploring the
topological neighborhood of a graph, to test whether the fits of two
graphs are significantly different from one another, and to simulate
data under any admixture graph.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/uqrmaie1/admixtools">admixtools</a></span><span class="op">)</span></code></pre></div>
<p><br></p>
<div id="graphs-and-f-statistics" class="section level2">
<h2 class="hasAnchor">
<a href="#graphs-and-f-statistics" class="anchor"></a>Graphs and f-statistics</h2>
<p>This section is about the relation between admixture graphs and
<em>f</em>-statistics and assumes that you are familiar with <a href="fstats.html"><em>f</em>-statistics</a>.</p>
<div id="graphs-and-f2" class="section level3">
<h3 class="hasAnchor">
<a href="#graphs-and-f2" class="anchor"></a>Graphs and f2</h3>
<p>Admixture graphs tell us how the genetic drift that separates two
populations (<span class="math inline">\(f_2\)</span>) can be decomposed
into segments that are unique to single populations, and segments that
are shared between multiple populations.</p>
<p>In the graph below, the path between <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> is composed of only two segments (one
unique to <span class="math inline">\(C\)</span> and one unique to <span class="math inline">\(D\)</span>), while the path between <span class="math inline">\(B\)</span> and <span class="math inline">\(D\)</span> is composed of three segments, and the
middle segment (<span class="math inline">\(n1|n2\)</span>) is also part
of paths connecting other population pairs, for example the path from
<span class="math inline">\(B\)</span> to <span class="math inline">\(C\)</span>. (Hovering over the graph will show the
names of the internal nodes.)</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'R'</span>, <span class="st">'R'</span>, <span class="st">'n1'</span>, <span class="st">'n1'</span>, <span class="st">'n2'</span>, <span class="st">'n2'</span>,
             <span class="st">'A'</span>, <span class="st">'n1'</span>, <span class="st">'B'</span>, <span class="st">'n2'</span>, <span class="st">'C'</span>,  <span class="st">'D'</span><span class="op">)</span>, , <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/edges_to_igraph.html">edges_to_igraph</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-9f653dc3f3b7703e4513" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9f653dc3f3b7703e4513">{"x":{"data":[{"x":[1,0.5,null,1,1.5],"y":[1,0,null,1,0],"text":["n2 -> C","n2 -> C",null,"n2 -> D","n2 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[2,1,null,2,1],"text":["n1 -> B","n1 -> B",null,"n1 -> n2","n1 -> n2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[3,2,null,3,2],"text":["R -> A","R -> A",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,1],"y":[3,2,1],"text":["R","n1","n2"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.25,0.75,0.75,1.25],"y":[2.5,2.5,1.5,1.5,0.5,0.5],"text":["","","","","",""],"hovertext":["R -> A","R -> n1","n1 -> B","n1 -> n2","n2 -> C","n2 -> D"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,1.5],"y":[-0.1,-0.1],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[0.9],"text":"B","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,186,56,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[1.9],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(97,156,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[3],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.8,1.8],"tickmode":"array","ticktext":["0","1"],"tickvals":[0,1],"categoryorder":"array","categoryarray":["0","1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.255,3.155],"tickmode":"array","ticktext":["0","1","2","3"],"tickvals":[0,1,2,3],"categoryorder":"array","categoryarray":["0","1","2","3"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130406b78f55b":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"130405234607c":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"130406caa970d":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"1304033a30e37":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"1304015fa575d":{"y":{}},"13040667da5f0":{"x":{},"y":{}}},"cur_data":"130406b78f55b","visdat":{"130406b78f55b":["function (y) ","x"],"130405234607c":["function (y) ","x"],"130406caa970d":["function (y) ","x"],"1304033a30e37":["function (y) ","x"],"1304015fa575d":["function (y) ","x"],"13040667da5f0":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The distance between <span class="math inline">\(B\)</span> and <span class="math inline">\(D\)</span> can be expressed in the following
equations:</p>
<p><span class="math display">\[f_2(B, D) = f_2(n1,B) + f_2(n1,n2) +
f_2(n2,D)\]</span> or in short</p>
<p><span class="math display">\[f_2(B, D) = n1|B + n1|n2 +
n2|D\]</span></p>
<p>(<span class="math inline">\(x|y\)</span> is the edge going from
<span class="math inline">\(x\)</span> to <span class="math inline">\(y\)</span>)</p>
<p>Itâ€™s a special property of <span class="math inline">\(f_2\)</span>-statistics that allows us to break
them down into these components. <span class="math inline">\(F_{ST}\)</span> for example is not additive like
that, so generally <span class="math inline">\(F_{ST}(C, D) \neq
F_{ST}(n1,B) + F_{ST}(n1,n2) + F_{ST}(n2,D)\)</span>.</p>
<p>There are <span class="math inline">\(\frac{k(k-1)}{2}\)</span>
equations for the <span class="math inline">\(f_2\)</span>-statistics of
all population pairs (<span class="math inline">\(k\)</span> is the
number of populations):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/graph_equations.html">graph_equations</a></span><span class="op">(</span><span class="va">g</span>, substitute <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">equations</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   pop1  pop2  equation                           
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                              
## 1 A     B     (`R|A` + `R|n1` + `n1|B`)          
## 2 A     C     (`R|A` + `R|n1` + `n1|n2` + `n2|C`)
## 3 A     D     (`R|A` + `R|n1` + `n1|n2` + `n2|D`)
## 4 B     C     (`n1|B` + `n1|n2` + `n2|C`)        
## 5 B     D     (`n1|B` + `n1|n2` + `n2|D`)        
## 6 C     D     (`n2|C` + `n2|D`)</code></pre>
<p>These equations tell us that the expected <span class="math inline">\(f_2\)</span>-statistics for each pair is the sum
of all edges that separate these two populations. In graphs with
admixture, some population pairs will be connected through two or more
paths. For those population pairs the expected <span class="math inline">\(f_2\)</span> will be a weighted sum of all paths
connecting the two populations, with the weights given by the relative
ancestry proportions.</p>
<p>Here is a simple graph with one admixture event:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'R'</span>, <span class="st">'O'</span>, <span class="st">'R'</span>, <span class="st">'n1'</span>, <span class="st">'n1'</span>, <span class="st">'n2'</span>, <span class="st">'n1'</span>, <span class="st">'n3'</span>, <span class="st">'n2'</span>,
              <span class="st">'B'</span>, <span class="st">'n2'</span>, <span class="st">'n4'</span>, <span class="st">'n3'</span>, <span class="st">'a'</span>, <span class="st">'n3'</span>, <span class="st">'C'</span>, <span class="st">'n4'</span>, <span class="st">'a'</span>,
              <span class="st">'n4'</span>, <span class="st">'D'</span>, <span class="st">'a'</span>, <span class="st">'A'</span><span class="op">)</span>, , <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/edges_to_igraph.html">edges_to_igraph</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-1533ce6e596b2f5a7a6c" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1533ce6e596b2f5a7a6c">{"x":{"data":[{"x":[0,1],"y":[1,0],"text":"n4 -> a","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.5,1],"y":[2,0],"text":"n3 -> a","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[0,-1],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[1,0],"text":"n4 -> D","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,-1,null,-0.5,0,null,1.5,2],"y":[2,1,null,2,1,null,2,1],"text":["n2 -> B","n2 -> B",null,"n2 -> n4","n2 -> n4",null,"n3 -> C","n3 -> C"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.5,null,0.5,1.5],"y":[3,2,null,3,2],"text":["n1 -> n2","n1 -> n2",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,-0.5,1.5,0,1],"y":[4,3,2,2,1,0],"text":["R","n1","n2","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0,1,-0.75,-0.25,1.25,1.75,0.5,0,1],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1,1.5,0.5,0.5,-0.5],"text":["","","","","","","","","","",""],"hovertext":["R -> O","R -> n1","n1 -> n2","n1 -> n3","n2 -> B","n2 -> n4","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-1.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[-0.1],"text":"D","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(163,165,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,2],"y":[0.9,0.9],"text":["B","C"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,125,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[4],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.4,2.4],"tickmode":"array","ticktext":["-1","0","1","2"],"tickvals":[-1,0,1,2],"categoryorder":"array","categoryarray":["-1","0","1","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.355,4.255],"tickmode":"array","ticktext":["-1","0","1","2","3","4"],"tickvals":[-1,0,1,2,3,4],"categoryorder":"array","categoryarray":["-1","0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130407eecde4":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"130404f0f37cd":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"1304070189c47":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"130405fbc32cf":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130403cabe523":{"y":{}},"1304039507bf3":{"x":{},"y":{}}},"cur_data":"130407eecde4","visdat":{"130407eecde4":["function (y) ","x"],"130404f0f37cd":["function (y) ","x"],"1304070189c47":["function (y) ","x"],"130405fbc32cf":["function (y) ","x"],"130403cabe523":["function (y) ","x"],"1304039507bf3":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>To go from <span class="math inline">\(A\)</span> to <span class="math inline">\(C\)</span>, there are now two paths: A short path
through the right admixture edge, and a long path through the left
admixture edges. <span class="math inline">\(f_2(A, C)\)</span> is a
weighted sum of these two paths:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/graph_equations.html">graph_equations</a></span><span class="op">(</span><span class="va">g</span>, substitute <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">equations</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">pop1</span> <span class="op">==</span> <span class="st">'A'</span>, <span class="va">pop2</span> <span class="op">==</span> <span class="st">'C'</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">equation</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "`a` * (`n1|n2` + `n2|n4` + `a|A` + `n1|n3` + `n3|C`) + (1 - `a`) * (`a|A` + `n3|C`)"</code></pre>
<p><span class="math inline">\(a\)</span> is the proportion of admixture
coming through the left admixture edge, and <span class="math inline">\(1-a\)</span> is the proportion coming from the
right.</p>
</div>
<div id="graphs-and-f4" class="section level3">
<h3 class="hasAnchor">
<a href="#graphs-and-f4" class="anchor"></a>Graphs and f4</h3>
<p><span class="math inline">\(f_2\)</span> can be seen as the basic
building block of other <em>f</em>-statistics, but many are more
familiar with <span class="math inline">\(f_4\)</span> and
<em>D</em>-statistics.</p>
<p>To see how <span class="math inline">\(f_4\)</span>- or
<em>D</em>-statistics relate to admixture graphs, letâ€™s assume we have
four populations, and we observe these <span class="math inline">\(f_4\)</span>-statistics:</p>
<p><span class="math display">\[f_4(A,B; C,D) = 0\]</span> <span class="math display">\[f_4(A,C; B,D) = 0.1\]</span></p>
<p><span class="math inline">\(f_4(A,B; C,D) = 0\)</span> suggests that
<span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> form a clade relative to <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span>, and a significantly positive value for
<span class="math inline">\(f_4(A,C; B,D)\)</span> suggests that there
is some amount of genetic drift shared between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> that is not shared by <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> (If <span class="math inline">\(f_4(A,C; B,D)\)</span> were also zero, it would
suggest a star phylogeny). The admixture graph connecting the four
populations could therefore look like this:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'R'</span>, <span class="st">'n1'</span>, <span class="st">'R'</span>, <span class="st">'n2'</span>, <span class="st">'n1'</span>, <span class="st">'A'</span>,
             <span class="st">'n1'</span>, <span class="st">'B'</span>, <span class="st">'n2'</span>, <span class="st">'C'</span>, <span class="st">'n2'</span>, <span class="st">'D'</span><span class="op">)</span>, , <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/edges_to_igraph.html">edges_to_igraph</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-d764156e539fda33d177" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d764156e539fda33d177">{"x":{"data":[{"x":[-1,-1.5,null,-1,-0.5,null,1,0.5,null,1,1.5],"y":[1,0,null,1,0,null,1,0,null,1,0],"text":["n1 -> A","n1 -> A",null,"n1 -> B","n1 -> B",null,"n2 -> C","n2 -> C",null,"n2 -> D","n2 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1,null,0,1],"y":[2,1,null,2,1],"text":["R -> n1","R -> n1",null,"R -> n2","R -> n2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1,1],"y":[2,1,1],"text":["R","n1","n2"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,0.5,-1.25,-0.75,0.75,1.25],"y":[1.5,1.5,0.5,0.5,0.5,0.5],"text":["","","","","",""],"hovertext":["R -> n1","R -> n2","n1 -> A","n1 -> B","n2 -> C","n2 -> D"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,-0.5,0.5,1.5],"y":[-0.1,-0.1,-0.1,-0.1],"text":["A","B","C","D"],"hovertext":["","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1],"y":[2],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.9,1.9],"tickmode":"array","ticktext":["-1","0","1"],"tickvals":[-1,0,1],"categoryorder":"array","categoryarray":["-1","0","1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.205,2.105],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5","2.0"],"tickvals":[0,0.5,1,1.5,2],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5","2.0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130401163585f":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"13040113ecde4":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"13040323f3c94":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"1304055a23251":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"13040b958fc3":{"y":{}},"130408115126":{"x":{},"y":{}}},"cur_data":"130401163585f","visdat":{"130401163585f":["function (y) ","x"],"13040113ecde4":["function (y) ","x"],"13040323f3c94":["function (y) ","x"],"1304055a23251":["function (y) ","x"],"13040b958fc3":["function (y) ","x"],"130408115126":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The distance between the internal nodes <span class="math inline">\(n1\)</span> and <span class="math inline">\(n2\)</span> is given by <span class="math inline">\(f_4(A,C; B,D) = 0.1\)</span>.</p>
<p>An equally plausible admixture graph for this scenario is one in
which <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are not a clade in the strict sense,
but in the sense that there is no overlap between the path from <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> and the path from <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'R'</span>, <span class="st">'R'</span>, <span class="st">'n1'</span>, <span class="st">'n1'</span>, <span class="st">'n2'</span>, <span class="st">'n2'</span>,
             <span class="st">'A'</span>, <span class="st">'n1'</span>, <span class="st">'B'</span>, <span class="st">'n2'</span>, <span class="st">'C'</span>,  <span class="st">'D'</span><span class="op">)</span>, , <span class="fl">2</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/edges_to_igraph.html">edges_to_igraph</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-c16907c8ae4b43615e18" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-c16907c8ae4b43615e18">{"x":{"data":[{"x":[1,0.5,null,1,1.5],"y":[1,0,null,1,0],"text":["n2 -> C","n2 -> C",null,"n2 -> D","n2 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[2,1,null,2,1],"text":["n1 -> B","n1 -> B",null,"n1 -> n2","n1 -> n2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[3,2,null,3,2],"text":["R -> A","R -> A",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,1],"y":[3,2,1],"text":["R","n1","n2"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.25,0.75,0.75,1.25],"y":[2.5,2.5,1.5,1.5,0.5,0.5],"text":["","","","","",""],"hovertext":["R -> A","R -> n1","n1 -> B","n1 -> n2","n2 -> C","n2 -> D"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,1.5],"y":[-0.1,-0.1],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[0.9],"text":"B","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,186,56,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[1.9],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(97,156,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[3],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.8,1.8],"tickmode":"array","ticktext":["0","1"],"tickvals":[0,1],"categoryorder":"array","categoryarray":["0","1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.255,3.155],"tickmode":"array","ticktext":["0","1","2","3"],"tickvals":[0,1,2,3],"categoryorder":"array","categoryarray":["0","1","2","3"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130401afb2d52":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"13040605c7054":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"1304054d2cc38":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"130405b5d9c09":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130405eaf41bb":{"y":{}},"1304044048c8d":{"x":{},"y":{}}},"cur_data":"130401afb2d52","visdat":{"130401afb2d52":["function (y) ","x"],"13040605c7054":["function (y) ","x"],"1304054d2cc38":["function (y) ","x"],"130405b5d9c09":["function (y) ","x"],"130405eaf41bb":["function (y) ","x"],"1304044048c8d":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>This example demonstrates that</p>
<ul>
<li>
<em>f</em>-statistics can be used to find plausible admixture
graphs</li>
<li>multiple different admixture graphs can fit the data equally
well</li>
<li>both the topology, and the parameters of an admixture graph can be
estimated with <em>f</em>-statistics</li>
</ul>
<p>The example also shows that <em>f</em>-statistics cannot tell us
where the root of a graph should be. For that it helps to include an
outgroup in the graph so we know that the root is at the correct
position.</p>
</div>
<div id="f4-ratio-test" class="section level3">
<h3 class="hasAnchor">
<a href="#f4-ratio-test" class="anchor"></a>f4 ratio test</h3>
<div id="htmlwidget-88c9c546af666fd281cb" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-88c9c546af666fd281cb">{"x":{"data":[{"x":[0,1],"y":[1,0],"text":"n4 -> a","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.5,1],"y":[2,0],"text":"n3 -> a","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[0,-1],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[1,0],"text":"n4 -> D","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,-1,null,-0.5,0,null,1.5,2],"y":[2,1,null,2,1,null,2,1],"text":["n2 -> B","n2 -> B",null,"n2 -> n4","n2 -> n4",null,"n3 -> C","n3 -> C"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.5,null,0.5,1.5],"y":[3,2,null,3,2],"text":["n1 -> n2","n1 -> n2",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,-0.5,1.5,0,1],"y":[4,3,2,2,1,0],"text":["R","n1","n2","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0,1,-0.75,-0.25,1.25,1.75,0.5,0,1],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1,1.5,0.5,0.5,-0.5],"text":["","","","","","","","","","",""],"hovertext":["R -> O","R -> n1","n1 -> n2","n1 -> n3","n2 -> B","n2 -> n4","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-1.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[-0.1],"text":"D","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(163,165,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,2],"y":[0.9,0.9],"text":["B","C"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,125,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[4],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.4,2.4],"tickmode":"array","ticktext":["-1","0","1","2"],"tickvals":[-1,0,1,2],"categoryorder":"array","categoryarray":["-1","0","1","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.355,4.255],"tickmode":"array","ticktext":["-1","0","1","2","3","4"],"tickvals":[-1,0,1,2,3,4],"categoryorder":"array","categoryarray":["-1","0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130401909f416":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"130405c77dd31":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"13040415aeb64":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"13040381413c1":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130402e1d00aa":{"y":{}},"130407216b08c":{"x":{},"y":{}}},"cur_data":"130401909f416","visdat":{"130401909f416":["function (y) ","x"],"130405c77dd31":["function (y) ","x"],"13040415aeb64":["function (y) ","x"],"13040381413c1":["function (y) ","x"],"130402e1d00aa":["function (y) ","x"],"130407216b08c":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The <span class="math inline">\(f_4\)</span>-ratio test can be used
to estimate admixture weights (<span class="math inline">\(a\)</span>
and <span class="math inline">\(1-a\)</span>) for one admixed population
using two <span class="math inline">\(f_4\)</span>-statistics from five
populations, assuming that the populations are related as above. As the
name suggests, it estimates an admixture weight <span class="math inline">\(a\)</span> as the ratio of two <span class="math inline">\(f_4\)</span>-statistics, in this case <span class="math inline">\(a = \frac{f_4(B,O;A,C)}{f_4(B,O;D,C)}\)</span>.
Thinking through why this works can help understand how <em>qpGraph</em>
turns <span class="math inline">\(f\)</span>-statistics into estimates
of drift length and admixture weights.</p>
<p>First, <span class="math inline">\(f_4(B,O;D,C)\)</span> is exactly
equal to the distance between <span class="math inline">\(n1\)</span>
and <span class="math inline">\(n2\)</span>, the left blue edge. Thatâ€™s
because <span class="math inline">\(O\)</span> and <span class="math inline">\(C\)</span> form a clade relative to <span class="math inline">\(B\)</span> and <span class="math inline">\(D\)</span>, and this edge is the only connection
between the two clades. (They are not clades in the usual sense of the
word, but in the sense that there is no overlap between the paths from
<span class="math inline">\(O\)</span> to <span class="math inline">\(C\)</span> and the paths from <span class="math inline">\(B\)</span> to <span class="math inline">\(D\)</span>.) At the same time, <span class="math inline">\(f_4(B,O;A,C)\)</span> is the intersection of paths
going from <span class="math inline">\(O\)</span> to <span class="math inline">\(C\)</span>, and from <span class="math inline">\(B\)</span> to <span class="math inline">\(A\)</span>. Now there are two paths going from
<span class="math inline">\(B\)</span> to <span class="math inline">\(A\)</span>: A short one through the left, and a
long one through the right admixture edge. Along the short path going to
<span class="math inline">\(A\)</span> from the left, there is no
intersection with the path from <span class="math inline">\(O\)</span>
to <span class="math inline">\(C\)</span>, so the component of <span class="math inline">\(f_4(B,O;A,C)\)</span> going through that path is
zero. This means that if <span class="math inline">\(f_4(B,O;A,C)\)</span> is not equal to zero, it is
only due to the long path from <span class="math inline">\(B\)</span> to
<span class="math inline">\(A\)</span>. Along that path, the
intersection with <span class="math inline">\(O\)</span> to <span class="math inline">\(C\)</span> is exactly the left blue edge again. We
now have two expressions for the length of that left blue edge: The
first expression is <span class="math inline">\(f_4(O,B;C,D)\)</span>,
and the second expression is <span class="math inline">\(a \times
f_4(O,B;C,A)\)</span>. This allows us to estimate <span class="math inline">\(a\)</span> as <span class="math inline">\(\frac{f_4(O,B;C,A)}{f_4(O,B;C,D)}\)</span>.</p>
<p>For more complex graphs, drift lengths and admixture weights can be
estimated in just the same way, although it is not always possible to
express each estimated parameter as a simple ratio of two
<em>f</em>-statistics. However, even without such simple expression, it
is usually possible estimate graph parameters by numerically finding
solutions to the system of graph equations. <code><a href="../reference/qpgraph.html">qpgraph()</a></code> is
doing just that: It finds the drift and admixture weights for a given
graph which minimize the squared difference between the observed and the
expected <em>f</em>-statistics.</p>
</div>
<div id="graph-as-a-function" class="section level3">
<h3 class="hasAnchor">
<a href="#graph-as-a-function" class="anchor"></a>Graph as a function</h3>
<p>An admixture graph can be seen as a function which maps drift and
admixture weights to <em>f</em>-statistics, using the equations that
describe the graph topology. We can create this function for any graph,
and use this function to see how changing specific edge weights changes
<em>f</em>-statistics.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g_to_f2</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_f2_function.html">graph_f2_function</a></span><span class="op">(</span><span class="va">g</span>, admix_default <span class="op">=</span> <span class="fl">0.5</span>, drift_default <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="fu">g_to_f2</span><span class="op">(</span>`a|A` <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">head</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   pop1  pop2     f2
##   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 A     B      0.25
## 2 A     C      0.25
## 3 A     D      0.25
## 4 A     O      0.35
## 5 B     C      0.4 
## 6 B     D      0.3</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">g_to_f2</span><span class="op">(</span>`a|A` <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">head</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   pop1  pop2     f2
##   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 A     B      0.45
## 2 A     C      0.45
## 3 A     D      0.45
## 4 A     O      0.55
## 5 B     C      0.4 
## 6 B     D      0.3</code></pre>
<p>Similarly, we can see how <span class="math inline">\(f_4\)</span>-statistics are affected by changing
one of the drift weights:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">g_to_f2</span><span class="op">(</span>`a|A` <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/f2dat_f4dat.html">f2dat_f4dat</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">head</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   pop1  pop2  pop3  pop4     f4
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 A     B     A     B      0.25
## 2 A     B     A     C      0.05
## 3 A     B     A     D      0.1 
## 4 A     B     A     O      0.1 
## 5 A     B     B     A     -0.25
## 6 A     B     B     C     -0.2</code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">g_to_f2</span><span class="op">(</span>`a|A` <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/f2dat_f4dat.html">f2dat_f4dat</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">head</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   pop1  pop2  pop3  pop4     f4
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 A     B     A     B      0.45
## 2 A     B     A     C      0.25
## 3 A     B     A     D      0.3 
## 4 A     B     A     O      0.3 
## 5 A     B     B     A     -0.45
## 6 A     B     B     C     -0.2</code></pre>
<p>Usually we are interested in the inverse of this function: We
estimate <em>f</em>-statistics from genetic data and use them to
estimate drift and admixture weights. This is what
<code><a href="../reference/qpgraph.html">qpgraph()</a></code> does.</p>
</div>
<div id="identifiability" class="section level3">
<h3 class="hasAnchor">
<a href="#identifiability" class="anchor"></a>Identifiability</h3>
<p>Each admixture graph can be described by an equation system which
relates drift and admixture weights to <em>f</em>-statistics. This
equation system may be unidentifiable, which means it is not possible to
estimate all the weights at the same time. (In practice we will still
get estimates for unidentifiable weights because of the regularization
terms, but these estimates are often completely arbitrary.)</p>
<p>Consider the following graph, which differs from the earlier graph
only in that population <span class="math inline">\(B\)</span> is
missing:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'R'</span>, <span class="st">'O'</span>, <span class="st">'R'</span>, <span class="st">'n1'</span>, <span class="st">'n1'</span>, <span class="st">'n4'</span>, <span class="st">'n1'</span>, <span class="st">'n3'</span>,
              <span class="st">'n3'</span>, <span class="st">'a'</span>, <span class="st">'n3'</span>, <span class="st">'C'</span>, <span class="st">'n4'</span>, <span class="st">'a'</span>, <span class="st">'n4'</span>, <span class="st">'D'</span>, <span class="st">'a'</span>, <span class="st">'A'</span><span class="op">)</span>, , <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/edges_to_igraph.html">edges_to_igraph</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>fix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-15153c5a6619710ad6bd" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-15153c5a6619710ad6bd">{"x":{"data":[{"x":[1.25,0.25,null,-0.25,0.25],"y":[2,1,null,2,1],"text":["n3 -> a","n3 -> a",null,"n4 -> a","n4 -> a"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25,0.25],"y":[1,0],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,1.25,null,-0.25,-0.75],"y":[2,1,null,2,1],"text":["n3 -> C","n3 -> C",null,"n4 -> D","n4 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.25,null,0.5,1.25],"y":[3,2,null,3,2],"text":["n1 -> n4","n1 -> n4",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,1.25,-0.25,0.25],"y":[4,3,2,2,1],"text":["R","n1","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.125,0.875,0.75,1.25,0,-0.5,0.25],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1.5,1.5,0.5],"text":["","","","","","","","",""],"hovertext":["R -> O","R -> n1","n1 -> n4","n1 -> n3","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25],"y":[-0.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,-0.75],"y":[0.9,0.9],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(124,174,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25],"y":[4],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.05,1.55],"tickmode":"array","ticktext":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"tickvals":[-1,-0.5,0,0.5,1,1.5],"categoryorder":"array","categoryarray":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.305,4.205],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,4],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130405a14c69e":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"130409fbdd46":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"13040767c23c8":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"1304050115c3d":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"1304023bed1dc":{"y":{}},"1304044c3d4d9":{"x":{},"y":{}}},"cur_data":"130405a14c69e","visdat":{"130405a14c69e":["function (y) ","x"],"130409fbdd46":["function (y) ","x"],"13040767c23c8":["function (y) ","x"],"1304050115c3d":["function (y) ","x"],"1304023bed1dc":["function (y) ","x"],"1304044c3d4d9":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>In contrast to the similar example from before, we now have no <span class="math inline">\(f_4\)</span>-statistic which can be interpreted as
the length of an internal edge, because in this graph, no two population
pairs form a clade with each other.</p>
<p><em>ADMIXTOOLS 2</em> can tell us for any admixture graph what the
unidentifiable edges are:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/unidentifiable_edges.html">unidentifiable_edges</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 8 x 3
##   from  to    type 
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 n4    a     admix
## 2 n3    a     admix
## 3 R     O     edge 
## 4 R     n1    edge 
## 5 n1    n4    edge 
## 6 n4    D     edge 
## 7 n1    n3    edge 
## 8 n3    C     edge</code></pre>
<p>In this graph, all of the drift lengths and admixture weights are
unidentifiable.</p>
<p>To see what this means in practice, we simulate data under this
admixture graph, and the test whether we can recover the correct
parameters:</p>
<p>Not providing any additional simulation parameters will default to
all drift edges being of equal length (except the one going to the
outgroup), and all admixture nodes to be in 50/50 proportions.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_f2sim1</span> <span class="op">=</span> <span class="fu"><a href="../reference/f2_from_msprime.html">f2_from_msprime</a></span><span class="op">(</span><span class="va">g</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2sim1</span>, <span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">edges</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>fix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-cdcf31368f8b6609f3ba" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-cdcf31368f8b6609f3ba">{"x":{"data":[{"x":[1.25,0.25,null,-0.25,0.25],"y":[2,1,null,2,1],"text":["n3 -> a","n3 -> a",null,"n4 -> a","n4 -> a"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25,0.25],"y":[1,0],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,1.25,null,-0.25,-0.75],"y":[2,1,null,2,1],"text":["n3 -> C","n3 -> C",null,"n4 -> D","n4 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.25,null,0.5,1.25],"y":[3,2,null,3,2],"text":["n1 -> n4","n1 -> n4",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,1.25,-0.25,0.25],"y":[4,3,2,2,1],"text":["R","n1","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.125,0.875,0.75,1.25,0,-0.5,0.25],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1.5,1.5,0.5],"text":["116","116","38","38","49%","40","51%","40","90"],"hovertext":["R -> O","R -> n1","n1 -> n4","n1 -> n3","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25],"y":[-0.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,-0.75],"y":[0.9,0.9],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(124,174,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25],"y":[4],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.05,1.55],"tickmode":"array","ticktext":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"tickvals":[-1,-0.5,0,0.5,1,1.5],"categoryorder":"array","categoryarray":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.305,4.205],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,4],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"1304069bc3fec":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"130404608d52f":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"130406de42494":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"130401d1da8e9":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"1304063c67ee":{"y":{}},"1304067cb3d74":{"x":{},"y":{}}},"cur_data":"1304069bc3fec","visdat":{"1304069bc3fec":["function (y) ","x"],"130404608d52f":["function (y) ","x"],"130406de42494":["function (y) ","x"],"130401d1da8e9":["function (y) ","x"],"1304063c67ee":["function (y) ","x"],"1304067cb3d74":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>In this case, <code><a href="../reference/qpgraph.html">qpgraph()</a></code> seems to be able to recover most
parameters very well (the weights are 50/50). However, this is because
of the symmetry of this graph. Letâ€™s see what happens if we break the
symmetry by setting the date of population <em>C</em> to zero (close to
the bottom of the plot):</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dates</span> <span class="op">=</span> <span class="fu"><a href="../reference/pseudo_dates.html">pseudo_dates</a></span><span class="op">(</span><span class="va">g</span>, <span class="fl">1000</span><span class="op">)</span>
<span class="va">dates</span><span class="op">[</span><span class="st">'C'</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span>
<span class="va">example_f2sim2</span> <span class="op">=</span> <span class="fu"><a href="../reference/f2_from_msprime.html">f2_from_msprime</a></span><span class="op">(</span><span class="va">g</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span>, time <span class="op">=</span> <span class="va">dates</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2sim2</span>, <span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">edges</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>fix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-34f8655c32ce35fb64cd" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-34f8655c32ce35fb64cd">{"x":{"data":[{"x":[1.25,0.25,null,-0.25,0.25],"y":[2,1,null,2,1],"text":["n3 -> a","n3 -> a",null,"n4 -> a","n4 -> a"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25,0.25],"y":[1,0],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,1.25,null,-0.25,-0.75],"y":[2,1,null,2,1],"text":["n3 -> C","n3 -> C",null,"n4 -> D","n4 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.25,null,0.5,1.25],"y":[3,2,null,3,2],"text":["n1 -> n4","n1 -> n4",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,1.25,-0.25,0.25],"y":[4,3,2,2,1],"text":["R","n1","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.125,0.875,0.75,1.25,0,-0.5,0.25],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1.5,1.5,0.5],"text":["106","106","23","67","26%","74","74%","47","84"],"hovertext":["R -> O","R -> n1","n1 -> n4","n1 -> n3","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25],"y":[-0.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,-0.75],"y":[0.9,0.9],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(124,174,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25],"y":[4],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.05,1.55],"tickmode":"array","ticktext":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"tickvals":[-1,-0.5,0,0.5,1,1.5],"categoryorder":"array","categoryarray":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.305,4.205],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,4],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"13040106b3eea":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"1304070ef7d11":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"130407afc2103":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"130403edb8b09":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130403f851c1c":{"y":{}},"130403bf892d8":{"x":{},"y":{}}},"cur_data":"13040106b3eea","visdat":{"13040106b3eea":["function (y) ","x"],"1304070ef7d11":["function (y) ","x"],"130407afc2103":["function (y) ","x"],"130403edb8b09":["function (y) ","x"],"130403f851c1c":["function (y) ","x"],"130403bf892d8":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Now the estimated admixture weights are very far from the simulated
50/50 proportions. If we ran similar simulations for the graph from
before which includes a fifth population <em>E</em>, so that all edges
are identifiable, we would see that the admixture proportion estimates
are not affected by changing the date of any node.</p>
<p>Unidentifiable edges can be highlighted when plotting a graph, here
shown for a more complex example:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_igraph</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>highlight_unidentifiable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-81bbb363504d1edca7f1" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-81bbb363504d1edca7f1">{"x":{"data":[{"x":[0,2],"y":[-1,-2],"text":"N3N5 -> N3N8","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,1],"y":[0,-1],"text":"N2N3 -> N2N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,0],"y":[1,0],"text":"N3N2 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[2,0],"text":"N3N3 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1,null,2,2],"y":[3,-1,null,3,-2],"text":["N2N2 -> N2N4","N2N2 -> N2N4",null,"N3N7 -> N3N8","N3N7 -> N3N8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,2],"y":[-2,-3],"text":"N3N8 -> Russia_Ust_Ishim.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[-1,-2],"text":"N2N4 -> Mbuti.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[0,-1],"text":"N3N4 -> N3N5","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2],"y":[1,0,null,1,0],"text":["N2N1 -> Vindija.DG","N2N1 -> Vindija.DG",null,"N2N1 -> N2N3","N2N1 -> N2N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,-2.5,null,-2,-1.5],"y":[2,1,null,2,1],"text":["N3N0 -> N2N1","N3N0 -> N2N1",null,"N3N0 -> N3N2","N3N0 -> N3N2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2,null,-0.5,-1,null,-0.5,0],"y":[3,2,null,3,2,null,3,2,null,3,2],"text":["N0N -> Altai_Neanderthal.DG","N0N -> Altai_Neanderthal.DG",null,"N0N -> N3N0","N0N -> N3N0",null,"N3N1 -> Denisova.DG","N3N1 -> Denisova.DG",null,"N3N1 -> N3N3","N3N1 -> N3N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,-2.5,null,-1.5,-0.5,null,1.5,1,null,1.5,2],"y":[4,3,null,4,3,null,4,3,null,4,3],"text":["N1N -> N0N","N1N -> N0N",null,"N1N -> N3N1","N1N -> N3N1",null,"N3N6 -> N2N2","N3N6 -> N2N2",null,"N3N6 -> N3N7","N3N6 -> N3N7"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1.5,null,0,1.5],"y":[5,4,null,5,4],"text":["N2N0 -> N1N","N2N0 -> N1N",null,"N2N0 -> N3N6","N2N0 -> N3N6"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[6,5,null,6,5],"text":["N4N -> N2N0","N4N -> N2N0",null,"N4N -> Switzerland_Bichon.SG","N4N -> Switzerland_Bichon.SG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[7,6,null,7,6],"text":["R -> Chimp.REF","R -> Chimp.REF",null,"R -> N4N","R -> N4N"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-2.5,-1.5,0,-2.5,1,-2,-0.5,0,1.5,2,0.5,1,-1.5,0,-2,0,2],"y":[7,3,4,5,1,-1,2,3,0,4,-2,6,3,1,-1,0,2,3],"text":["R","N0N","N1N","N2N0","N2N1","N2N4","N3N0","N3N1","N3N4","N3N6","N3N8","N4N","N2N2","N3N2","N3N5","N2N3","N3N3","N3N7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,0,null,0,2,null,0,0,null,2,2],"y":[1,0,null,-1,-2,null,2,0,null,3,-2],"text":"","type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"rgba(255,0,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5,null,-2.5,-2,null,-1.5,-0.5,null,0,1.5,null,-2.5,-2,null,1,1,null,-2,-2.5,null,-2,-1.5,null,-0.5,-1,null,-0.5,0,null,0,0,null,1.5,1,null,1.5,2,null,2,2],"y":[7,6,null,7,6,null,3,2,null,4,3,null,5,4,null,1,0,null,-1,-2,null,2,1,null,2,1,null,3,2,null,3,2,null,0,-1,null,4,3,null,4,3,null,-2,-3],"text":"","type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,-2.75,-2.25,-2,-1,-0.75,0.75,-2.75,-2.25,1,-2.25,-1.75,-0.75,-0.25,0,1.25,1.75,2,0.25,0.75,1,-0.75,1,-0.5,0,2],"y":[6.5,6.5,2.5,2.5,3.5,3.5,4.5,4.5,0.5,0.5,-1.5,1.5,1.5,2.5,2.5,-0.5,3.5,3.5,-2.5,5.5,5.5,1,0.5,-1.5,-0.5,1,0.5],"text":["","","","","","","","","","","","","","","","","","","","","","","","","","",""],"hovertext":["R -> Chimp.REF","R -> N4N","N0N -> Altai_Neanderthal.DG","N0N -> N3N0","N1N -> N0N","N1N -> N3N1","N2N0 -> N1N","N2N0 -> N3N6","N2N1 -> Vindija.DG","N2N1 -> N2N3","N2N4 -> Mbuti.DG","N3N0 -> N2N1","N3N0 -> N3N2","N3N1 -> Denisova.DG","N3N1 -> N3N3","N3N4 -> N3N5","N3N6 -> N2N2","N3N6 -> N3N7","N3N8 -> Russia_Ust_Ishim.DG","N4N -> N2N0","N4N -> Switzerland_Bichon.SG","N2N2 -> N2N4","N3N2 -> N3N4","N3N5 -> N3N8","N2N3 -> N2N4","N3N3 -> N3N4","N3N7 -> N3N8"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2],"y":[-3.1],"text":"Russia_Ust_Ishim.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-2.1],"text":"Mbuti.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(216,144,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3],"y":[-0.1],"text":"Vindija.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(57,182,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,-1],"y":[1.9,1.9],"text":["Altai_Neanderthal.DG","Denisova.DG"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[4.9],"text":"Switzerland_Bichon.SG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[5.9],"text":"Chimp.REF","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,98,188,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5],"y":[7],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.6,2.6],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,4.44089209850063e-16,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.605,7.505],"tickmode":"array","ticktext":["-2.5","0.0","2.5","5.0","7.5"],"tickvals":[-2.5,-4.44089209850063e-16,2.5,5,7.5],"categoryorder":"array","categoryarray":["-2.5","0.0","2.5","5.0","7.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130401e7d7bfd":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"1304040572eae":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"130401bb9c282":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{}},"130404090f306":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"130406c433007":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130402f065318":{"y":{}},"13040483964c6":{"x":{},"y":{}}},"cur_data":"130401e7d7bfd","visdat":{"130401e7d7bfd":["function (y) ","x"],"1304040572eae":["function (y) ","x"],"130401bb9c282":["function (y) ","x"],"130404090f306":["function (y) ","x"],"130406c433007":["function (y) ","x"],"130402f065318":["function (y) ","x"],"13040483964c6":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Two patterns in here are very common:</p>
<ol style="list-style-type: decimal">
<li><p>The two edges connected root are not identifiable. We can
estimate how much drift has occurred on these two edges in combination,
but it is not possible to attribute it to either of the two edges. The
penalization terms that are used during the fitting of admixture graphs
will ensure that both edges are always estimated to be of the same
length.</p></li>
<li><p>The drift edges directly adjacent to a admixture edge can not all
be estimated at the same time.</p></li>
</ol>
<p>If a graph has non-identifiable edges, it means that the estimated
values for those edges should be treated with caution. However, the
graph itself can still be a valid model. In particular, the fit of the
graph (likelihood score or worst residual) will not be meaningfully
affected by the presence of non-identifiable edges.</p>
<p>Even if all edges in a graph are identifiable, some estimated
parameters may not be robust, for example if they rely on precise
estimates of short edges in the graph. In this case, <a href="graphs.html#confidence-intervals-1">bootstrap confidence
intervals</a> can be used to find out how robust the parameter estimates
are.</p>
<div id="how-it-works" class="section level4">
<h4 class="hasAnchor">
<a href="#how-it-works" class="anchor"></a>How it works</h4>
<p>Unidentifiable edges can be found by analyzing the <a href="https://en.wikipedia.org/wiki/Jacobian_matrix_and_determinant">Jacobi
matrix</a> of the equation system of a graph. This matrix consists of
the partial derivatives of the graph equations (one for each population
pair) with respect to the parameters (edge weights). It has one row for
each population pair, and one column for each edge in the graph. Each
entry in the matrix is a polynomial which describes how the expected
f2-statistic will change when one of the parameters changes by a small
amount. Ideally, a small change to any of the parameters (a small
increase or decrease in the weight of an edge) will change the set of
all f-statistics in a unique way. If thatâ€™s the case, then every
parameter can be identified (given enough data). The alternative is that
a small change to one of the parameters will lead to a change in the
expected f-statistics which is not unique: we might see the exact same
change in expected f-statistics by making small changes to other
parameters.</p>
<p>To figure out which parameters, when slightly shifted, will lead to
unique changes in f-statistics, we first have to assume concrete values
for all parameters. What those exact values are doesnâ€™t matter, except
for extreme cases, and so we draw them from a uniform distribution. This
gives us a Jacobi matrix which consists of numbers instead of
polynomials. The rank of this matrix tells us how many parameters can in
principle be identified at the same time (assuming that there are more
population pairs than parameters). If this matrix has full rank (the
rank is equal to the number of parameters), all edges can be identified.
If it doesnâ€™t have full rank, it means that at least one edge canâ€™t be
identified. We can then drop each column, one by one, from the matrix,
and test whether the rank of the remaining columns is less than the rank
of the full matrix. If so, it means that we lose information by dropping
that column, and that small shifts to the weight of the edge which
corresponds to that column will shift the f-statistics in a unique way,
making this edge identifiable. Edges for which the rank doesnâ€™t drop
when that column is excluded are unidentifiable.</p>
</div>
</div>
<div id="f-statistics-vs-sfs" class="section level3">
<h3 class="hasAnchor">
<a href="#f-statistics-vs-sfs" class="anchor"></a>f-statistics vs SFS</h3>
<p><em>f</em>-statistics only use a subset of the information contained
in genetic data. They reduce the data to a single estimate of genetic
distance for each population pair. Additional information relevant for
demographic history which is <em>not</em> utilized by
<em>f</em>-statistics includes the joint distribution of allele counts
across populations (joint site frequency spectrum, SFS), and patterns of
linkage disequilibrium.</p>
<p>Methods based on the joint site frequency spectrum have the advantage
that they can distinguish some models which cannot be distinguished
using <em>f</em>-statistics alone. At the same time, the greater
complexity of SFS based methods makes them slower and less robust.</p>
<p>Drift and admixture weights are the only parameters for modeling
admixture graphs using <em>f</em>-statistics. In contrast, SFS-based
methods break genetic drift apart into components for effective
population size, time, and mutation rate. This makes them more powerful,
but also less robust.</p>
<p>The following three graphs cannot be distinguished using only
<em>f</em>-statistics:</p>
<div style="display: flex">
<div style="width: 33%">
<div id="htmlwidget-fa976c93136bb5e8b00c" style="width:100%;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-fa976c93136bb5e8b00c">{"x":{"data":[{"x":[0,-0.5,null,0,0.5],"y":[1,0,null,1,0],"text":["n -> C","n -> C",null,"n -> D","n -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[2,1,null,2,1],"text":["n0 -> n","n0 -> n",null,"n0 -> B","n0 -> B"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[3,2,null,3,2],"text":["R -> A","R -> A",null,"R -> n0","R -> n0"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0,0.5],"y":[3,1,2],"text":["R","n","n0"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,-0.25,0.25,0.25,0.75],"y":[2.5,2.5,0.5,0.5,1.5,1.5],"text":["","","","","",""],"hovertext":["R -> A","R -> n0","n -> C","n -> D","n0 -> n","n0 -> B"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,0.5],"y":[-0.1,-0.1],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[0.9],"text":"B","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,186,56,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[1.9],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(97,156,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[3],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.75,1.25],"tickmode":"array","ticktext":["-0.4","0.0","0.4","0.8","1.2"],"tickvals":[-0.4,0,0.4,0.8,1.2],"categoryorder":"array","categoryarray":["-0.4","0.0","0.4","0.8","1.2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.255,3.155],"tickmode":"array","ticktext":["0","1","2","3"],"tickvals":[0,1,2,3],"categoryorder":"array","categoryarray":["0","1","2","3"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130404d878127":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"130407b304f34":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"1304020a01e1b":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"1304070188f58":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130405c6b13e6":{"y":{}},"1304079e79070":{"x":{},"y":{}}},"cur_data":"130404d878127","visdat":{"130404d878127":["function (y) ","x"],"130407b304f34":["function (y) ","x"],"1304020a01e1b":["function (y) ","x"],"1304070188f58":["function (y) ","x"],"130405c6b13e6":["function (y) ","x"],"1304079e79070":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div style="width: 33%">
<div id="htmlwidget-37d1e85c8c6765677bfc" style="width:100%;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-37d1e85c8c6765677bfc">{"x":{"data":[{"x":[0.25,-0.75],"y":[1,0],"text":"n1b -> n2","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(183,159,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.75,-0.75],"y":[2,0],"text":"nb -> n2","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.75,-0.75],"y":[0,-1],"text":"n2 -> D","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.75,0.25,null,0.75,1.25],"y":[2,1,null,2,1],"text":["n1 -> n1b","n1 -> n1b",null,"n1 -> C","n1 -> C"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.75,null,0,0.75],"y":[3,2,null,3,2],"text":["n -> nb","n -> nb",null,"n -> n1","n -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[4,3,null,4,3],"text":["n0 -> n","n0 -> n",null,"n0 -> B","n0 -> B"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[5,4,null,5,4],"text":["R -> A","R -> A",null,"R -> n0","R -> n0"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(245,100,227,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,0,-0.75,0.75,0.25,-0.75],"y":[5,4,3,2,2,1,0],"text":["R","n0","n","nb","n1","n1b","n2"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.25,-0.375,0.375,-0.75,0.5,1,-0.25,-0.75,0.75],"y":[4.5,4.5,3.5,2.5,2.5,1,1.5,1.5,0.5,-0.5,3.5],"text":["","","","","","","","","","",""],"hovertext":["R -> A","R -> n0","n0 -> n","n -> nb","n -> n1","nb -> n2","n1 -> n1b","n1 -> C","n1b -> n2","n2 -> D","n0 -> B"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.75],"y":[-1.1],"text":"D","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25],"y":[0.9],"text":"C","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,186,56,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[2.9],"text":"B","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(97,156,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[3.9],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(245,100,227,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(5,1)","legendgroup":"(5,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.75],"y":[5],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.05,1.55],"tickmode":"array","ticktext":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"tickvals":[-1,-0.5,0,0.5,1,1.5],"categoryorder":"array","categoryarray":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.405,5.305],"tickmode":"array","ticktext":["0","2","4"],"tickvals":[0,2,4],"categoryorder":"array","categoryarray":["0","2","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"13040783e8cfa":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"130405299aec2":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"1304067a06ceb":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"13040554eed73":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"1304030c744c6":{"y":{}},"130406a743c2e":{"x":{},"y":{}}},"cur_data":"13040783e8cfa","visdat":{"13040783e8cfa":["function (y) ","x"],"130405299aec2":["function (y) ","x"],"1304067a06ceb":["function (y) ","x"],"13040554eed73":["function (y) ","x"],"1304030c744c6":["function (y) ","x"],"130406a743c2e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div style="width: 33%">
<div id="htmlwidget-9fbba5a83cc13cba2522" style="width:100%;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9fbba5a83cc13cba2522">{"x":{"data":[{"x":[0.75,-0.75],"y":[1,0],"text":"n2b -> n4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.75,-0.75],"y":[2,0],"text":"n3b -> n4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.75],"y":[3,2],"text":"n1b -> n2","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.75,0.75],"y":[4,2],"text":"nb -> n2","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,4)","legendgroup":"(admix,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.75,-0.75],"y":[0,-1],"text":"n4 -> D","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.75,0.75],"y":[2,1],"text":"n2 -> n2b","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.25,-1.75,null,-1.25,-0.75],"y":[3,2,null,3,2],"text":["n3 -> C","n3 -> C",null,"n3 -> n3b","n3 -> n3b"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.75,-1.25,null,-0.75,-0.25],"y":[4,3,null,4,3],"text":["n1 -> n3","n1 -> n3",null,"n1 -> n1b","n1 -> n1b"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.75,null,0,0.75],"y":[5,4,null,5,4],"text":["n -> n1","n -> n1",null,"n -> nb","n -> nb"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[6,5,null,6,5],"text":["n0 -> n","n0 -> n",null,"n0 -> B","n0 -> B"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[7,6,null,7,6],"text":["R -> A","R -> A",null,"R -> n0","R -> n0"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,0,0.75,-0.75,-1.25,-0.25,0.75,-0.75,0.75,-0.75],"y":[7,6,5,4,4,3,3,2,0,1,2],"text":["R","n0","n","nb","n1","n3","n1b","n2","n4","n2b","n3b"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.25,-0.375,0.375,0.75,-1,-1.5,-0.5,0.25,0.75,-0.75,0,-1,-0.75,0.75],"y":[6.5,6.5,5.5,4.5,4.5,3,3.5,2.5,3.5,2.5,1.5,-0.5,0.5,2.5,1,5.5],"text":["","","","","","","","","","","","","","","",""],"hovertext":["R -> A","R -> n0","n0 -> n","n -> n1","n -> nb","nb -> n2","n1 -> n3","n3 -> C","n1 -> n1b","n1b -> n2","n2 -> n2b","n4 -> D","n2b -> n4","n3 -> n3b","n3b -> n4","n0 -> B"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.75],"y":[-1.1],"text":"D","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.75],"y":[1.9],"text":"C","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,190,103,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[4.9],"text":"B","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[5.9],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,97,204,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.25],"y":[7],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.125,1.375],"tickmode":"array","ticktext":["-2","-1","0","1"],"tickvals":[-2,-1,0,1],"categoryorder":"array","categoryarray":["-2","-1","0","1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.505,7.405],"tickmode":"array","ticktext":["0.0","2.5","5.0"],"tickvals":[0,2.5,5],"categoryorder":"array","categoryarray":["0.0","2.5","5.0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"13040f728a72":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"1304028df4a4a":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"130405b86553c":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"1304050460515":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"1304024f7cedf":{"y":{}},"1304092ea56f":{"x":{},"y":{}}},"cur_data":"13040f728a72","visdat":{"13040f728a72":["function (y) ","x"],"1304028df4a4a":["function (y) ","x"],"130405b86553c":["function (y) ","x"],"1304050460515":["function (y) ","x"],"1304024f7cedf":["function (y) ","x"],"1304092ea56f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>For any set of <span class="math inline">\(f\)</span>-statistics, the
fit of one of these graphs is the same as the fit of the other two. With
site frequency spectra, these models would result in different fits and
could possibly be distinguished. (However, even with perfect data, <a href="https://www.sciencedirect.com/science/article/pii/S0040580908000038?casa_token=FYR8i8ICeB4AAAAA:oDtrv_MIgl-Vxys3LYBr0AdpebGbZMjALDWjjy7DqIuQtFSgBYitOY3ww_81awP3YvTelkX_">not
all possible demographic histories can be distinguished using site
frequency spectra</a>)</p>
<p>This apparent limitation of fitting admixture graphs with <span class="math inline">\(f\)</span>-statistics has an upside as well.
Admixture graphs look as if they are limited to only pulse admixture
events and can not deal with continues admixture or split events. But
the fit of these highly discretized models using <span class="math inline">\(f\)</span>-statistics is identical to the fits of
a much larger class of models with continuous admixture and population
splits. Basically, every internal node can be thought of as a stand-in
for an arbitrarily complex relationship among its three adjacent
edges.</p>
<p><br></p>
</div>
</div>
<div id="modeling-demographic-history" class="section level2">
<h2 class="hasAnchor">
<a href="#modeling-demographic-history" class="anchor"></a>Modeling demographic history</h2>
<p>Admixture graphs are models of demographic history. Like all models,
they should not be thought of as a perfect representation of reality,
but instead as a good enough representation of reality. As simple as
possible, but not simpler. A model that is too simple is one that
doesnâ€™t fit the data well. In our case, not fitting the data well means
that the <span class="math inline">\(f\)</span>-statistics implied by
the admixture graph are significantly different from the <span class="math inline">\(f\)</span>-statistic that can be observed from the
data (the <span class="math inline">\(f\)</span>-statistic residuals are
large).</p>
<p>This makes it easy to reject certain admixture graphs. We can reject
them if some of the <span class="math inline">\(f\)</span>-statistic
residuals are very large (letâ€™s say Z-score greater than 4; but it
really depends on the number of populations), or if the log-likelihood
score is far away from zero (this score is basically a weighted average
of <span class="math inline">\(f\)</span>-statistic residuals).</p>
<p>However, the inverse is not true. A low score doesnâ€™t mean that an
admixture graph is a good model of reality. It just means that we canâ€™t
reject it. It may or may not be a good model. For example, when there
are only very few SNPs to work with, more models appear to fit well, but
that just means that there is less power to reject some of these
models.</p>
<p>Even with a large number of SNPs, failure to reject a model does not
mean that the model has much to do with reality. There is often a large
number of well-fitting models with substantially different features.
While some of them may have better fits than others, often such
differences in log-likelihood score or worst residual are due to chance.
We can see that when we repeatedly fit two models with different SNPs,
and we observe that some choices of SNPs favor one model, but other
choices of SNPs favor the other model. In that case itâ€™s impossible to
tell which model is closer to reality. The functions
<code><a href="../reference/qpgraph_resample_snps2.html">qpgraph_resample_snps2()</a></code> and <code><a href="../reference/compare_fits.html">compare_fits()</a></code>
are there to test whether one model can be favored over another, when
accounting for the variability between SNPs.</p>
<p>Because itâ€™s usually not the case that any given admixture graph
model (even with a perfect model fit) captures every aspect of the
demographic history of a set of samples or populations, it helps to be
aware of the ways in which even a well-fitting model can depart from
reality. There are two different scenarios:</p>
<ol style="list-style-type: decimal">
<li>
<p>The model is a simplification of reality</p>
<p>This should be expected, not only of admixture graph models, but of
most models in general. If we have a model with, say, ten admixture
events, and this model is perfectly consistent with all available data,
it could mean that there really were ten admixture events in the history
of these populations. But it could also mean that there were hundreds,
or even thousands of different admixture events. Adding an admixture
edge to a graph will never worsen the model fit. The question is just
whether it substantially improves the fit. Occamâ€™s razor suggests that
we should prefer the model with ten admixture events. Thatâ€™s because out
of all well-fitting models with one hundred admixture events, we
wouldnâ€™t know which one to pick, whereas there may only be one
well-fitting model with ten admixture events. However, that doesnâ€™t mean
that ten admixture events are more likely than a hundred.</p>
<p>The One True Admixture Graph</p>
<p>We know in fact that a large number of admixture events is generally
a closer representation of reality than a small number. Admixture graphs
typically group people into populations before modeling their history
(thatâ€™s true for observed samples as well as for unobserved ancestral
samples). The process of grouping people into populations is never
perfect, but it is necessary to create models of a complexity that we
can handle. At least conceptually, we can imagine what it would look
like if we didnâ€™t group people into populations, if we had an infinite
number of SNPs for each sample, and if our goal was to recover not just
a simplified model of reality, but the exact steps, generation by
generation, that connect all people, present and past. What we would end
up with is the pedigree connecting all these people. In this pedegree
admixture graph, every child would be a 50/50 mixture of its parents.
This means that in the limit of modelling more and more admixture
events, an admixture graph eventually turns into a huge family pedigree.
Itâ€™s only at that point that the admixture graph stops being a
simplified representation of the true demographic history. (The fact
that admixture graphs can be seen as generalizations of pedigrees also
means that we can use <code>qpraph()</code> or
<code><a href="../reference/find_graphs.html">find_graphs()</a></code> to infer regular family pedegrees.) When
working with samples or populations which are separated by many
generations, itâ€™s impossible to infer this pedigree admixture graph. The
goal is instead to find the simplest model which is consistent with the
data. While this simplification doesnâ€™t capture all aspects of
demographic history, it is still very informative, because usually only
a small minority of all possible models are consistent with the genetic
data.</p>
</li>
<li>
<p>The model misrepresents reality beyond just simplifying it</p>
<p>In the first scenario, where the model is a simplification, we can
imagine that the simplified model is either contained within the true
pedigree admixture graph, or that we could go from the true model to the
simplified model by grouping nearby samples into populations. The
alternative scenario is that we have a model where some parts of the
graph are qualitatively different from the corresponding parts of the
true graph (they donâ€™t form a part-whole relationship). We usually donâ€™t
observe the true model, but itâ€™s not uncommon to see two relatively
simple admixture graph models which cannot be rejected, but which tell
very different stories (and which have the same number of admixture
events). Unlike in the case with two models of different complexity,
here itâ€™s not possible to parsimoniously pick the simpler model. Unless
other types of information (genetic of non-genetic) allow us to
distinguish between these two competing models, we have to concede at
that point that we have reached the limit of what we can say with the
data at hand.</p>
</li>
</ol>
<div id="distinguishing-between-a-large-number-of-alternative-models-requires-a-large-amount-of-data" class="section level4">
<h4 class="hasAnchor">
<a href="#distinguishing-between-a-large-number-of-alternative-models-requires-a-large-amount-of-data" class="anchor"></a>Distinguishing between a large number of alternative models requires
a large amount of data</h4>
<p>Itâ€™s difficult to say how much information exactly is contained in
the <em>f</em>-statistics and their standard errors for a set of
populations. The amount of information contained in the
<em>f</em>-statistics would give us an upper limit for the number of
possible models that can be distinguished. With ten populations and ten
admixture events, the number of <em>possible</em> models is 9.8e+33.
Many of these models are unidentifiable using <em>f</em>-statistics
(they have the same expected <em>f</em>-statistics as another, simpler
model), but I suspect that even when only the smaller set of
identifiable models is considered, the information contained in
<em>f</em>-statistics is insufficient to distinguish between all these
models. Even in the case of small graphs with few admixture events,
where the number of possible models is smaller (seven populations and no
admixture allows for 10395 possible trees), it may be the case that some
questions cannot be resolved due to a lack of information. For example,
if several populations split from a common branch only a few generations
apart, not enough genetic drift may have accumulated to determine the
order of split times (ignoring for now that this question may be
ill-posed because those splits may have been than continuous and
overlapping events).</p>
<p>All of this means that we shouldnâ€™t assume that once we have found a
model with a very good log-likelihood score or worst residual, we should
stop and declare victory. There may be many other models with equally
good fits. This changes the question from <em>What is the correct
admixture graph?</em> to <em>What do all well-fitting admixture graphs
have in common?</em>, which in turn brings two challenges:</p>
<ol style="list-style-type: decimal">
<li>How can we identify what the range of feasible models is?</li>
<li>Assuming there is a large number of feasible models, how can we tell
which features they share?</li>
</ol>
<p>In <em>ADMIXTOOLS 2</em>, we can use <a href="#exploring-different-graphs-1"><code>find_graphs</code> and other
functions</a> to identify the range of feasible models, and we can use
<a href="#summarizing-graphs-1">several other functions</a> to identify
features shared by these models.</p>
</div>
<div id="incorporating-prior-information" class="section level4">
<h4 class="hasAnchor">
<a href="#incorporating-prior-information" class="anchor"></a>Incorporating prior information</h4>
<p><em>f</em>-statistics sometimes fail to reject models that can be
rejected for other reasons. For example, models may be inconsistent with
what we know from radiocarbon dating, from material culture, or from
other types of genetic information. This prior information can be
incorporated by restricting the space of considered models to those that
are consistent with what we already know, as described <a href="#constraining-the-search-space">here</a>.</p>
</div>
<div id="f-statistics-qpadm-and-admixture-graphs" class="section level4">
<h4 class="hasAnchor">
<a href="#f-statistics-qpadm-and-admixture-graphs" class="anchor"></a>f-statistics, qpAdm, and admixture graphs</h4>
<p>Most papers that use <em>f</em>-statistics derive their conclusions
from different methods and different lines of evidence. Some of those
are orthogonal to each other, while others are not. In particular,
different types of <em>f</em>-statistics based analyses should not be
interpreted as independent evidence. It can make sense to combine
individual <span class="math inline">\(f_4\)</span>- or <span class="math inline">\(D\)</span>-statistics, <em>qpAdm</em>, and
admixture graph models to address slightly different questions, but
since all are based on the same type of information, they donâ€™t mutually
reinforce each other (and they shouldnâ€™t contradict each other). For
example, every <em>qpAdm</em> model corresponds to a certain class of
admixture graph models. If one of the admixture graphs provides a good
fit, so will the <em>qpAdm</em> model.</p>
<p>In contrast to this, methods which use different aspects of the same
genetic data, such as haplotype information, can provide additional
support for <em>f</em>-statistics based analyses.</p>
<p><br></p>
</div>
</div>
<div id="graphs-in-admixtools-2" class="section level2">
<h2 class="hasAnchor">
<a href="#graphs-in-admixtools-2" class="anchor"></a>Graphs in <em>ADMIXTOOLS 2</em>
</h2>
<p><em>ADMIXTOOLS 2</em> can read and write graphs in a number of
different formats, including the format used by the original
<em>ADMIXTOOLS</em> software and DOT format, but internally it uses only
the following two representations of admixture graphs:</p>
<ol style="list-style-type: decimal">
<li>An edge list</li>
</ol>
<ul>
<li>This is either a matrix or a data frame where each edge is in a
different row. The first column (<code>from</code>) contains the names
of the source nodes, and the second column (<code>to</code>) contains
the names of the target nodes. No distinction is made between admixture
edges and drift edges, or between different types of nodes. Optionally,
there are two more columns (<code>lower</code> and <code>upper</code>),
which put constraints on the length of an edge. For admixture edges,
these constraints should be between 0 and 1, and for drift edges they
can range from 0 to infinity. No constraints are indicated by
<code>NA</code>.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>An <code>igraph</code> graph object</li>
</ol>
<ul>
<li>This format is used for most operations that modify graphs, since
the <a href="https://igraph.org/r/">igraph package</a> provides many
useful functions for working with graphs. If not otherwise specified,
functions that take graphs as input expect a graph in this format.</li>
</ul>
<p>To convert an admixture graph from one of these representations to
the other, you can use the <code>igraph</code> function
<code><a href="https://rdrr.io/pkg/igraph/man/graph_from_edgelist.html">igraph::graph_from_edgelist()</a></code> and
<code><a href="https://rdrr.io/pkg/igraph/man/as_edgelist.html">igraph::as_edgelist()</a></code>.</p>
<div id="valid-graphs" class="section level3">
<h3 class="hasAnchor">
<a href="#valid-graphs" class="anchor"></a>Valid graphs</h3>
<p>A valid admixture graph in <em>ADMIXTOOLS 2</em> has to satisfy a
number of conditions:</p>
<ol style="list-style-type: decimal">
<li>It has to be a <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">directed,
acyclic graph</a>
</li>
<li>All nodes have to be connected and there canâ€™t be any duplicated
edges</li>
<li>No node should have more than two incoming or outgoing edges</li>
<li>Every population for which we have data should be a terminal node
with only one incoming edge</li>
</ol>
<p>The function <code><a href="../reference/is_valid.html">is_valid()</a></code> tests whether a graph satisfies
these conditions.</p>
<p>The third condition prohibits so-called multifurcations, or
politomies. The function <code><a href="../reference/split_multifurcations.html">split_multifurcations()</a></code> turns a
graph with multifurcations into a graph without multifurcations. At the
same time, it constrains the newly introduced edges to be near zero, so
that while fitting the graph, the multifurcations will be respected.</p>
<p>The last condition ensures that each observed population can have
drift which is shared with no other population. This means that no
observed population is a direct ancestor of any other population, and it
is the reason why random error in the genotypes of any population does
not lead to bias.</p>
</div>
<div id="creating-and-loading-admixture-graphs" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-and-loading-admixture-graphs" class="anchor"></a>Creating and loading admixture graphs</h3>
<p>The examples above have already demonstrated how admixture graphs can
be created from scratch in R: By creating a two column matrix where each
row represents and edge, with the first column the origin, and the
second column the destination.</p>
<p>You can also generate random graphs with your choice of population
labels and a set number of admixture events:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pops</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/starwars.html">starwars</a></span><span class="op">$</span><span class="va">species</span><span class="op">)</span>
<span class="va">newgraph</span> <span class="op">=</span> <span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="va">pops</span>, numadmix <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span><span class="va">newgraph</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-2c55a4f49fbd0ff6012b" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2c55a4f49fbd0ff6012b">{"x":{"data":[{"x":[13.73046875,13.73046875],"y":[-3,-4],"text":"admixp -> admixpj","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(183,159,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-3)","legendgroup":"(admix,-3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.01953125,13.73046875],"y":[-2,-3],"text":"Rllll -> admixp","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(147,170,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-2)","legendgroup":"(admix,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-6.51953125,-6.01953125],"y":[-1,-6],"text":"Rlll -> admixtm","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(94,179,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15.73046875,-0.01953125,null,15.73046875,6.98046875,null,3.98046875,-4.51953125,null,3.98046875,-6.01953125],"y":[0,-4,null,0,-1,null,0,-1,null,0,-6],"text":["Rrrlllrl -> admix","Rrrlllrl -> admix",null,"Rrrlllrl -> admixt","Rrrlllrl -> admixt",null,"admixoy -> admixg","admixoy -> admixg",null,"admixoy -> admixtm","admixoy -> admixtm"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15.73046875,-2.01953125,null,11.23046875,6.73046875,null,12.23046875,-6.51953125],"y":[1,0,null,1,0,null,1,0],"text":["Rrrlllry -> admixz","Rrrlllry -> admixz",null,"Rrrrrlrr -> admixth","Rrrrrlrr -> admixth",null,"Rrrrrlrk -> admixh","Rrrrrlrk -> admixh"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,116,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.73046875,3.98046875,null,6.23046875,6.73046875],"y":[2,1,null,2,0],"text":["Rrrlrlrq -> admixo","Rrrlrlrq -> admixo",null,"Rrrlrlry -> admixth","Rrrlrlry -> admixth"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,193,159,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.01953125,-0.01953125,null,11.73046875,13.73046875,null,8.23046875,8.73046875,null,9.73046875,8.73046875,null,15.23046875,1.48046875],"y":[3,-4,null,3,-4,null,3,2,null,3,2,null,3,2],"text":["admixa -> admix","admixa -> admix",null,"Rrrrrlb -> admixpj","Rrrrrlb -> admixpj",null,"Rrrrlrl -> admixv","Rrrrlrl -> admixv",null,"Rrrrlrp -> admixv","Rrrrlrp -> admixv",null,"Rrrllln -> admixx","Rrrllln -> admixx"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.98046875,-0.01953125],"y":[4,3],"text":"Rrrlllw -> admixa","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,185,227,1)","dash":"dot"},"hoveron":"points","name":"(admix,4)","legendgroup":"(admix,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.98046875,15.23046875,null,-3.51953125,-1.01953125],"y":[5,4,null,5,4],"text":["Rrrlll -> admixzs","Rrrlll -> admixzs",null,"Rlrlrot -> admixj","Rlrlrot -> admixj"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,173,250,1)","dash":"dot"},"hoveron":"points","name":"(admix,5)","legendgroup":"(admix,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.48046875,3.98046875,null,6.23046875,6.98046875,null,-4.01953125,-4.51953125],"y":[6,1,null,6,-1,null,6,-1],"text":["Rrrll -> admixo","Rrrll -> admixo",null,"Rrrlq -> admixt","Rrrlq -> admixt",null,"Rlrlro -> admixg","Rlrlro -> admixg"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,6)","legendgroup":"(admix,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[11.91796875,13.73046875,null,-2.51953125,-2.01953125,null,0.73046875,-0.01953125,null,0.73046875,1.48046875],"y":[7,-3,null,7,0,null,7,3,null,7,2],"text":["Rrrg -> admixp","Rrrg -> admixp",null,"Rrllr -> admixz","Rrllr -> admixz",null,"Rrlrl -> admixa","Rrlrl -> admixa",null,"Rrlrl -> admixx","Rrlrl -> admixx"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(174,135,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,7)","legendgroup":"(admix,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.76953125,-1.01953125],"y":[8,4],"text":"Rrll -> admixj","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(219,114,251,1)","dash":"dot"},"hoveron":"points","name":"(admix,8)","legendgroup":"(admix,8)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.01953125,-6.51953125,null,11.80859375,15.23046875],"y":[9,0,null,9,4],"text":["Rll -> admixh","Rll -> admixh",null,"Rrd -> admixzs","Rrd -> admixzs"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(245,100,227,1)","dash":"dot"},"hoveron":"points","name":"(admix,9)","legendgroup":"(admix,9)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[13.23046875,12.73046875,null,13.23046875,13.73046875,null,-6.01953125,-6.01953125],"y":[-6,-7,null,-6,-7,null,-6,-7],"text":["Rllllrl -> Zabrak","Rllllrl -> Zabrak",null,"Rllllrl -> NA","Rllllrl -> NA",null,"admixtm -> Twi'lek","admixtm -> Twi'lek"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-6)","legendgroup":"(normal,-6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[13.73046875,13.23046875,null,13.73046875,14.23046875],"y":[-5,-6,null,-5,-6],"text":["Rllllr -> Rllllrl","Rllllr -> Rllllrl",null,"Rllllr -> Clawdite","Rllllr -> Clawdite"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(232,133,38,1)","dash":"solid"},"hoveron":"points","name":"(normal,-5)","legendgroup":"(normal,-5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4.51953125,-5.01953125,null,-4.51953125,-4.01953125,null,-0.01953125,-0.01953125,null,13.73046875,13.73046875],"y":[-4,-5,null,-4,-5,null,-4,-5,null,-4,-5],"text":["Rrrllrrl -> Muun","Rrrllrrl -> Muun",null,"Rrrllrrl -> Quermian","Rrrllrrl -> Quermian",null,"admix -> Mon Calamari","admix -> Mon Calamari",null,"admixpj -> Rllllr","admixpj -> Rllllr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(211,146,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-4)","legendgroup":"(normal,-4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4.01953125,-4.51953125,null,-4.01953125,-3.51953125],"y":[-3,-4,null,-3,-4],"text":["Rrrllrr -> Rrrllrrl","Rrrllrr -> Rrrllrrl",null,"Rrrllrr -> Rodian","Rrrllrr -> Rodian"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(183,159,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-3)","legendgroup":"(normal,-3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.01953125,-7.01953125,null,-4.51953125,-5.01953125,null,-4.51953125,-4.01953125],"y":[-2,-3,null,-2,-3,null,-2,-3],"text":["Rllll -> Besalisk","Rllll -> Besalisk",null,"Rrrllr -> Xexto","Rrrllr -> Xexto",null,"Rrrllr -> Rrrllrr","Rrrllr -> Rrrllrr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(147,170,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-6.51953125,-7.01953125,null,6.98046875,6.98046875,null,-4.51953125,-4.51953125],"y":[-1,-2,null,-1,-2,null,-1,-2],"text":["Rlll -> Rllll","Rlll -> Rllll",null,"admixt -> Human","admixt -> Human",null,"admixg -> Rrrllr","admixg -> Rrrllr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(94,179,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.98046875,0.48046875,null,0.98046875,1.48046875,null,-2.01953125,-2.01953125,null,6.73046875,6.73046875,null,-6.51953125,-6.51953125],"y":[0,-1,null,0,-1,null,0,-1,null,0,-1,null,0,-1],"text":["Rrlrlrl -> Kaminoan","Rrlrlrl -> Kaminoan",null,"Rrlrlrl -> Sullustan","Rrlrlrl -> Sullustan",null,"admixz -> Kaleesh","admixz -> Kaleesh",null,"admixth -> Chagrian","admixth -> Chagrian",null,"admixh -> Rlll","admixh -> Rlll"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.48046875,0.98046875,null,1.48046875,1.98046875,null,11.23046875,11.23046875,null,15.73046875,15.73046875,null,12.23046875,12.23046875,null,3.98046875,3.98046875],"y":[1,0,null,1,0,null,1,0,null,1,0,null,1,0,null,1,0],"text":["Rrlrlr -> Rrlrlrl","Rrlrlr -> Rrlrlrl",null,"Rrlrlr -> Ewok","Rrlrlr -> Ewok",null,"Rrrrrlrr -> Yoda's species","Rrrrrlrr -> Yoda's species",null,"Rrrlllry -> Rrrlllrl","Rrrlllry -> Rrrlllrl",null,"Rrrrrlrk -> Geonosian","Rrrrrlrk -> Geonosian",null,"admixo -> admixoy","admixo -> admixoy"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,116,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[15.23046875,14.73046875,null,11.73046875,11.23046875,null,4.73046875,4.73046875,null,15.23046875,15.73046875,null,6.23046875,5.73046875,null,11.73046875,12.23046875,null,8.73046875,8.73046875,null,1.48046875,1.48046875],"y":[2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1],"text":["Rrrlllr -> Pau'an","Rrrlllr -> Pau'an",null,"Rrrrrlr -> Rrrrrlrr","Rrrrrlr -> Rrrrrlrr",null,"Rrrlrlrq -> Droid","Rrrlrlrq -> Droid",null,"Rrrlllr -> Rrrlllry","Rrrlllr -> Rrrlllry",null,"Rrrlrlry -> Mirialan","Rrrlrlry -> Mirialan",null,"Rrrrrlr -> Rrrrrlrk","Rrrrrlr -> Rrrrrlrk",null,"admixv -> Vulptereen","admixv -> Vulptereen",null,"admixx -> Rrlrlr","admixx -> Rrlrlr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,193,159,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8.23046875,7.73046875,null,5.48046875,4.73046875,null,5.48046875,6.23046875,null,11.73046875,11.73046875,null,9.73046875,9.73046875,null,15.23046875,15.23046875],"y":[3,2,null,3,2,null,3,2,null,3,2,null,3,2,null,3,2],"text":["Rrrrlrl -> Neimodian","Rrrrlrl -> Neimodian",null,"Rrrlrlr -> Rrrlrlrq","Rrrlrlr -> Rrrlrlrq",null,"Rrrlrlr -> Rrrlrlry","Rrrlrlr -> Rrrlrlry",null,"Rrrrrlb -> Rrrrrlr","Rrrrrlb -> Rrrrrlr",null,"Rrrrlrp -> Kel Dor","Rrrrlrp -> Kel Dor",null,"Rrrllln -> Rrrlllr","Rrrllln -> Rrrlllr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.98046875,4.48046875,null,4.98046875,5.48046875,null,8.98046875,8.23046875,null,11.23046875,10.73046875,null,2.98046875,2.98046875,null,11.23046875,11.73046875,null,8.98046875,9.73046875,null,15.23046875,15.23046875,null,-1.01953125,-1.01953125],"y":[4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3],"text":["Rrrlrl -> Gungan","Rrrlrl -> Gungan",null,"Rrrlrl -> Rrrlrlr","Rrrlrl -> Rrrlrlr",null,"Rrrrlr -> Rrrrlrl","Rrrrlr -> Rrrrlrl",null,"Rrrrrl -> Skakoan","Rrrrrl -> Skakoan",null,"Rrrlllw -> Toong","Rrrlllw -> Toong",null,"Rrrrrl -> Rrrrrlb","Rrrrrl -> Rrrrrlb",null,"Rrrrlr -> Rrrrlrp","Rrrrlr -> Rrrrlrp",null,"admixzs -> Rrrllln","admixzs -> Rrrllln",null,"admixj -> Togruta","admixj -> Togruta"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,185,227,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.48046875,4.98046875,null,5.48046875,5.98046875,null,8.48046875,7.98046875,null,8.48046875,8.98046875,null,11.73046875,11.23046875,null,11.73046875,12.23046875,null,2.98046875,2.98046875,null,-3.51953125,-3.51953125],"y":[5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4],"text":["Rrrlr -> Rrrlrl","Rrrlr -> Rrrlrl",null,"Rrrlr -> Aleena","Rrrlr -> Aleena",null,"Rrrrl -> Trandoshan","Rrrrl -> Trandoshan",null,"Rrrrl -> Rrrrlr","Rrrrl -> Rrrrlr",null,"Rrrrr -> Rrrrrl","Rrrrr -> Rrrrrl",null,"Rrrrr -> Cerean","Rrrrr -> Cerean",null,"Rrrlll -> Rrrlllw","Rrrlll -> Rrrlllw",null,"Rlrlrot -> Toydarian","Rlrlrot -> Toydarian"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,173,250,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.48046875,2.98046875,null,10.10546875,8.48046875,null,10.10546875,11.73046875,null,6.23046875,5.48046875,null,-4.01953125,-3.51953125],"y":[6,5,null,6,5,null,6,5,null,6,5,null,6,5],"text":["Rrrll -> Rrrlll","Rrrll -> Rrrlll",null,"Rrrr -> Rrrrl","Rrrr -> Rrrrl",null,"Rrrr -> Rrrrr","Rrrr -> Rrrrr",null,"Rrrlq -> Rrrlr","Rrrlq -> Rrrlr",null,"Rlrlro -> Rlrlrot","Rlrlro -> Rlrlrot"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4.51953125,-5.01953125,null,-2.51953125,-3.01953125,null,4.85546875,3.48046875,null,11.91796875,10.10546875,null,4.85546875,6.23046875,null,-4.51953125,-4.01953125],"y":[7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6],"text":["Rlrlr -> Wookiee","Rlrlr -> Wookiee",null,"Rrllr -> Iktotchi","Rrllr -> Iktotchi",null,"Rrrl -> Rrrll","Rrrl -> Rrrll",null,"Rrrg -> Rrrr","Rrrg -> Rrrr",null,"Rrrl -> Rrrlq","Rrrl -> Rrrlq",null,"Rlrlr -> Rlrlro","Rlrlr -> Rlrlro"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(174,135,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.01953125,-5.51953125,null,-5.01953125,-4.51953125,null,-1.76953125,-2.51953125,null,1.23046875,0.73046875,null,1.23046875,1.73046875,null,8.38671875,4.85546875,null,8.38671875,11.91796875],"y":[8,7,null,8,7,null,8,7,null,8,7,null,8,7,null,8,7,null,8,7],"text":["Rlrl -> Dug","Rlrl -> Dug",null,"Rlrl -> Rlrlr","Rlrl -> Rlrlr",null,"Rrll -> Rrllr","Rrll -> Rrllr",null,"Rrlr -> Rrlrl","Rrlr -> Rrlrl",null,"Rrlr -> Nautolan","Rrlr -> Nautolan",null,"Rrr -> Rrrl","Rrr -> Rrrl",null,"Rrr -> Rrrg","Rrr -> Rrrg"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(219,114,251,1)","dash":"solid"},"hoveron":"points","name":"(normal,8)","legendgroup":"(normal,8)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.01953125,-7.51953125,null,-4.51953125,-5.01953125,null,-4.51953125,-4.01953125,null,-0.26953125,-1.76953125,null,-0.26953125,1.23046875,null,11.80859375,8.38671875],"y":[9,8,null,9,8,null,9,8,null,9,8,null,9,8,null,9,8],"text":["Rll -> Hutt","Rll -> Hutt",null,"Rlr -> Rlrl","Rlr -> Rlrl",null,"Rlr -> Tholothian","Rlr -> Tholothian",null,"Rrl -> Rrll","Rrl -> Rrll",null,"Rrl -> Rrlr","Rrl -> Rrlr",null,"Rrd -> Rrr","Rrd -> Rrr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(245,100,227,1)","dash":"solid"},"hoveron":"points","name":"(normal,9)","legendgroup":"(normal,9)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.76953125,-7.01953125,null,-5.76953125,-4.51953125,null,5.76953125,-0.26953125,null,5.76953125,11.80859375],"y":[10,9,null,10,9,null,10,9,null,10,9],"text":["Rl -> Rll","Rl -> Rll",null,"Rl -> Rlr","Rl -> Rlr",null,"Rr -> Rrl","Rr -> Rrl",null,"Rr -> Rrd","Rr -> Rrd"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,195,1)","dash":"solid"},"hoveron":"points","name":"(normal,10)","legendgroup":"(normal,10)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-5.76953125,null,0,5.76953125],"y":[11,10,null,11,10],"text":["R -> Rl","R -> Rl",null,"R -> Rr","R -> Rr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,105,156,1)","dash":"solid"},"hoveron":"points","name":"(normal,11)","legendgroup":"(normal,11)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-5.76953125,-6.51953125,-7.01953125,13.73046875,13.23046875,-7.01953125,-4.51953125,-5.01953125,-4.51953125,5.76953125,-0.26953125,-1.76953125,-2.51953125,1.23046875,1.48046875,0.98046875,8.38671875,4.85546875,3.48046875,15.23046875,-4.51953125,-4.01953125,-4.51953125,5.48046875,4.98046875,10.10546875,8.48046875,8.98046875,8.23046875,11.73046875,11.23046875,11.73046875,11.23046875,-0.01953125,15.73046875,5.48046875,4.73046875,11.91796875,6.23046875,6.98046875,-4.51953125,-4.01953125,15.73046875,-2.01953125,6.23046875,6.73046875,2.98046875,2.98046875,0.73046875,-0.01953125,12.23046875,-6.51953125,11.73046875,13.73046875,13.73046875,9.73046875,8.73046875,15.23046875,1.48046875,11.80859375,15.23046875,3.98046875,3.98046875,-6.01953125,-3.51953125,-1.01953125],"y":[11,10,-1,-2,-5,-6,9,9,8,7,10,9,8,7,8,1,0,8,7,6,2,-2,-3,-4,5,4,6,5,4,3,5,4,2,1,-4,0,3,2,7,6,-1,-1,6,1,0,2,0,5,4,7,3,1,0,3,-3,-4,3,2,3,2,9,4,1,0,-6,5,4],"text":["R","Rl","Rlll","Rllll","Rllllr","Rllllrl","Rll","Rlr","Rlrl","Rlrlr","Rr","Rrl","Rrll","Rrllr","Rrlr","Rrlrlr","Rrlrlrl","Rrr","Rrrl","Rrrll","Rrrlllr","Rrrllr","Rrrllrr","Rrrllrrl","Rrrlr","Rrrlrl","Rrrr","Rrrrl","Rrrrlr","Rrrrlrl","Rrrrr","Rrrrrl","Rrrrrlr","Rrrrrlrr","admix","Rrrlllrl","Rrrlrlr","Rrrlrlrq","Rrrg","Rrrlq","admixt","admixg","Rlrlro","Rrrlllry","admixz","Rrrlrlry","admixth","Rrrlll","Rrrlllw","Rrlrl","admixa","Rrrrrlrk","admixh","Rrrrrlb","admixp","admixpj","Rrrrlrp","admixv","Rrrllln","admixx","Rrd","admixzs","admixo","admixoy","admixtm","Rlrlrot","admixj"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.884765625,-6.39453125,-6.76953125,-7.01953125,13.48046875,12.98046875,13.48046875,13.98046875,-7.26953125,-5.14453125,-4.76953125,-5.26953125,-4.76953125,-4.76953125,-4.26953125,2.884765625,2.75,-1.01953125,-2.14453125,-2.76953125,0.48046875,0.98046875,1.23046875,0.73046875,1.23046875,1.73046875,1.48046875,6.62109375,4.16796875,3.23046875,14.98046875,-4.76953125,-4.26953125,-4.26953125,-4.76953125,-4.26953125,-3.76953125,5.23046875,4.73046875,5.23046875,5.73046875,9.29296875,8.23046875,8.73046875,8.60546875,7.98046875,10.91796875,11.48046875,10.98046875,11.48046875,11.23046875,11.98046875,-0.01953125,7.85546875,5.10546875,4.73046875,3.73046875,4.35546875,10.15234375,11.01171875,3.35546875,12.82421875,5.54296875,5.85546875,11.35546875,6.98046875,6.60546875,-4.26953125,-4.51953125,-4.26953125,15.48046875,15.73046875,-2.26953125,-2.01953125,6.85546875,5.85546875,5.98046875,8.98046875,6.73046875,6.48046875,2.98046875,2.98046875,0.35546875,-0.01953125,1.48046875,11.98046875,12.23046875,-6.76953125,-6.51953125,2.85546875,11.48046875,11.73046875,13.73046875,13.73046875,12.73046875,9.35546875,9.73046875,8.48046875,8.73046875,9.23046875,15.23046875,1.10546875,1.48046875,8.35546875,8.7890625,10.09765625,9.10546875,15.23046875,13.51953125,3.98046875,-0.26953125,-6.26953125,-6.01953125,-1.01953125,-3.76953125,-3.51953125,-1.39453125,-1.01953125,-2.26953125],"y":[10.5,9.5,-1.5,-2.5,-5.5,-6.5,-6.5,-5.5,8.5,9.5,8.5,7.5,7.5,6.5,8.5,10.5,9.5,8.5,7.5,6.5,8.5,7.5,0.5,-0.5,-0.5,0.5,7.5,7.5,6.5,5.5,1.5,-2.5,-2.5,-3.5,-4.5,-4.5,-3.5,4.5,3.5,3.5,4.5,5.5,4.5,4.5,3.5,2.5,5.5,4.5,3.5,1.5,0.5,4.5,-4.5,-2,2.5,1.5,3.5,1.5,7.5,6.5,-2.5,2,6.5,5.5,-0.5,-1.5,2.5,6.5,-1.5,2.5,1.5,0.5,3.5,-0.5,0.5,2.5,1.5,0.5,-0.5,1,4.5,3.5,5,-0.5,3.5,1.5,0.5,4.5,-0.5,0.5,3.5,2.5,-3.5,-4.5,-0.5,3.5,2.5,2.5,1.5,2.5,2.5,4.5,1.5,2.5,9.5,8.5,4.5,3.5,6.5,0.5,-0.5,-3.5,-6.5,-3,5.5,4.5,6,3.5,4.5],"text":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"hovertext":["R -> Rl","Rl -> Rll","Rlll -> Rllll","Rllll -> Besalisk","Rllllr -> Rllllrl","Rllllrl -> Zabrak","Rllllrl -> NA","Rllllr -> Clawdite","Rll -> Hutt","Rl -> Rlr","Rlr -> Rlrl","Rlrl -> Dug","Rlrl -> Rlrlr","Rlrlr -> Wookiee","Rlr -> Tholothian","R -> Rr","Rr -> Rrl","Rrl -> Rrll","Rrll -> Rrllr","Rrllr -> Iktotchi","Rrl -> Rrlr","Rrlr -> Rrlrl","Rrlrlr -> Rrlrlrl","Rrlrlrl -> Kaminoan","Rrlrlrl -> Sullustan","Rrlrlr -> Ewok","Rrlr -> Nautolan","Rrr -> Rrrl","Rrrl -> Rrrll","Rrrll -> Rrrlll","Rrrlllr -> Pau'an","Rrrllr -> Xexto","Rrrllr -> Rrrllrr","Rrrllrr -> Rrrllrrl","Rrrllrrl -> Muun","Rrrllrrl -> Quermian","Rrrllrr -> Rodian","Rrrlr -> Rrrlrl","Rrrlrl -> Gungan","Rrrlrl -> Rrrlrlr","Rrrlr -> Aleena","Rrrr -> Rrrrl","Rrrrl -> Trandoshan","Rrrrl -> Rrrrlr","Rrrrlr -> Rrrrlrl","Rrrrlrl -> Neimodian","Rrrr -> Rrrrr","Rrrrr -> Rrrrrl","Rrrrrl -> Skakoan","Rrrrrlr -> Rrrrrlrr","Rrrrrlrr -> Yoda's species","Rrrrr -> Cerean","admix -> Mon Calamari","Rrrlllrl -> admix","Rrrlrlr -> Rrrlrlrq","Rrrlrlrq -> Droid","Rrrll -> admixo","Rrrlrlrq -> admixo","Rrr -> Rrrg","Rrrg -> Rrrr","Rllll -> admixp","Rrrg -> admixp","Rrrl -> Rrrlq","Rrrlq -> Rrrlr","Rrrlllrl -> admixt","admixt -> Human","Rrrlq -> admixt","Rlrlr -> Rlrlro","admixg -> Rrrllr","Rlrlro -> admixg","Rrrlllr -> Rrrlllry","Rrrlllry -> Rrrlllrl","Rrllr -> admixz","admixz -> Kaleesh","Rrrlllry -> admixz","Rrrlrlr -> Rrrlrlry","Rrrlrlry -> Mirialan","Rrrrrlrr -> admixth","admixth -> Chagrian","Rrrlrlry -> admixth","Rrrlll -> Rrrlllw","Rrrlllw -> Toong","Rrlrl -> admixa","admixa -> admix","Rrrlllw -> admixa","Rrrrrlr -> Rrrrrlrk","Rrrrrlrk -> Geonosian","Rll -> admixh","admixh -> Rlll","Rrrrrlrk -> admixh","Rrrrrl -> Rrrrrlb","Rrrrrlb -> Rrrrrlr","admixp -> admixpj","admixpj -> Rllllr","Rrrrrlb -> admixpj","Rrrrlr -> Rrrrlrp","Rrrrlrp -> Kel Dor","Rrrrlrl -> admixv","admixv -> Vulptereen","Rrrrlrp -> admixv","Rrrllln -> Rrrlllr","Rrlrl -> admixx","admixx -> Rrlrlr","Rrrllln -> admixx","Rr -> Rrd","Rrd -> Rrr","Rrrlll -> admixzs","admixzs -> Rrrllln","Rrd -> admixzs","admixo -> admixoy","admixoy -> admixg","Rlll -> admixtm","admixtm -> Twi'lek","admixoy -> admixtm","Rlrlro -> Rlrlrot","Rlrlrot -> Toydarian","Rrll -> admixj","admixj -> Togruta","Rlrlrot -> admixj"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[12.73046875,13.73046875,-6.01953125],"y":[-7.1,-7.1,-7.1],"text":["Zabrak","NA","Twi'lek"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-6,1)","legendgroup":"(-6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[14.23046875],"y":[-6.1],"text":"Clawdite","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(232,133,38,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-5,1)","legendgroup":"(-5,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.01953125,-4.01953125,-0.01953125],"y":[-5.1,-5.1,-5.1],"text":["Muun","Quermian","Mon Calamari"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(211,146,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-4,1)","legendgroup":"(-4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.51953125],"y":[-4.1],"text":"Rodian","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(183,159,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-3,1)","legendgroup":"(-3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.01953125,-5.01953125],"y":[-3.1,-3.1],"text":["Besalisk","Xexto"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(147,170,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[6.98046875],"y":[-2.1],"text":"Human","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(94,179,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.48046875,1.48046875,-2.01953125,6.73046875],"y":[-1.1,-1.1,-1.1,-1.1],"text":["Kaminoan","Sullustan","Kaleesh","Chagrian"],"hovertext":["","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,186,56,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.98046875,11.23046875,12.23046875],"y":[-0.1,-0.1,-0.1],"text":["Ewok","Yoda's species","Geonosian"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,116,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[14.73046875,4.73046875,5.73046875,8.73046875],"y":[0.9,0.9,0.9,0.9],"text":["Pau'an","Droid","Mirialan","Vulptereen"],"hovertext":["","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,193,159,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[7.73046875,9.73046875],"y":[1.9,1.9],"text":["Neimodian","Kel Dor"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.48046875,10.73046875,2.98046875,-1.01953125],"y":[2.9,2.9,2.9,2.9],"text":["Gungan","Skakoan","Toong","Togruta"],"hovertext":["","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,185,227,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.98046875,7.98046875,12.23046875,-3.51953125],"y":[3.9,3.9,3.9,3.9],"text":["Aleena","Trandoshan","Cerean","Toydarian"],"hovertext":["","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,173,250,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(5,1)","legendgroup":"(5,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.01953125,-3.01953125],"y":[5.9,5.9],"text":["Wookiee","Iktotchi"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(174,135,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.51953125,1.73046875],"y":[6.9,6.9],"text":["Dug","Nautolan"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(219,114,251,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(8,1)","legendgroup":"(8,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.51953125,-4.01953125],"y":[7.9,7.9],"text":["Hutt","Tholothian"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(245,100,227,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(9,1)","legendgroup":"(9,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.01953125],"y":[11],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-9.94453125,18.15546875],"tickmode":"array","ticktext":["0","10"],"tickvals":[0,10],"categoryorder":"array","categoryarray":["0","10"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-8.005,11.905],"tickmode":"array","ticktext":["-5","0","5","10"],"tickvals":[-5,0,5,10],"categoryorder":"array","categoryarray":["-5","0","5","10"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"13040502e7625":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"130401a4ea043":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"130401ffb9c33":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"130403fcbe8ac":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"13040641894ec":{"y":{}},"130409d9454b":{"x":{},"y":{}}},"cur_data":"13040502e7625","visdat":{"13040502e7625":["function (y) ","x"],"130401a4ea043":["function (y) ","x"],"130401ffb9c33":["function (y) ","x"],"130403fcbe8ac":["function (y) ","x"],"13040641894ec":["function (y) ","x"],"130409d9454b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>To load an existing graph, use <code><a href="../reference/parse_qpgraph_graphfile.html">parse_qpgraph_graphfile()</a></code>
if itâ€™s in the original <em>ADMIXTOOLS</em> format,
<code>read_table2()</code> if itâ€™s an edge list, or
<code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code> if it was saved in R using
<code><a href="https://rdrr.io/r/base/readRDS.html">saveRDS()</a></code>.</p>
</div>
<div id="modifying-admixture-graphs" class="section level3">
<h3 class="hasAnchor">
<a href="#modifying-admixture-graphs" class="anchor"></a>Modifying admixture graphs</h3>
<p>Admixture graphs can be modified using the following functions:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/insert_admix.html">insert_admix</a></span><span class="op">(</span><span class="va">example_igraph</span>, from <span class="op">=</span> <span class="st">"N2N1|Vindija.DG"</span>, to <span class="op">=</span> <span class="st">"N3N1|Denisova.DG"</span><span class="op">)</span>
<span class="fu"><a href="../reference/delete_admix.html">delete_admix</a></span><span class="op">(</span><span class="va">example_igraph</span>, from <span class="op">=</span> <span class="st">"N2N2"</span>, to <span class="op">=</span> <span class="st">"N2N4"</span><span class="op">)</span>
<span class="fu"><a href="../reference/insert_leaf.html">insert_leaf</a></span><span class="op">(</span><span class="va">example_igraph</span>, <span class="st">"newpop"</span>, from <span class="op">=</span> <span class="st">"N4N"</span>, to <span class="op">=</span> <span class="st">"Switzerland_Bichon.SG"</span><span class="op">)</span>
<span class="fu"><a href="../reference/delete_leaf.html">delete_leaf</a></span><span class="op">(</span><span class="va">example_igraph</span>, <span class="st">"Switzerland_Bichon.SG"</span><span class="op">)</span></code></pre></div>
<p>But itâ€™s probably easier to modify a graph interactively using the
<em>ADMIXTOOLS 2</em> GUI.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/run_shiny_admixtools.html">run_shiny_admixtools</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Below you can see how a new admixture edge is added to a graph:</p>
<p><img src="../man/figures/shinyapp1.gif"></p>
<p><br></p>
</div>
</div>
<div id="fitting-a-single-graph" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-a-single-graph" class="anchor"></a>Fitting a single graph</h2>
<p><code><a href="../reference/qpgraph.html">qpgraph()</a></code> tries to find the admixture- and drift-edge
weights for a given graph topology which are most consistent with the
observed <span class="math inline">\(f\)</span>-statistics. It takes a
<span class="math inline">\(f\)</span>-statistics and a graph as input,
and returns the best likelihood score it could find, as well as the
corresponding weights.</p>
<div id="initial-weights" class="section level3">
<h3 class="hasAnchor">
<a href="#initial-weights" class="anchor"></a>Initial weights</h3>
<p>The optimization of admixture weights requires initial values for the
weights. Occasionally, the initial values have an effect on the final
weight estimates because the optimization gets stuck in a local optimum.
To avoid this, the <code><a href="../reference/qpgraph.html">qpgraph()</a></code> weight optimization is
repeated with different randomly chosen combinations of starting
weights, and the final likelihood score represents the best score out of
all tries. By default, 10 different random combinations of starting
weights are evaluated. Decreasing this number can speed up
<code><a href="../reference/qpgraph.html">qpgraph()</a></code>, and increasing it can reduce the risk of missing
the global optimum.</p>
<p>To get a better sense of how stable the edge weight optimization is,
it makes sense to inspect the <code>opt</code> output of
<code><a href="../reference/qpgraph.html">qpgraph()</a></code>. This data frame contains all random initial
weight combinations, as well as the optimized weights, final scores
(<code>value</code>) and additional information about the optimization
generated by the <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> function.</p>
<p>In this example, the optimization is very stable, and the initial
values do not affect the estimated weights (columns <code>p1</code> to
<code>p3</code>) or the score (column <code>value</code>):</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">example_opt</span><span class="op">$</span><span class="va">graph</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">opt</span></code></pre></div>
<pre><code>##      i.Rruro      i.Rrl   i.admixi   e.Rruro     e.Rrl  e.admixi    value
## 1  0.7869089 0.51683815 0.44765028 0.8207481 0.4151099 0.9926996 2.599567
## 2  0.2047606 0.39868031 0.97083814 0.8207477 0.4151097 0.9926996 2.599567
## 3  0.7554295 0.21351210 0.30068472 0.8207477 0.4151097 0.9926996 2.599567
## 4  0.5907475 0.66061848 0.01923873 0.8207477 0.4151097 0.9926996 2.599567
## 5  0.1841134 0.59128200 0.02573707 0.8207477 0.4151097 0.9926996 2.599567
## 6  0.5793719 0.34323020 0.38785006 0.8207479 0.4151099 0.9926996 2.599567
## 7  0.3981763 0.62059686 0.01098112 0.8207477 0.4151097 0.9926996 2.599567
## 8  0.3291633 0.41481563 0.01221149 0.8207477 0.4151097 0.9926996 2.599567
## 9  0.6494723 0.41850943 0.99405446 0.8207477 0.4151097 0.9926996 2.599567
## 10 0.5455378 0.02320606 0.08414169 0.8207477 0.4151097 0.9926996 2.599567
##    fevals gevals convergence
## 1      22     22           0
## 2      14     14           0
## 3      18     18           0
## 4      21     21           0
## 5      60     60          52
## 6      23     23           0
## 7      18     18           0
## 8      19     19           0
## 9      13     13           0
## 10     23     23           0</code></pre>
<p>Here, the optimization depends a bit more on the initial weights, and
the weights for the admixture nodes <code>N3N4</code> and
<code>N3N8</code> can not be estimated robustly (because they are not
identifiable in this graph):</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_qpgraph_ref_results</span><span class="op">$</span><span class="va">opt</span></code></pre></div>
<pre><code>##       i.N2N4     i.N3N4      i.N3N8 e.N2N4 e.N3N4     e.N3N8    value fevals
## 1  0.7616225 0.34647487 0.412249106      0      0 0.00000000 19652.54      2
## 2  0.1795198 0.20519471 0.009456659      0      1 0.05947510 19219.98     27
## 3  0.5789027 0.75595585 0.173031624      0      1 0.05947507 19219.98     15
## 4  0.4161319 0.21328007 0.975338531      0      1 0.05947507 19219.98      7
## 5  0.9409036 0.96037222 0.944441426      0      0 0.00000000 19652.54      2
## 6  0.3354566 0.62811808 0.446383684      0      0 0.00000000 19652.54      2
## 7  0.6299324 0.09815806 0.213384736      0      0 0.00000000 19652.54      2
## 8  0.2220927 0.04966934 0.616733615      0      1 0.05947507 19219.98      7
## 9  0.8463281 0.83502828 0.372245495      0      0 0.00000000 19652.54      2
## 10 0.6660239 0.97142558 0.848605360      0      0 0.00000000 19652.54      2
##    gevals convergence
## 1       2           0
## 2      27           0
## 3      15           0
## 4       7           0
## 5       2           0
## 6       2           0
## 7       2           0
## 8       7           0
## 9       2           0
## 10      2           0</code></pre>
<p>The range of estimated weights for each admixture edge is also stored
in the <code>low</code> and <code>high</code> columns of the
<code>edges</code> data frame returned by <code><a href="../reference/qpgraph.html">qpgraph()</a></code>. The
<code><a href="../reference/plot_comparison.html">plot_comparison()</a></code> function visualizes that information with
gray error bars.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_comparison.html">plot_comparison</a></span><span class="op">(</span><span class="va">example_qpgraph_ref_results</span>, <span class="va">example_qpgraph_ref_results</span><span class="op">)</span></code></pre></div>
<p><img src="graphs_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<!-- ### Precomputed $f_3$-statistics -->
<!-- The first steps in `qpgraph()` are computing $f_3$-statistics from $f_2$-statistics, and computing the inverse of the $f_3$-statistic covariance matrix. When many graphs are evaluated for the same populations, it can be faster to run these steps only once and pass $f_3$-statistics and the inverse of the covariance matrix to the `qpgraph()` function. That is the purpose of the `f3precomp` and `ppinv` arguments. The `f3precomp` argument expects a list with $f_3$-statistics and the inverse of the covariance matrix. It is used for example in `find_graphs()`. -->
<!-- The `ppinv` argument expects only the inverse of the covariance matrix, while $f_3$-statistics will be computed inside `qpgraph()`. This is used in `qpgraph_resample_multi()` to use an inverse covariance matrix computed on a different set of SNPs. -->
</div>
<div id="regularization-terms" class="section level3">
<h3 class="hasAnchor">
<a href="#regularization-terms" class="anchor"></a>Regularization terms</h3>
<p>There are two regularization terms used in <em>qpGraph</em>, which
make matrix inversions more stable.</p>
<p>One is called <code>diag</code> and is added to the covariance matrix
of fitted branch lengths (after multiplying it by the mean of the
diagonal elements). It is the same as the <code>diag</code> parameter in
the original <em>qpGraph</em> program and defaults to 10<sup>-4</sup>.
Increasing <code>diag</code> will shift the likelihood scores to be
<em>further away from zero</em>. This regularization term ensures that
edge weights will be evenly distributed across a set of edges whose
weights could otherwise not be determined unambiguously. (As is often
the case with the two edges originating in the root node.)</p>
<p>The other regularization term is added to the diagonal elements of
the <span class="math inline">\(f_3\)</span> covariance matrix (after
multiplying it by the mean of the diagonal elements). It is called
<code>diag_f3</code> and defaults to 10<sup>-5</sup>. In the original
<em>qpGraph</em> program it is fixed at that value. Increasing this
factor has a small effect on admixture weights and branch lengths, and
will shift the likelihood scores to be <em>closer to zero</em>.</p>
<p>The regularization terms affect the likelihood score, so they should
be kept constant whenever fits of different graphs are compared to each
other.</p>
</div>
<div id="edge-constraints" class="section level3">
<h3 class="hasAnchor">
<a href="#edge-constraints" class="anchor"></a>Edge constraints</h3>
<p>When fitting an admixture graph, we search for admixture and drift
weights which minimize the sum of squared differences between expected
and observed <em>f</em>-statistics. Usually the drift edges are
constrained to be non-negative, and the admixture weights are
constrained to be between zero and one, and to add up to one at each
admixture node.</p>
<p>It is possible to fit a graph without these constraints, by setting
<code>constrained = FALSE</code> in <code><a href="../reference/qpgraph.html">qpgraph()</a></code>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">example_igraph</span>, constrained <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">edges</span> <span class="op">%&gt;%</span>
  <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-1d34660ebc3177f92e36" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1d34660ebc3177f92e36">{"x":{"data":[{"x":[0,2],"y":[-1,-2],"text":"N3N5 -> N3N8","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,1],"y":[0,-1],"text":"N2N3 -> N2N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,0],"y":[1,0],"text":"N3N2 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[2,0],"text":"N3N3 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1,null,2,2],"y":[3,-1,null,3,-2],"text":["N2N2 -> N2N4","N2N2 -> N2N4",null,"N3N7 -> N3N8","N3N7 -> N3N8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,2],"y":[-2,-3],"text":"N3N8 -> Russia_Ust_Ishim.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[-1,-2],"text":"N2N4 -> Mbuti.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[0,-1],"text":"N3N4 -> N3N5","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2],"y":[1,0,null,1,0],"text":["N2N1 -> Vindija.DG","N2N1 -> Vindija.DG",null,"N2N1 -> N2N3","N2N1 -> N2N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,-2.5,null,-2,-1.5],"y":[2,1,null,2,1],"text":["N3N0 -> N2N1","N3N0 -> N2N1",null,"N3N0 -> N3N2","N3N0 -> N3N2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2,null,-0.5,-1,null,-0.5,0],"y":[3,2,null,3,2,null,3,2,null,3,2],"text":["N0N -> Altai_Neanderthal.DG","N0N -> Altai_Neanderthal.DG",null,"N0N -> N3N0","N0N -> N3N0",null,"N3N1 -> Denisova.DG","N3N1 -> Denisova.DG",null,"N3N1 -> N3N3","N3N1 -> N3N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,-2.5,null,-1.5,-0.5,null,1.5,1,null,1.5,2],"y":[4,3,null,4,3,null,4,3,null,4,3],"text":["N1N -> N0N","N1N -> N0N",null,"N1N -> N3N1","N1N -> N3N1",null,"N3N6 -> N2N2","N3N6 -> N2N2",null,"N3N6 -> N3N7","N3N6 -> N3N7"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1.5,null,0,1.5],"y":[5,4,null,5,4],"text":["N2N0 -> N1N","N2N0 -> N1N",null,"N2N0 -> N3N6","N2N0 -> N3N6"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[6,5,null,6,5],"text":["N4N -> N2N0","N4N -> N2N0",null,"N4N -> Switzerland_Bichon.SG","N4N -> Switzerland_Bichon.SG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[7,6,null,7,6],"text":["R -> Chimp.REF","R -> Chimp.REF",null,"R -> N4N","R -> N4N"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-2.5,-1.5,0,-2.5,1,-2,-0.5,0,1.5,2,0.5,1,-1.5,0,-2,0,2],"y":[7,3,4,5,1,-1,2,3,0,4,-2,6,3,1,-1,0,2,3],"text":["R","N0N","N1N","N2N0","N2N1","N2N4","N3N0","N3N1","N3N4","N3N6","N3N8","N4N","N2N2","N3N2","N3N5","N2N3","N3N3","N3N7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,-2.75,-2.25,-2,-1,-0.75,0.75,-2.75,-2.25,1,-2.25,-1.75,-0.75,-0.25,0,1.25,1.75,2,0.25,0.75,1,-0.75,1,-0.5,0,2],"y":[6.5,6.5,2.5,2.5,3.5,3.5,4.5,4.5,0.5,0.5,-1.5,1.5,1.5,2.5,2.5,-0.5,3.5,3.5,-2.5,5.5,5.5,1,0.5,-1.5,-0.5,1,0.5],"text":["76","76","4","9","87","-28","41","27","106","0","10","-104","0","101","0","0","10","0","1","-12","226","99%","7%","23%","1%","93%","77%"],"hovertext":["R -> Chimp.REF","R -> N4N","N0N -> Altai_Neanderthal.DG","N0N -> N3N0","N1N -> N0N","N1N -> N3N1","N2N0 -> N1N","N2N0 -> N3N6","N2N1 -> Vindija.DG","N2N1 -> N2N3","N2N4 -> Mbuti.DG","N3N0 -> N2N1","N3N0 -> N3N2","N3N1 -> Denisova.DG","N3N1 -> N3N3","N3N4 -> N3N5","N3N6 -> N2N2","N3N6 -> N3N7","N3N8 -> Russia_Ust_Ishim.DG","N4N -> N2N0","N4N -> Switzerland_Bichon.SG","N2N2 -> N2N4","N3N2 -> N3N4","N3N5 -> N3N8","N2N3 -> N2N4","N3N3 -> N3N4","N3N7 -> N3N8"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2],"y":[-3.1],"text":"Russia_Ust_Ishim.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-2.1],"text":"Mbuti.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(216,144,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3],"y":[-0.1],"text":"Vindija.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(57,182,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,-1],"y":[1.9,1.9],"text":["Altai_Neanderthal.DG","Denisova.DG"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[4.9],"text":"Switzerland_Bichon.SG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[5.9],"text":"Chimp.REF","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,98,188,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5],"y":[7],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.6,2.6],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,4.44089209850063e-16,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.605,7.505],"tickmode":"array","ticktext":["-2.5","0.0","2.5","5.0","7.5"],"tickvals":[-2.5,-4.44089209850063e-16,2.5,5,7.5],"categoryorder":"array","categoryarray":["-2.5","0.0","2.5","5.0","7.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"1304078117f9d":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"1304044d15a00":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"13040c6bd94c":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"130407c8712f2":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130407ed0dbd":{"y":{}},"130405c20f75b":{"x":{},"y":{}}},"cur_data":"1304078117f9d","visdat":{"1304078117f9d":["function (y) ","x"],"1304044d15a00":["function (y) ","x"],"13040c6bd94c":["function (y) ","x"],"130407c8712f2":["function (y) ","x"],"130407ed0dbd":["function (y) ","x"],"130405c20f75b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Negative drift lengths or admixture weights are difficult to
interpret, but they are used by <code><a href="../reference/find_graphs.html">find_graphs()</a></code> for more
efficiently searching the space of graph topologies.</p>
<p>Whatâ€™s often more useful in practice is to put additional constraints
on some edges, for example requiring at least a certain amount of
admixture from a source, or restricting how much drift can occur on a
particular edge. We can do this by passing a graph in data frame format
with columns <code>lower</code> and <code>upper</code> to
<code><a href="../reference/qpgraph.html">qpgraph()</a></code>. (Note the difference between the columns
<code>lower</code> and <code>upper</code>, which will constrain the fit
of a graph when used as input to <code><a href="../reference/qpgraph.html">qpgraph()</a></code>, and the columns
<code>low</code> and <code>high</code>, which are generated in the
output and report the lowest and highest weights for different initial
values!)</p>
<p>In this example one admixture edge is constrained to be exactly 0.3
by setting both its lower and its upper bound:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_graph</span> <span class="op">%&gt;%</span> <span class="fu">mutate</span><span class="op">(</span>lower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">from</span> <span class="op">==</span> <span class="st">'N3N3'</span>, <span class="fl">0.3</span>, <span class="cn">NA</span><span class="op">)</span>, upper <span class="op">=</span> <span class="va">lower</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">.</span><span class="op">)</span> <span class="op">%$%</span> <span class="va">edges</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-2e4e7bc68aed74a468dd" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2e4e7bc68aed74a468dd">{"x":{"data":[{"x":[0,2],"y":[-1,-2],"text":"N3N5 -> N3N8","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,1],"y":[0,-1],"text":"N2N3 -> N2N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,0],"y":[1,0],"text":"N3N2 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[2,0],"text":"N3N3 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1,null,2,2],"y":[3,-1,null,3,-2],"text":["N2N2 -> N2N4","N2N2 -> N2N4",null,"N3N7 -> N3N8","N3N7 -> N3N8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,2],"y":[-2,-3],"text":"N3N8 -> Russia_Ust_Ishim.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[-1,-2],"text":"N2N4 -> Mbuti.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[0,-1],"text":"N3N4 -> N3N5","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2],"y":[1,0,null,1,0],"text":["N2N1 -> Vindija.DG","N2N1 -> Vindija.DG",null,"N2N1 -> N2N3","N2N1 -> N2N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,-2.5,null,-2,-1.5],"y":[2,1,null,2,1],"text":["N3N0 -> N2N1","N3N0 -> N2N1",null,"N3N0 -> N3N2","N3N0 -> N3N2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2,null,-0.5,-1,null,-0.5,0],"y":[3,2,null,3,2,null,3,2,null,3,2],"text":["N0N -> Altai_Neanderthal.DG","N0N -> Altai_Neanderthal.DG",null,"N0N -> N3N0","N0N -> N3N0",null,"N3N1 -> Denisova.DG","N3N1 -> Denisova.DG",null,"N3N1 -> N3N3","N3N1 -> N3N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,-2.5,null,-1.5,-0.5,null,1.5,1,null,1.5,2],"y":[4,3,null,4,3,null,4,3,null,4,3],"text":["N1N -> N0N","N1N -> N0N",null,"N1N -> N3N1","N1N -> N3N1",null,"N3N6 -> N2N2","N3N6 -> N2N2",null,"N3N6 -> N3N7","N3N6 -> N3N7"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1.5,null,0,1.5],"y":[5,4,null,5,4],"text":["N2N0 -> N1N","N2N0 -> N1N",null,"N2N0 -> N3N6","N2N0 -> N3N6"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[6,5,null,6,5],"text":["N4N -> N2N0","N4N -> N2N0",null,"N4N -> Switzerland_Bichon.SG","N4N -> Switzerland_Bichon.SG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[7,6,null,7,6],"text":["R -> Chimp.REF","R -> Chimp.REF",null,"R -> N4N","R -> N4N"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-2.5,-1.5,0,-2.5,1,-2,-0.5,0,1.5,2,0.5,1,-1.5,0,-2,0,2],"y":[7,3,4,5,1,-1,2,3,0,4,-2,6,3,1,-1,0,2,3],"text":["R","N0N","N1N","N2N0","N2N1","N2N4","N3N0","N3N1","N3N4","N3N6","N3N8","N4N","N2N2","N3N2","N3N5","N2N3","N3N3","N3N7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,-2.75,-2.25,-2,-1,-0.75,0.75,-2.75,-2.25,1,-2.25,-1.75,-0.75,-0.25,0,1.25,1.75,2,0.25,0.75,1,-0.75,1,-0.5,0,2],"y":[6.5,6.5,2.5,2.5,3.5,3.5,4.5,4.5,0.5,0.5,-1.5,1.5,1.5,2.5,2.5,-0.5,3.5,3.5,-2.5,5.5,5.5,1,0.5,-1.5,-0.5,1,0.5],"text":["72","72","3","11","84","0","38","15","0","0","12","0","0","73","0","0","12","0","0","0","222","100%","70%","7%","0%","30%","93%"],"hovertext":["R -> Chimp.REF","R -> N4N","N0N -> Altai_Neanderthal.DG","N0N -> N3N0","N1N -> N0N","N1N -> N3N1","N2N0 -> N1N","N2N0 -> N3N6","N2N1 -> Vindija.DG","N2N1 -> N2N3","N2N4 -> Mbuti.DG","N3N0 -> N2N1","N3N0 -> N3N2","N3N1 -> Denisova.DG","N3N1 -> N3N3","N3N4 -> N3N5","N3N6 -> N2N2","N3N6 -> N3N7","N3N8 -> Russia_Ust_Ishim.DG","N4N -> N2N0","N4N -> Switzerland_Bichon.SG","N2N2 -> N2N4","N3N2 -> N3N4","N3N5 -> N3N8","N2N3 -> N2N4","N3N3 -> N3N4","N3N7 -> N3N8"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2],"y":[-3.1],"text":"Russia_Ust_Ishim.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-2.1],"text":"Mbuti.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(216,144,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3],"y":[-0.1],"text":"Vindija.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(57,182,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,-1],"y":[1.9,1.9],"text":["Altai_Neanderthal.DG","Denisova.DG"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[4.9],"text":"Switzerland_Bichon.SG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[5.9],"text":"Chimp.REF","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,98,188,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5],"y":[7],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.6,2.6],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,4.44089209850063e-16,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.605,7.505],"tickmode":"array","ticktext":["-2.5","0.0","2.5","5.0","7.5"],"tickvals":[-2.5,-4.44089209850063e-16,2.5,5,7.5],"categoryorder":"array","categoryarray":["-2.5","0.0","2.5","5.0","7.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130404600a09c":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"13040533085ab":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"130401697c838":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"1304046d9e01e":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"13040a08f5e9":{"y":{}},"1304052489924":{"x":{},"y":{}}},"cur_data":"130404600a09c","visdat":{"130404600a09c":["function (y) ","x"],"13040533085ab":["function (y) ","x"],"130401697c838":["function (y) ","x"],"1304046d9e01e":["function (y) ","x"],"13040a08f5e9":["function (y) ","x"],"1304052489924":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="confidence-intervals" class="section level3">
<h3 class="hasAnchor">
<a href="#confidence-intervals" class="anchor"></a>Confidence intervals</h3>
<p>In <em>ADMIXTOOLS 2</em>, you can compute confidence intervals for
the estimated drift lengths and admixture weights. This is done by
fitting the same graph many times using different random subsets of SNP
blocks. This makes it slow compared to fitting a graph just once on all
SNPs, but it can give you a sense of how robust the estimates on the
different edges are.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fits</span> <span class="op">=</span> <span class="fu"><a href="../reference/resample_snps.html">qpgraph_resample_snps</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">example_igraph</span>, boot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">fits</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/summarize_fits.html">summarize_fits</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>print_highlow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-6489fdd7868ebf9d2ade" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-6489fdd7868ebf9d2ade">{"x":{"data":[{"x":[-1,1],"y":[-1,-2],"text":"N3N5 -> N3N8","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4,0],"y":[0,-1],"text":"N2N3 -> N2N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-1],"y":[1,0],"text":"N3N2 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,-1],"y":[2,0],"text":"N3N3 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0,null,1,1],"y":[3,-1,null,3,-2],"text":["N2N2 -> N2N4","N2N2 -> N2N4",null,"N3N7 -> N3N8","N3N7 -> N3N8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[-2,-3],"text":"N3N8 -> Russia_Ust_Ishim.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[-1,-2],"text":"N2N4 -> Mbuti.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,-1],"y":[0,-1],"text":"N3N4 -> N3N5","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.5,-4,null,-3.5,-3],"y":[1,0,null,1,0],"text":["N2N1 -> N2N3","N2N1 -> N2N3",null,"N2N1 -> Vindija.DG","N2N1 -> Vindija.DG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,-3.5,null,-3,-2.5],"y":[2,1,null,2,1],"text":["N3N0 -> N2N1","N3N0 -> N2N1",null,"N3N0 -> N3N2","N3N0 -> N3N2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.5,-4,null,-3.5,-3,null,-1.5,-2,null,-1.5,-1],"y":[3,2,null,3,2,null,3,2,null,3,2],"text":["N0N -> Altai_Neanderthal.DG","N0N -> Altai_Neanderthal.DG",null,"N0N -> N3N0","N0N -> N3N0",null,"N3N1 -> Denisova.DG","N3N1 -> Denisova.DG",null,"N3N1 -> N3N3","N3N1 -> N3N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3.5,null,-2.5,-1.5,null,0.5,0,null,0.5,1],"y":[4,3,null,4,3,null,4,3,null,4,3],"text":["N1N -> N0N","N1N -> N0N",null,"N1N -> N3N1","N1N -> N3N1",null,"N3N6 -> N2N2","N3N6 -> N2N2",null,"N3N6 -> N3N7","N3N6 -> N3N7"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,-2.5,null,-1,0.5],"y":[5,4,null,5,4],"text":["N2N0 -> N1N","N2N0 -> N1N",null,"N2N0 -> N3N6","N2N0 -> N3N6"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,-1,null,-0.5,0],"y":[6,5,null,6,5],"text":["N4N -> N2N0","N4N -> N2N0",null,"N4N -> Switzerland_Bichon.SG","N4N -> Switzerland_Bichon.SG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,null,0,-0.5],"y":[7,6,null,7,6],"text":["R -> Chimp.REF","R -> Chimp.REF",null,"R -> N4N","R -> N4N"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.5,-2.5,-1,-3.5,0,-4,0,-3,-1.5,-2.5,-1,-1,-1,0.5,1,1,-0.5,0],"y":[3,4,5,1,3,0,-1,2,3,1,2,0,-1,4,3,-2,6,7],"text":["N0N","N1N","N2N0","N2N1","N2N2","N2N3","N2N4","N3N0","N3N1","N3N2","N3N3","N3N4","N3N5","N3N6","N3N7","N3N8","N4N","R"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.75,-3.25,-3,-2,-1.75,-0.25,-3.75,-3.25,0,-2,0,-3.25,-2.75,-1.75,-1.25,-1.75,-1,-1,0,0.25,0.75,1,1,-0.75,-0.25,0.25,-0.25],"y":[2.5,2.5,3.5,3.5,4.5,4.5,0.5,0.5,1,-0.5,-1.5,1.5,1.5,2.5,2.5,0.5,1,-0.5,-1.5,3.5,3.5,0.5,-2.5,5.5,5.5,6.5,6.5],"text":["4<br />[1-7]","10<br />[2-15]","84<br />[78-90]","36<br />[33-40]","38<br />[34-43]","15<br />[12-18]","0<br />[0-0]","1<br />[0-4]","100%<br />[100%-100%]","0%<br />[0%-0%]","12<br />[10-15]","1<br />[0-4]","0<br />[0-0]","36<br />[33-40]","0<br />[0-0]","100%<br />[100%-100%]","0%<br />[0%-0%]","0<br />[0-0]","6%<br />[3%-9%]","12<br />[10-15]","1<br />[0-4]","94%<br />[91%-97%]","1<br />[0-4]","0<br />[0-0]","222<br />[216-228]","73<br />[71-74]","73<br />[71-74]"],"hovertext":["N0N -> Altai_Neanderthal.DG","N0N -> N3N0","N1N -> N0N","N1N -> N3N1","N2N0 -> N1N","N2N0 -> N3N6","N2N1 -> N2N3","N2N1 -> Vindija.DG","N2N2 -> N2N4","N2N3 -> N2N4","N2N4 -> Mbuti.DG","N3N0 -> N2N1","N3N0 -> N3N2","N3N1 -> Denisova.DG","N3N1 -> N3N3","N3N2 -> N3N4","N3N3 -> N3N4","N3N4 -> N3N5","N3N5 -> N3N8","N3N6 -> N2N2","N3N6 -> N3N7","N3N7 -> N3N8","N3N8 -> Russia_Ust_Ishim.DG","N4N -> N2N0","N4N -> Switzerland_Bichon.SG","R -> Chimp.REF","R -> N4N"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-3.1],"text":"Russia_Ust_Ishim.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[-2.1],"text":"Mbuti.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(216,144,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3],"y":[-0.1],"text":"Vindija.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(57,182,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4,-2],"y":[1.9,1.9],"text":["Altai_Neanderthal.DG","Denisova.DG"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[4.9],"text":"Switzerland_Bichon.SG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5],"y":[5.9],"text":"Chimp.REF","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,98,188,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4],"y":[7],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.6,1.6],"tickmode":"array","ticktext":["-4","-2","0"],"tickvals":[-4,-2,0],"categoryorder":"array","categoryarray":["-4","-2","0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.605,7.505],"tickmode":"array","ticktext":["-2.5","0.0","2.5","5.0","7.5"],"tickvals":[-2.5,-4.44089209850063e-16,2.5,5,7.5],"categoryorder":"array","categoryarray":["-2.5","0.0","2.5","5.0","7.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130406338dfc":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"1304022ae9e92":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"13040762c9507":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"1304068ec3b2d":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130406d213d2b":{"y":{}},"1304021370a06":{"x":{},"y":{}}},"cur_data":"130406338dfc","visdat":{"130406338dfc":["function (y) ","x"],"1304022ae9e92":["function (y) ","x"],"13040762c9507":["function (y) ","x"],"1304068ec3b2d":["function (y) ","x"],"130406d213d2b":["function (y) ","x"],"1304021370a06":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="why-f3" class="section level3">
<h3 class="hasAnchor">
<a href="#why-f3" class="anchor"></a>Why f3?</h3>
<p><code><a href="../reference/qpgraph.html">qpgraph()</a></code> uses <span class="math inline">\(f_3\)</span>-
rather than <span class="math inline">\(f_2\)</span>-statistics for
modeling graphs. <span class="math inline">\(f_3\)</span>- and <span class="math inline">\(f_4\)</span>-statistics are just sums of <span class="math inline">\(f_2\)</span>-statistics, in particular</p>
<p><span class="math display">\[f_3(A; B, C) = \frac{1}{2}
(f_2(A,B)+f_2(A,C)-f_2(B,C))\]</span></p>
<p>This raises the question whether it makes a difference to express a
graph in terms of equations for <span class="math inline">\(f_2\)</span>-statistics or equations for <span class="math inline">\(f_3\)</span>-statistics. If there is an exact
solution for one of the (<span class="math inline">\(f_2\)</span> or
<span class="math inline">\(f_3\)</span>) equation system, it is also a
solution for the other equation system. In a case like that, the choice
of <em>f</em>-statistics used does not make a difference.</p>
<p>In practice, however, there usually is no exact solution for a given
graph and set of <em>f</em>-statistics. Instead, <code><a href="../reference/qpgraph.html">qpgraph()</a></code>
estimates weights which minimize the sum of squared differences between
the expected and the observed <em>f</em>-statistics, and this difference
is usually greater than zero. In that case, an equation system of <span class="math inline">\(f_2\)</span>-statistics can lead to different
weight estimates than an equation system of <span class="math inline">\(f_3\)</span>-statistics. In particular, using
<span class="math inline">\(f_3\)</span>-statistics will give more
importance to the internal edges of the admixture graph, rather than the
terminal edges leading to the leaf nodes. Thatâ€™s because each <span class="math inline">\(f_2\)</span>-statistic can be thought of as the
distance between two leaf nodes, while most <span class="math inline">\(f_3\)</span>-statistics (all except the ones of
the form <span class="math inline">\(f_3(A; B, B)\)</span>) can be
thought of as the distance between one leaf node (ideally an outgroup)
and some internal node (the split point of the other two populations, in
the simplest case without admixture).</p>
<p><br></p>
</div>
</div>
<div id="exploring-different-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-different-graphs" class="anchor"></a>Exploring different graphs</h2>
<p>An advantage of being able to quickly evaluate a single model using
precomputed <em>f</em>-statistics is that we can evaluate many different
graphs in order to find graph topologies with good fits. This can either
be done in a fully automated way (similar to TreeMix) or in a
semi-automated way, similar for example to the admixture graph R
package.</p>
<div id="fully-automated-graph-exploration" class="section level3">
<h3 class="hasAnchor">
<a href="#fully-automated-graph-exploration" class="anchor"></a>Fully automated graph exploration</h3>
<!-- **I recently made a couple of changes to `find_graphs()`. It's now faster, but the input arguments and output format have changed a bit. -->
<!-- The old function is still available under the name `find_graphs_old()`. Please let me know if you encounter any problems!** -->
<p>The function <code><a href="../reference/find_graphs.html">find_graphs()</a></code> searches for admixture graphs
that are compatible with the observed <em>f</em>-statistics. It starts
with a random admixture graph, and continuously improves it by making
random and targeted changes to the graph. The outgroup and the number of
admixture edges are held constant.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">opt_results</span> <span class="op">=</span> <span class="fu"><a href="../reference/find_graphs.html">find_graphs</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, numadmix <span class="op">=</span> <span class="fl">3</span>, outpop <span class="op">=</span> <span class="st">'Chimp.REF'</span>,
                          stop_gen <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<p>The output of <code><a href="../reference/find_graphs.html">find_graphs()</a></code> (<code>opt_results</code>)
will be a <a href="https://r4ds.had.co.nz/many-models.html#nested-data">nested data
frame</a>, with each tested model in one line. Some columns in this data
frame, like <code>score</code>, are regular numbers, while other
columns, like <code>edges</code>, are <em>list-columns</em> where each
element is a data frame.</p>
<p><br></p>
<p>The following command will extract the best fitting model:</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">winner</span> <span class="op">=</span> <span class="va">opt_results</span> <span class="op">%&gt;%</span> <span class="fu">slice_min</span><span class="op">(</span><span class="va">score</span>, with_ties <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">winner</span><span class="op">$</span><span class="va">score</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 2.599567</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_graph.html">plot_graph</a></span><span class="op">(</span><span class="va">winner</span><span class="op">$</span><span class="va">edges</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="graphs_files/figure-html/unnamed-chunk-35-1.png" width="864" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/find_graphs.html">find_graphs()</a></code> can get stuck in local optima: it wonâ€™t be
able to improve the graph even though better graphs exist. This is
especially true for graphs with many populations and admixture events.
In that case, it can help to run <code><a href="../reference/find_graphs.html">find_graphs()</a></code> many times.
Each run will begin with a different random graph, which increases the
chances of finding graphs that are close to the global optimum.</p>
<p><br></p>
<div id="constraining-the-search-space" class="section level4">
<h4 class="hasAnchor">
<a href="#constraining-the-search-space" class="anchor"></a>Constraining the search space</h4>
<p>Sometimes it is useful to not search for any graphs that fit the
data, but to incorporate prior knowledge by constraining the set of
graphs that should be considered. This can be done by passing additional
arguments to <code><a href="../reference/find_graphs.html">find_graphs()</a></code>, which end in
<code>_constraints</code>. More on this <a href="#summarizing-graphs-1">here</a>.</p>
<p>The following example shows how could specify that we only want to
consider models in which the first two populations are unadmixed
(setting the maximum to 0), and the third population is admixed (setting
the minimum to 1).</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">constraints</span> <span class="op">=</span> <span class="fu">tribble</span><span class="op">(</span>
  <span class="op">~</span><span class="va">pop</span>, <span class="op">~</span><span class="va">min</span>, <span class="op">~</span><span class="va">max</span>,
  <span class="st">'Altai_Neanderthal.DG'</span>, <span class="cn">NA</span>, <span class="fl">0</span>,
  <span class="st">'Denisova.DG'</span>, <span class="cn">NA</span>, <span class="fl">0</span>,
  <span class="st">'Russia_Ust_Ishim.DG'</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="va">opt_results</span> <span class="op">=</span> <span class="fu"><a href="../reference/find_graphs.html">find_graphs</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, numadmix <span class="op">=</span> <span class="fl">3</span>, outpop <span class="op">=</span> <span class="st">'Chimp.REF'</span>,
                          stop_gen <span class="op">=</span> <span class="fl">100</span>, admix_constraints <span class="op">=</span> <span class="va">constraints</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="semi-automated-graph-exploration" class="section level3">
<h3 class="hasAnchor">
<a href="#semi-automated-graph-exploration" class="anchor"></a>Semi-automated graph exploration</h3>
<p>Rather than modifying admixture graphs manually and only testing a
small number of models, you can start with a graph and let
<em>ADMIXTOOLS 2</em> generate and evaluate graphs for you.</p>
<p>The following functions take a graph and return lists of new, similar
graphs:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_plusone.html">graph_plusone</a></span><span class="op">(</span><span class="va">example_igraph</span><span class="op">)</span>
<span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_minusone.html">graph_minusone</a></span><span class="op">(</span><span class="va">example_igraph</span><span class="op">)</span>
<span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_minusplus.html">graph_minusplus</a></span><span class="op">(</span><span class="va">example_igraph</span><span class="op">)</span>
<span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_flipadmix.html">graph_flipadmix</a></span><span class="op">(</span><span class="va">example_igraph</span><span class="op">)</span>
<span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_splittrees.html">graph_splittrees</a></span><span class="op">(</span><span class="va">example_igraph</span><span class="op">)</span></code></pre></div>
<p>To evaluate the new graphs, type:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newgraphs</span> <span class="op">%&gt;%</span>
  <span class="va">rowwise</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">graph</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest_wider</span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">score</span><span class="op">)</span></code></pre></div>
<p>or, if you want to <a href="parallel.html">parallelize</a> this,</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newgraphs</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>res <span class="op">=</span> <span class="fu">furrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/furrr/man/future_map.html">future_map</a></span><span class="op">(</span><span class="va">graph</span>, <span class="op">~</span><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest_wider</span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">score</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 8 x 7
##    name graph    edges              score f3                opt   ppinv         
##   &lt;int&gt; &lt;list&gt;   &lt;list&gt;             &lt;dbl&gt; &lt;list&gt;            &lt;lgl&gt; &lt;list&gt;        
## 1     6 &lt;igraph&gt; &lt;tibble [12 Ã— 6]&gt; 19653. &lt;tibble [21 Ã— 9]&gt; NA    &lt;dbl [21 Ã— 21â€¦
## 2     8 &lt;igraph&gt; &lt;tibble [12 Ã— 6]&gt; 19653. &lt;tibble [21 Ã— 9]&gt; NA    &lt;dbl [21 Ã— 21â€¦
## 3     2 &lt;igraph&gt; &lt;tibble [12 Ã— 6]&gt; 26962. &lt;tibble [21 Ã— 9]&gt; NA    &lt;dbl [21 Ã— 21â€¦
## 4     4 &lt;igraph&gt; &lt;tibble [12 Ã— 6]&gt; 53066. &lt;tibble [21 Ã— 9]&gt; NA    &lt;dbl [21 Ã— 21â€¦
## 5     3 &lt;igraph&gt; &lt;tibble [12 Ã— 6]&gt; 62301. &lt;tibble [21 Ã— 9]&gt; NA    &lt;dbl [21 Ã— 21â€¦
## 6     5 &lt;igraph&gt; &lt;tibble [12 Ã— 6]&gt; 64137. &lt;tibble [21 Ã— 9]&gt; NA    &lt;dbl [21 Ã— 21â€¦
## 7     7 &lt;igraph&gt; &lt;tibble [12 Ã— 6]&gt; 64137. &lt;tibble [21 Ã— 9]&gt; NA    &lt;dbl [21 Ã— 21â€¦
## 8     1 &lt;igraph&gt; &lt;tibble [12 Ã— 6]&gt; 64137. &lt;tibble [21 Ã— 9]&gt; NA    &lt;dbl [21 Ã— 21â€¦</code></pre>
<p><br></p>
</div>
</div>
<div id="comparing-the-fits-of-different-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-the-fits-of-different-graphs" class="anchor"></a>Comparing the fits of different graphs</h2>
<p>If two different graphs model the same populations and the second
graph has a better likelihood score than the first one, it suggests that
the second graph is a better representation of the actual demographic
history. Thatâ€™s generally true, but there are two complications:</p>
<ol style="list-style-type: decimal">
<li><p>If the second graph is more complex (i.e.Â if it has more
admixture events), it has more degrees of freedom and thus an unfair
advantage over the first one. It might get a better score even if the
simpler graph is closer to the true demographic history.</p></li>
<li><p>It is possible that the difference in scores is due to chance,
and not because one of the two models really fits the data better. What
if we had picked different samples from each population? Or what if we
had picked different SNPs? Would the second model still be preferred
over the first one?</p></li>
</ol>
<p><em>ADMIXTOOLS 2</em> solves the first problem by computing
out-of-sample scores, and the second problem by computing the fit of a
graph using bootstrap-resampled SNP blocks.</p>
<div id="out-of-sample-scores" class="section level3">
<h3 class="hasAnchor">
<a href="#out-of-sample-scores" class="anchor"></a>Out-of-sample scores</h3>
<p><em>qpGraph</em> likelihood scores <span class="math inline">\(S\)</span> are computed by comparing estimated
f3-statistics <span class="math inline">\(g\)</span> to fitted
f3-statistics <span class="math inline">\(f\)</span> - those that we
would expect to observe under a given admixture graph. The difference
between estimated and fitted f3-statistics, the residuals, are adjusted
by the inverse covariance matrix of f3-statistics <span class="math inline">\(Q\)</span>, to get the likelihood score. If this
covariance matrix was the identity matrix, the scores would just be the
squared sum of residuals.</p>
<p><span class="math display">\[S = -\frac{1}{2} (g - f)' Q^{-1} (g
- f)\]</span></p>
<p>Under this definition likelihood scores are actually negative, but
usually the minus sign is dropped and positive scores are reported
instead.</p>
<p>In fitting edge weights, <em>qpGraph</em> maximizes this likelihood
score (bringing it closer to 0). To avoid overfitting, we can compute a
new score <span class="math inline">\(S'\)</span> after fitting the
model, using SNPs (or SNP blocks) which havenâ€™t been used for fitting
the model:</p>
<p><span class="math display">\[S' = -\frac{1}{2} (g_{train} -
f_{test})' Q^{-1} (g_{train} - f_{test})\]</span></p>
<p>These scores tend to be further away from zero, but they allow us to
fairly compare models of different complexity to each other.</p>
<p>In <em>ADMIXTOOLS 2</em>, you can compute out-of-sample scores by
providing the <code><a href="../reference/qpgraph.html">qpgraph()</a></code> function with an
<code>f2_blocks_test</code> argument.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nblocks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">example_f2_blocks</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="va">train</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nblocks</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">nblocks</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example_f2_blocks</span><span class="op">[</span>,,<span class="va">train</span><span class="op">]</span>, <span class="va">example_graph</span>,
              f2_blocks_test <span class="op">=</span> <span class="va">example_f2_blocks</span><span class="op">[</span>,,<span class="op">-</span><span class="va">train</span><span class="op">]</span><span class="op">)</span>
<span class="va">res</span><span class="op">$</span><span class="va">score</span></code></pre></div>
<pre><code>## [1] 8773.425</code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span><span class="op">$</span><span class="va">score_test</span></code></pre></div>
<pre><code>## [1] 8772.342</code></pre>
</div>
<div id="bootstrap-resampled-graph-fits" class="section level3">
<h3 class="hasAnchor">
<a href="#bootstrap-resampled-graph-fits" class="anchor"></a>Bootstrap-resampled graph fits</h3>
<p>Out-of-sample scores allow us to get fair comparisons for any two
admixture graphs, but they still donâ€™t tell us whether a difference is
significant. For that, we can use bootstrap resampling of SNP blocks:
Each graph is evaluated many times on a random subset of SNP blocks. The
variation among those scores tells us whether the scores of both graphs
are significantly different from one another.</p>
<p>To combine this idea with out-of-sample scores to prevent
overfitting, we can use the SNP blocks which were not selected in each
bootstrap iteration as the out-of-sample SNP blocks.</p>
<p>The following example shows how to test whether <code>graph1</code>
gives a significantly better fit than <code>graph2</code>:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">graph1</span> <span class="op">=</span> <span class="va">example_opt</span> <span class="op">%&gt;%</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">'graph'</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">graph2</span> <span class="op">=</span> <span class="va">example_opt</span> <span class="op">%&gt;%</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">'graph'</span>, <span class="fl">100</span><span class="op">)</span>
<span class="va">fits</span> <span class="op">=</span> <span class="fu"><a href="../reference/qpgraph_resample_multi.html">qpgraph_resample_multi</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">graph1</span>, <span class="va">graph2</span><span class="op">)</span>, nboot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu"><a href="../reference/compare_fits.html">compare_fits</a></span><span class="op">(</span><span class="va">fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">score_test</span>, <span class="va">fits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">score_test</span><span class="op">)</span></code></pre></div>
<p><br></p>
</div>
</div>
<div id="summarizing-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#summarizing-graphs" class="anchor"></a>Summarizing graphs</h2>
<p>Admixture graphs for more than a few populations quickly become very
complex. They contain a large amount of information about the
relationship between the modeled populations, which is another way of
saying that the number of possible graphs grows rapidly as the number of
populations and the number of admixture events grows.</p>
<p>Often there are specific features of an admixture graph that are of
primary interest. For example, whether a population is admixed or
unadmixed, relative to the other modeled populations, or what the
temporal order of two events is (whether one population split occurred
before or after another population split).</p>
<p><em>ADMIXTOOLS 2</em> offers a number of functions that can summarize
graphs by listing their features, as well as functions that can be used
to test whether graphs exhibits specific features. This is useful in
several contexts, for example it can constrain the search space for
finding well fitting graphs, by not considering graphs with specific
properties.</p>
<p>At the moment there are three types of features or constraints, and
for each there is a function for listing the graph features, and a
function for testing whether a graph meets certain constraints.</p>
<table class="table">
<colgroup>
<col width="42%">
<col width="34%">
<col width="24%">
</colgroup>
<thead><tr class="header">
<th>Feature / Constraint</th>
<th>Summarize graph</th>
<th>Test graph</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Number of admixing sources</td>
<td><code><a href="../reference/summarize_numadmix.html">summarize_numadmix()</a></code></td>
<td><code><a href="../reference/satisfies_numadmix.html">satisfies_numadmix()</a></code></td>
</tr>
<tr class="even">
<td>Order of events</td>
<td><code><a href="../reference/summarize_eventorder.html">summarize_eventorder()</a></code></td>
<td><code><a href="../reference/satisfies_eventorder.html">satisfies_eventorder()</a></code></td>
</tr>
<tr class="odd">
<td>Zero f4</td>
<td><code><a href="../reference/summarize_zerof4.html">summarize_zerof4()</a></code></td>
<td><code><a href="../reference/satisfies_zerof4.html">satisfies_zerof4()</a></code></td>
</tr>
</tbody>
</table>
<div id="number-of-admixing-sources" class="section level3">
<h3 class="hasAnchor">
<a href="#number-of-admixing-sources" class="anchor"></a>Number of admixing sources</h3>
<p>We can summarize the total number of admixing sources for each
population in a graph:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/summarize_numadmix.html">summarize_numadmix</a></span><span class="op">(</span><span class="va">example_igraph</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 7 x 2
##   pop                   nadmix
##   &lt;chr&gt;                  &lt;dbl&gt;
## 1 Chimp.REF                  0
## 2 Altai_Neanderthal.DG       0
## 3 Vindija.DG                 0
## 4 Mbuti.DG                   1
## 5 Denisova.DG                0
## 6 Russia_Ust_Ishim.DG        2
## 7 Switzerland_Bichon.SG      0</code></pre>
<p>To put constraints on the number of admixtures for some of our
populations, we can create a data frame with columns <code>pop</code>,
<code>min</code>, <code>max</code>. The following example shows how to
specify that population <em>C</em> should have at least one admixture
event, while <em>D</em> should be unadmixed:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">constrain_cd</span> <span class="op">=</span> <span class="fu">tribble</span><span class="op">(</span>
  <span class="op">~</span><span class="va">pop</span>, <span class="op">~</span><span class="va">min</span>, <span class="op">~</span><span class="va">max</span>,
  <span class="st">'C'</span>, <span class="fl">1</span>, <span class="cn">NA</span>,
  <span class="st">'D'</span>, <span class="cn">NA</span>, <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>This can be used to test whether a graph meets these constraints:</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/satisfies_numadmix.html">satisfies_numadmix</a></span><span class="op">(</span><span class="va">g</span>, admix_constraints <span class="op">=</span> <span class="va">constrain_cd</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>If we have a list of admixture graphs, we could select only those
that meet the constraints:</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">graphlist</span> <span class="op">=</span> <span class="fu">rerun</span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">graphlist2</span> <span class="op">=</span> <span class="va">graphlist</span> <span class="op">%&gt;%</span> <span class="fu">keep</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="../reference/satisfies_numadmix.html">satisfies_numadmix</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">constrain_cd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And if we want to filter the output of <code><a href="../reference/find_graphs.html">find_graphs()</a></code>, we
could do it with this expresession:</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_filtered</span> <span class="op">=</span> <span class="va">results</span> <span class="op">%&gt;%</span> <span class="va">rowwise</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/satisfies_numadmix.html">satisfies_numadmix</a></span><span class="op">(</span><span class="va">igraph</span>, <span class="va">constrain_cd</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ungroup</span></code></pre></div>
<p>We can also generate a random graph that satisfies these
constraints:</p>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, admix_constraints <span class="op">=</span> <span class="va">constrain_cd</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-46729bc4267d17458e83" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-46729bc4267d17458e83">{"x":{"data":[{"x":[0.375,-1.625,null,-2.125,-1.625],"y":[2,1,null,2,1],"text":["Rlr -> admix","Rlr -> admix",null,"Rllp -> admix","Rllp -> admix"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.375,-0.625,null,0.375,-0.625],"y":[3,2,null,3,2],"text":["Rll -> admixq","Rll -> admixq",null,"Rlf -> admixq","Rlf -> admixq"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.625,-1.625],"y":[1,0],"text":"admix -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.375,0.375,null,-2.125,-2.625,null,-0.625,-0.625],"y":[2,1,null,2,1,null,2,1],"text":["Rlr -> E","Rlr -> E",null,"Rllp -> D","Rllp -> D",null,"admixq -> C","admixq -> C"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.375,-2.125,null,0.375,0.375],"y":[3,2,null,3,2],"text":["Rll -> Rllp","Rll -> Rllp",null,"Rlf -> Rlr","Rlf -> Rlr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,-1.375,null,-0.5,0.375],"y":[4,3,null,4,3],"text":["Rl -> Rll","Rl -> Rll",null,"Rl -> Rlf","Rl -> Rlf"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[5,4,null,5,4],"text":["R -> Rl","R -> Rl",null,"R -> B","R -> B"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,0.375,-1.375,-2.125,-1.625,0.375,-0.625],"y":[5,4,2,3,2,1,3,2],"text":["R","Rl","Rlr","Rll","Rllp","admix","Rlf","admixq"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,-0.9375,0.375,0.25,-1.75,-2.375,-0.625,-1.625,-1.875,-0.0625,0.375,-1,-0.625,-0.125],"y":[4.5,3.5,1.5,4.5,2.5,1.5,1.5,0.5,1.5,3.5,2.5,2.5,1.5,2.5],"text":["","","","","","","","","","","","","",""],"hovertext":["R -> Rl","Rl -> Rll","Rlr -> E","R -> B","Rll -> Rllp","Rllp -> D","Rlr -> admix","admix -> A","Rllp -> admix","Rl -> Rlf","Rlf -> Rlr","Rll -> admixq","admixq -> C","Rlf -> admixq"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.625],"y":[-0.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.375,-2.625,-0.625],"y":[0.9,0.9,0.9],"text":["E","D","C"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(163,165,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5],"y":[3.9],"text":"B","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(5,1)","legendgroup":"(5,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.125],"y":[5],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.0375,0.9125],"tickmode":"array","ticktext":["-3","-2","-1","0"],"tickvals":[-3,-2,-1,0],"categoryorder":"array","categoryarray":["-3","-2","-1","0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.355,5.255],"tickmode":"array","ticktext":["0","1","2","3","4","5"],"tickvals":[0,1,2,3,4,5],"categoryorder":"array","categoryarray":["0","1","2","3","4","5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"1304066d59b8d":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"1304051d77ab9":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"1304019ba31a9":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"13040f125b71":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130407e315f71":{"y":{}},"130405b713470":{"x":{},"y":{}}},"cur_data":"1304066d59b8d","visdat":{"1304066d59b8d":["function (y) ","x"],"1304051d77ab9":["function (y) ","x"],"1304019ba31a9":["function (y) ","x"],"13040f125b71":["function (y) ","x"],"130407e315f71":["function (y) ","x"],"130405b713470":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="order-of-events" class="section level3">
<h3 class="hasAnchor">
<a href="#order-of-events" class="anchor"></a>Order of events</h3>
<p>We can test whether one population split occurs before another one,
and whether a leaf population branches off before or after a split
event. The following example shows how we can specify that the split
between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> should occur before the split between
<span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span>, and further that the split between
<span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> should occur before the branching off
of <span class="math inline">\(E\)</span>.</p>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">events</span> <span class="op">=</span> <span class="fu">tribble</span><span class="op">(</span>
  <span class="op">~</span><span class="va">earlier1</span>, <span class="op">~</span><span class="va">earlier2</span>, <span class="op">~</span><span class="va">later1</span>, <span class="op">~</span><span class="va">later2</span>,
  <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>,
  <span class="st">'C'</span>, <span class="st">'D'</span>, <span class="st">'E'</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="fu"><a href="../reference/satisfies_eventorder.html">satisfies_eventorder</a></span><span class="op">(</span><span class="va">g</span>, eventorder <span class="op">=</span> <span class="va">events</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Filtering lists of graphs and generating random graphs meeting these
constraints work analogously to the examples above for the number of
admixing sources.</p>
</div>
<div id="non-zero-f4-statistics" class="section level3">
<h3 class="hasAnchor">
<a href="#non-zero-f4-statistics" class="anchor"></a>Non-zero f4-statistics</h3>
<p>Finally, we can test whether a set of <span class="math inline">\(f_4\)</span>-statistics is zero in a graph.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sigf4</span> <span class="op">=</span> <span class="fu"><a href="../reference/qpdstat.html">f4</a></span><span class="op">(</span><span class="va">f2_blocks</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">pop1</span><span class="op">:</span><span class="va">pop4</span><span class="op">)</span>
<span class="fu"><a href="../reference/satisfies_zerof4.html">satisfies_zerof4</a></span><span class="op">(</span><span class="va">g</span>, nonzero_f4 <span class="op">=</span> <span class="va">sigf4</span><span class="op">)</span></code></pre></div>
<!-- For any set of populations there may be many graphs which can explain the data about equally well, with no significant difference in likelihood scores. Rather than declaring one of these models as the correct model, it may be more useful to find features that are shared between all models with good fits. The following function attempts to find such features by summarizing a set of graphs. It counts how often each population triple occurs in which configuration across all graphs. -->
<!-- ```{r, eval = FALSE} -->
<!-- triples = summarize_triples(winners) -->
<!-- ``` -->
<!-- ```{r, echo = FALSE} -->
<!-- triples = example_triples -->
<!-- ``` -->
<!-- ```{r} -->
<!-- triples %>% arrange(-clade) %>% slice(1) -->
<!-- ``` -->
<!-- The output for this population triple (1: `Rus`, 2: `Swi`, 3: `Den`) can be read like this: -->
<!-- * `numgraphs`: 200 graphs were compared -->
<!-- * `clade`: In 34.5% of all graphs `Rus` and `Swi` form a clade with respect to `Den` -->
<!-- * `x13`: In 0.5% of all graphs `Rus` is closer to `Den` than `Swi` is to `Den`, with ancestors of `Rus` admixing into `Den` -->
<!-- * `x31`: In 50.5% of all graphs `Rus` is closer to `Den` than `Swi` is to `Den`, with ancestors of `Den` admixing into `Rus` -->
<!-- * `x23`: In 24.5% of all graphs `Swi` is closer to `Den` than `Rus` is to `Den`, with ancestors of `Swi` admixing into `Den` -->
<!-- * `x32`: In 38.0% of all graphs `Swi` is closer to `Den` than `Rus` is to `Den`, with ancestors of `Den` admixing into `Swi` -->
<!-- * `toptopo`: The most common topology for this triple across all graphs. `011111` specifies a topology where condition `x13` is not satisfied, but conditions `x23`, `x31`, `x32`, `x12`, and `x21` are satisfied. A topology starting with `0000` is one where the first two populations form a clade. -->
<!-- * `toptopocnt`: The number of times `toptopo` was observed -->
<!-- * `topos`: The number of times each topology was observed -->
<!-- <br> -->
<p><br></p>
</div>
</div>
<div id="simulating-under-an-admixture-graph" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-under-an-admixture-graph" class="anchor"></a>Simulating under an admixture graph</h2>
<p><em>ADMIXTOOLS 2</em> makes it easy to simulate genetic data under a
given admixture graph with the help of <a href="https://msprime.readthedocs.io/en/stable/">msprime</a>.</p>
<div id="msprime" class="section level3">
<h3 class="hasAnchor">
<a href="#msprime" class="anchor"></a>msprime</h3>
<p>In order for this to work, you need a python installation with the
<em>msprime</em> module.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/uqrmaie1/admixtools">admixtools</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">2</span>, outpop <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-d502484bd1b723d1065a" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d502484bd1b723d1065a">{"x":{"data":[{"x":[0.875,-0.125],"y":[0,-1],"text":"admixo -> admixn","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.125,0.875,null,-0.125,-0.125],"y":[2,1,null,2,-1],"text":["Rrlld -> admix","Rrlld -> admix",null,"Rrlld -> admixn","Rrlld -> admixn"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.875],"y":[4,1],"text":"Rrl -> admix","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,4)","legendgroup":"(admix,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.125,-0.125],"y":[-1,-2],"text":"admixn -> E","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.875,0.875],"y":[0,-1],"text":"admixo -> D","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.875,0.875],"y":[1,0],"text":"admix -> admixo","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.625,-2.125,null,-1.625,-1.125],"y":[2,1,null,2,1],"text":["Rrllr -> F","Rrllr -> F",null,"Rrllr -> C","Rrllr -> C"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.875,-1.625,null,-0.875,-0.125],"y":[3,2,null,3,2],"text":["Rrll -> Rrllr","Rrll -> Rrllr",null,"Rrll -> Rrlld","Rrll -> Rrlld"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.875],"y":[4,3],"text":"Rrl -> Rrll","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[5,4,null,5,4],"text":["Rr -> Rrl","Rr -> Rrl",null,"Rr -> B","Rr -> B"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[6,5,null,6,5],"text":["R -> A","R -> A",null,"R -> Rr","R -> Rr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,0,-0.875,-1.625,-0.125,0.875,0.875,-0.125],"y":[6,5,4,3,2,2,1,0,-1],"text":["R","Rr","Rrl","Rrll","Rrllr","Rrlld","admix","admixo","admixn"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.25,-0.4375,-1.25,-1.875,-1.375,0.75,-0.5,0.4375,0.375,0.875,0.875,-0.125,-0.125,0.375],"y":[5.5,5.5,4.5,3.5,2.5,1.5,1.5,4.5,2.5,2.5,1.5,0.5,-0.5,0.5,-1.5,-0.5],"text":["","","","","","","","","","","","","","","",""],"hovertext":["R -> A","R -> Rr","Rr -> Rrl","Rrl -> Rrll","Rrll -> Rrllr","Rrllr -> F","Rrllr -> C","Rr -> B","Rrll -> Rrlld","Rrl -> admix","Rrlld -> admix","admix -> admixo","admixo -> D","Rrlld -> admixn","admixn -> E","admixo -> admixn"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.125],"y":[-2.1],"text":"E","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.875],"y":[-1.1],"text":"D","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(205,150,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.125,-1.125],"y":[0.9,0.9],"text":["F","C"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,190,103,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[3.9],"text":"B","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(5,1)","legendgroup":"(5,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[4.9],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,97,204,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"visible":false,"showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.625],"y":[6],"text":"","hovertext":"","textfont":{"size":14.6645669291339,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.5375,1.4125],"tickmode":"array","ticktext":["-2","-1","0","1"],"tickvals":[-2,-1,0,1],"categoryorder":"array","categoryarray":["-2","-1","0","1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.505,6.405],"tickmode":"array","ticktext":["-2","0","2","4","6"],"tickvals":[-2,0,2,4,6],"categoryorder":"array","categoryarray":["-2","0","2","4","6"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"130405a9fc8fe":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"linetype":{},"colour":{},"text":{},"type":"scatter"},"130403044ca2d":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"text":{}},"130407435691c":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"text":{}},"130405e87e8de":{"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"label":{},"colour":{}},"130402cc9774e":{"y":{}},"130405eb7b8da":{"x":{},"y":{}}},"cur_data":"130405a9fc8fe","visdat":{"130405a9fc8fe":["function (y) ","x"],"130403044ca2d":["function (y) ","x"],"130407435691c":["function (y) ","x"],"130405e87e8de":["function (y) ","x"],"130402cc9774e":["function (y) ","x"],"130405eb7b8da":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outprefix</span> <span class="op">=</span> <span class="st">'/my/outdir/prefix'</span>
<span class="fu"><a href="../reference/msprime_sim.html">msprime_sim</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">outprefix</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span>, ind_per_pop <span class="op">=</span> <span class="fl">100</span>, numcores <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<!-- ```{r} -->
<!-- f2_blocks = f2_from_geno(outprefix, verbose = FALSE) -->
<!-- ``` -->
<p>The last two steps can also be combined into one step with the
<code>f2_from_simulation()</code> function.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f2_blocks</span> <span class="op">=</span> <span class="fu">f2_from_simulation</span><span class="op">(</span><span class="va">g</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span>, ind_per_pop <span class="op">=</span> <span class="fl">100</span>, numcores <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<!-- As expected, the graph under which the data were simulated has a very good fit: -->
<!-- ```{r} -->
<!-- qpgraph(f2_blocks, g)$score -->
<!-- ``` -->
<p>An admixture graph only captures some of the parameters which
determine the full demographic history (particularly when is hasnâ€™t been
fitted and there is just a topology). Therefore, some assumptions are
being made when simulations are generated by
<code><a href="../reference/msprime_sim.html">msprime_sim()</a></code>:</p>
<ul>
<li>Effective population size and mutation rates are constant</li>
<li>Time points of branch splits and admixture events are proportional
to the position on the y-axis of the graph representation created by
<code><a href="../reference/plotly_graph.html">plotly_graph()</a></code>
</li>
<li>All admixture proportions are in 30/70 proportions</li>
<li>All SNPs are independent. This is achieved by simulating a single
SNP at a time, and is justified by the fact that the
block-jackknife/bootstrap method which is used throughout <em>ADMIXTOOLS
2</em> adequately controls for the effects of linked SNPs.</li>
</ul>
<p>Some of these assumptions are not realistic and are only here for
convenience and to reduce the simulation run time. Feel free to e-mail
me suggestions for more sensible defaults.</p>
<p>If you want to override any of the default assumptions, you can do so
in three ways:</p>
<ol style="list-style-type: decimal">
<li>
<p>By supplying a fitted graph to the <code><a href="../reference/msprime_sim.html">msprime_sim()</a></code>
function</p>
<p>In this case, admixture weights of the fitted graph will be directly
translated into simulated admixture proportions. Fitted drift lengths
represent an unknown combination of time and effective population size.
<code><a href="../reference/msprime_sim.html">msprime_sim()</a></code> will simulated fitted drift lengths by
adjusting effective population sizes of the relevant
populations.</p>
</li>
<li>
<p>By adjusting the <code>neff</code>, <code>time</code>, or
<code>ind_per_pop</code> parameters of the <code><a href="../reference/msprime_sim.html">msprime_sim()</a></code>
function</p>
<p>As in this example:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/msprime_sim.html">msprime_sim</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">outprefix</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span>,
            <span class="co"># neff should be specified for all nodes</span>
            neff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>R <span class="op">=</span> <span class="fl">1e4</span>, Rr <span class="op">=</span> <span class="fl">1000</span>, A <span class="op">=</span> <span class="fl">10</span>, B <span class="op">=</span> <span class="fl">100</span>, C <span class="op">=</span> <span class="fl">1000</span>, <span class="va">...</span><span class="op">)</span>,
            <span class="co"># time in generations (not years) should be specified for all nodes</span>
            time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>R <span class="op">=</span> <span class="fl">10000</span>, Rr <span class="op">=</span> <span class="fl">9000</span>, A <span class="op">=</span> <span class="fl">2000</span>, B <span class="op">=</span> <span class="fl">0</span>, C <span class="op">=</span> <span class="fl">100</span>, <span class="va">...</span><span class="op">)</span>,
            <span class="co"># ind_per_pop should be specified for all leaf nodes</span>
            ind_per_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span>, B <span class="op">=</span> <span class="fl">100</span>, D <span class="op">=</span> <span class="fl">10</span>, <span class="va">...</span><span class="op">)</span>
            <span class="op">)</span></code></pre></div>
</li>
<li>
<p>By manually modifying the msprime simulation python script.</p>
<p><code><a href="../reference/msprime_sim.html">msprime_sim()</a></code> will create a file
<code>[outprefix].py</code> which may need to be modified before running
the simulation.</p>
</li>
</ol>
</div>
<div id="fastsimcoal2" class="section level3">
<h3 class="hasAnchor">
<a href="#fastsimcoal2" class="anchor"></a>fastsimcoal2</h3>
<p><br></p>
</div>
</div>
<div id="admixture-graphs-and-pedigrees" class="section level2">
<h2 class="hasAnchor">
<a href="#admixture-graphs-and-pedigrees" class="anchor"></a>Admixture graphs and pedigrees</h2>
<p><br></p>
<!-- ## Finding valid qpAdm models -->
<!-- Every admixture graph maps to a specific set of valid qpAdm models. The function `qpadm_models` lists all valid qpAdm models for a graph. Models which are contained within larger valid models are not shown. The number of valid qpAdm models can be very large for big graphs, so you should only run this on small graphs. -->
<!-- ```{r, fig.width = 9, fig.align="center"} -->
<!-- mygraph = example_opt %>% pluck('graph', 6) -->
<!-- plot_graph(mygraph) -->
<!-- qpadm_models(mygraph, add_outgroup = TRUE, nested = FALSE, abbr = 3) -->
<!-- ``` -->
<!-- The only qpAdm models which are valid under this graph have `Den` as target and `Chi`, `Rus`, and `Swi` as right populations. -->
<!-- Valid qpAdm models need to satisfy the following criteria: -->
<!-- * There have to be more right populations than left populations -->
<!-- * The left populations should not form a clade with respect to any right population. This means that a qpgraph outgroup is not an informative right population, but it can be included anyway, with `add_outgroup`. -->
<!-- * Each set of left populations which forms a source for the target population has to form a clade with target at the exclusion of each right population. (Note: Check if that's correct and if it can be stated in a better way.) -->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert Maier, Nick Patterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'c30b6be96312414d83a0ba52b94b558b',
    indexName: 'admixtools',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
