<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admixture graphs â€¢ admixtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><script src="../extra.js"></script><meta property="og:title" content="Admixture graphs">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-155330476-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155330476-1');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">admixtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/admixtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fstats.html">f-statistics</a>
    </li>
    <li>
      <a href="../articles/graphs.html">Admixture graphs</a>
    </li>
    <li>
      <a href="../articles/io.html">Genotype data</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallelization</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/resampling.html">Standard errors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="graphs_files/htmlwidgets-1.3/htmlwidgets.js"></script><script src="graphs_files/plotly-binding-4.9.1/plotly.js"></script><script src="graphs_files/typedarray-0.1/typedarray.min.js"></script><script src="graphs_files/jquery-1.11.3/jquery.min.js"></script><link href="graphs_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet">
<script src="graphs_files/crosstalk-1.0.0/js/crosstalk.min.js"></script><link href="graphs_files/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet">
<script src="graphs_files/plotly-main-1.49.4/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Admixture graphs</h1>
                        <h4 class="author">Robert Maier</h4>
            
            <h4 class="date">2020-08-14</h4>
      
      
      <div class="hidden name"><code>graphs.Rmd</code></div>

    </div>

    
    
<p><strong>Under construction</strong></p>
<p>ADMIXTOOLS 2 makes it easy to work with admixture graphs. It allows you to read and write them in a number of different formats, create them from scratch, and modify them in several ways. You can either modify them manually, one edge or one node at a time, or automatically, by generating all possible variations of a certain type (for example all graphs that result from adding one admixture edge to the current graph).</p>
<p>The purpose of all this is to find well fitting models, and to find out which models are not compatible with the data. This is further simplified by <code><a href="../reference/find_graphs.html">find_graphs()</a></code>, a function which automatically finds well fitting graphs by repeatedly selecting the best among a set of randomly modified graphs. ADMIXTOOLS 2 also introduces a method for testing whether one admixture graph fits the data significantly better than another.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(magrittr)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(tidyverse)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(admixtools)</a></code></pre></div>
<div id="graph-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#graph-formats" class="anchor"></a>Graph formats</h2>
<p>ADMIXTOOLS 2 can read and write graphs in a number of different formats, including the format used by the original ADMIXTOOLS software and DOT format, but internally it uses only the following two representations of admixture graphs:</p>
<ol style="list-style-type: decimal">
<li>An edge list</li>
</ol>
<ul>
<li>This is either a matrix or a data frame where each edge is in a different row. The first column (<code>from</code>) contains the names of the source nodes, and the second column (<code>to</code>) contains the names of the target nodes. No distinction is made between admixture edges and drift edges, or between different types of nodes. Optionally, there are two more columns (<code>lower</code> and <code>upper</code>), which put constraints on the length of an edge. For admixture edges, these constraints should be between 0 and 1, and for drift edges they can range from 0 to infinity. No constraints are indicated by <code>NA</code>.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>An <code>igraph</code> graph object</li>
</ol>
<ul>
<li>This format is used for most operations that modify graphs, since the <a href="https://igraph.org/r/">igraph package</a> provides many useful functions for working with graphs. If not otherwise specified, functions that take graphs as input expect a graph in this format.</li>
</ul>
<p>To convert an admixture graph from one of these representations to the other, you can use the <code>igraph</code> function <code><a href="https://rdrr.io/pkg/igraph/man/graph_from_edgelist.html">igraph::graph_from_edgelist()</a></code> and <code><a href="https://rdrr.io/pkg/igraph/man/as_edgelist.html">igraph::as_edgelist()</a></code>.</p>
<div id="simplified-graphs" class="section level3">
<h3 class="hasAnchor">
<a href="#simplified-graphs" class="anchor"></a>Simplified graphs</h3>
<p>If you look at an admixture graph, you will probably notice that admixture edges originate at nodes which have no other outgoing edges. Many functions in ADMIXTOOLS 2 use simplified admixture graphs without those redundant nodes. While these nodes are redundant for the topology of a graph, they are still useful because they allow us to specify both admixture weights and drift weights for two merging branches.</p>
<p><code><a href="../reference/simplify_graph.html">simplify_graph()</a></code> and <code><a href="../reference/desimplify_graph.html">desimplify_graph()</a></code> can turn one representation into the other.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="../reference/plotly_graph.html">plotly_graph</a></span>(example_graph)</a></code></pre></div>
<div id="htmlwidget-67706ef1f8968408939b" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-67706ef1f8968408939b">{"x":{"data":[{"x":[0,2],"y":[-1,-2],"text":"N3N5 -> N3N8","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,1],"y":[0,-1],"text":"N2N3 -> N2N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,0],"y":[1,0],"text":"N3N2 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[2,0],"text":"N3N3 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1,null,2,2],"y":[3,-1,null,3,-2],"text":["N2N2 -> N2N4","N2N2 -> N2N4",null,"N3N7 -> N3N8","N3N7 -> N3N8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,2],"y":[-2,-3],"text":"N3N8 -> Russia_Ust_Ishim.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[-1,-2],"text":"N2N4 -> Mbuti.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[0,-1],"text":"N3N4 -> N3N5","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2],"y":[1,0,null,1,0],"text":["N2N1 -> Vindija.DG","N2N1 -> Vindija.DG",null,"N2N1 -> N2N3","N2N1 -> N2N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,-2.5,null,-2,-1.5],"y":[2,1,null,2,1],"text":["N3N0 -> N2N1","N3N0 -> N2N1",null,"N3N0 -> N3N2","N3N0 -> N3N2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2,null,-0.5,-1,null,-0.5,0],"y":[3,2,null,3,2,null,3,2,null,3,2],"text":["N0N -> Altai_Neanderthal.DG","N0N -> Altai_Neanderthal.DG",null,"N0N -> N3N0","N0N -> N3N0",null,"N3N1 -> Denisova.DG","N3N1 -> Denisova.DG",null,"N3N1 -> N3N3","N3N1 -> N3N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,-2.5,null,-1.5,-0.5,null,1.5,1,null,1.5,2],"y":[4,3,null,4,3,null,4,3,null,4,3],"text":["N1N -> N0N","N1N -> N0N",null,"N1N -> N3N1","N1N -> N3N1",null,"N3N6 -> N2N2","N3N6 -> N2N2",null,"N3N6 -> N3N7","N3N6 -> N3N7"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1.5,null,0,1.5],"y":[5,4,null,5,4],"text":["N2N0 -> N1N","N2N0 -> N1N",null,"N2N0 -> N3N6","N2N0 -> N3N6"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[6,5,null,6,5],"text":["N4N -> N2N0","N4N -> N2N0",null,"N4N -> Switzerland_Bichon.SG","N4N -> Switzerland_Bichon.SG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[7,6,null,7,6],"text":["R -> Chimp.REF","R -> Chimp.REF",null,"R -> N4N","R -> N4N"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,-2.75,-2.25,-2,-1,-0.75,0.75,-2.75,-2.25,1,-2.25,-1.75,-0.75,-0.25,0,1.25,1.75,2,0.25,0.75,1,-0.75,1,-0.5,0,2],"y":[6.5,6.5,2.5,2.5,3.5,3.5,4.5,4.5,0.5,0.5,-1.5,1.5,1.5,2.5,2.5,-0.5,3.5,3.5,-2.5,5.5,5.5,1,0.5,-1.5,-0.5,1,0.5],"text":["","","","","","","","","","","","","","","","","","","","","","","","","","",""],"hovertext":["R -> Chimp.REF","R -> N4N","N0N -> Altai_Neanderthal.DG","N0N -> N3N0","N1N -> N0N","N1N -> N3N1","N2N0 -> N1N","N2N0 -> N3N6","N2N1 -> Vindija.DG","N2N1 -> N2N3","N2N4 -> Mbuti.DG","N3N0 -> N2N1","N3N0 -> N3N2","N3N1 -> Denisova.DG","N3N1 -> N3N3","N3N4 -> N3N5","N3N6 -> N2N2","N3N6 -> N3N7","N3N8 -> Russia_Ust_Ishim.DG","N4N -> N2N0","N4N -> Switzerland_Bichon.SG","N2N2 -> N2N4","N3N2 -> N3N4","N3N5 -> N3N8","N2N3 -> N2N4","N3N3 -> N3N4","N3N7 -> N3N8"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2],"y":[-3],"text":"Russia_Ust_Ishim.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-2],"text":"Mbuti.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(216,144,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3],"y":[0],"text":"Vindija.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(57,182,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,-1],"y":[2,2],"text":["Altai_Neanderthal.DG","Denisova.DG"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[5],"text":"Switzerland_Bichon.SG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[6],"text":"Chimp.REF","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,98,188,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-2.5,-1.5,0,-2.5,1,-2,-0.5,0,1.5,2,0.5,1,-1.5,0,-2,0,2],"y":[7,3,4,5,1,-1,2,3,0,4,-2,6,3,1,-1,0,2,3],"text":["R","N0N","N1N","N2N0","N2N1","N2N4","N3N0","N3N1","N3N4","N3N6","N3N8","N4N","N2N2","N3N2","N3N5","N2N3","N3N3","N3N7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8383223406054,"r":7.30593607305936,"b":15.4912903771351,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.6,2.6],"tickmode":"array","ticktext":["NA","-2","0","2"],"tickvals":[null,-2,4.44089209850063e-16,2],"categoryorder":"array","categoryarray":["NA","-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.5,7.5],"tickmode":"array","ticktext":["-2.5","0.0","2.5","5.0","7.5"],"tickvals":[-2.5,0,2.5,5,7.5],"categoryorder":"array","categoryarray":["-2.5","0.0","2.5","5.0","7.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"3e70508e5ea0":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"3e7032e683b1":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"3e703bcff392":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}},"3e70518014eb":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}}},"cur_data":"3e70508e5ea0","visdat":{"3e70508e5ea0":["function (y) ","x"],"3e7032e683b1":["function (y) ","x"],"3e703bcff392":["function (y) ","x"],"3e70518014eb":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/plotly_graph.html">plotly_graph</a></span>(<span class="kw"><a href="../reference/simplify_graph.html">simplify_graph</a></span>(example_graph))</a></code></pre></div>
<div id="htmlwidget-ddd14085531f9db375ce" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-ddd14085531f9db375ce">{"x":{"data":[{"x":[-2,1,null,-1,2],"y":[1,0,null,1,0],"text":["N2N1 -> N2N4","N2N1 -> N2N4",null,"N3N4 -> N3N8","N3N4 -> N3N8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,-1],"y":[2,1],"text":"N3N0 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,-1],"y":[3,1],"text":"N3N1 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.5,1,null,1.5,2],"y":[4,0,null,4,0],"text":["N3N6 -> N2N4","N3N6 -> N2N4",null,"N3N6 -> N3N8","N3N6 -> N3N8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,4)","legendgroup":"(admix,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1,null,2,2],"y":[0,-1,null,0,-1],"text":["N2N4 -> Mbuti.DG","N2N4 -> Mbuti.DG",null,"N3N8 -> Russia_Ust_Ishim.DG","N3N8 -> Russia_Ust_Ishim.DG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,-2],"y":[1,0],"text":"N2N1 -> Vindija.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,-2],"y":[2,1],"text":"N3N0 -> N2N1","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2,null,-0.5,0],"y":[3,2,null,3,2,null,3,2],"text":["N0N -> Altai_Neanderthal.DG","N0N -> Altai_Neanderthal.DG",null,"N0N -> N3N0","N0N -> N3N0",null,"N3N1 -> Denisova.DG","N3N1 -> Denisova.DG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,-2.5,null,-1.5,-0.5],"y":[4,3,null,4,3],"text":["N1N -> N0N","N1N -> N0N",null,"N1N -> N3N1","N1N -> N3N1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1.5,null,0,1.5],"y":[5,4,null,5,4],"text":["N2N0 -> N1N","N2N0 -> N1N",null,"N2N0 -> N3N6","N2N0 -> N3N6"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[6,5,null,6,5],"text":["N4N -> N2N0","N4N -> N2N0",null,"N4N -> Switzerland_Bichon.SG","N4N -> Switzerland_Bichon.SG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[7,6,null,7,6],"text":["R -> Chimp.REF","R -> Chimp.REF",null,"R -> N4N","R -> N4N"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.25,0.75,-2.75,-2.25,-2,-1.5,-2,-1,-0.25,-0.75,-0.75,0.75,1.25,1.75,-2,-0.5,1,0.5,2],"y":[6.5,6.5,5.5,5.5,2.5,2.5,1.5,1.5,3.5,3.5,2.5,2,4.5,4.5,2,2,0.5,0.5,-0.5,0.5,-0.5],"text":["","","","","","","","","","","","","","","","","","","","",""],"hovertext":["R -> Chimp.REF","R -> N4N","N4N -> N2N0","N4N -> Switzerland_Bichon.SG","N0N -> Altai_Neanderthal.DG","N0N -> N3N0","N3N0 -> N2N1","N3N0 -> N3N4","N1N -> N0N","N1N -> N3N1","N3N1 -> Denisova.DG","N3N1 -> N3N4","N2N0 -> N1N","N2N0 -> N3N6","N3N6 -> N2N4","N3N6 -> N3N8","N2N1 -> Vindija.DG","N2N1 -> N2N4","N2N4 -> Mbuti.DG","N3N4 -> N3N8","N3N8 -> Russia_Ust_Ishim.DG"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,2],"y":[-1,-1],"text":["Mbuti.DG","Russia_Ust_Ishim.DG"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2],"y":[0],"text":"Vindija.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(205,150,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,0],"y":[2,2],"text":["Altai_Neanderthal.DG","Denisova.DG"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,190,103,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[5],"text":"Switzerland_Bichon.SG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[6],"text":"Chimp.REF","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,97,204,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,-2.5,-2,-1.5,-0.5,0,1.5,-2,1,-1,2],"y":[7,6,3,2,4,3,5,4,1,0,1,0],"text":["R","N4N","N0N","N3N0","N1N","N3N1","N2N0","N3N6","N2N1","N2N4","N3N4","N3N8"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8383223406054,"r":7.30593607305936,"b":15.4912903771351,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.6,2.6],"tickmode":"array","ticktext":["NA","-2","0","2"],"tickvals":[null,-2,4.44089209850063e-16,2],"categoryorder":"array","categoryarray":["NA","-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.4,7.4],"tickmode":"array","ticktext":["NA","0.0","2.5","5.0","NA"],"tickvals":[null,0,2.5,5,null],"categoryorder":"array","categoryarray":["NA","0.0","2.5","5.0","NA"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"3e70739378f9":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"3e7056eb5eb6":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"3e7076972b4e":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}},"3e703e9c4ab5":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}}},"cur_data":"3e70739378f9","visdat":{"3e70739378f9":["function (y) ","x"],"3e7056eb5eb6":["function (y) ","x"],"3e7076972b4e":["function (y) ","x"],"3e703e9c4ab5":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="creating-admixture-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-admixture-graphs" class="anchor"></a>Creating admixture graphs</h2>
<p>To get started, you can either read an existing graph (using <code><a href="../reference/parse_qpgraph_graphfile.html">parse_qpgraph_graphfile()</a></code> if itâ€™s in the orginial ADMIXTOOLS format, <code>read_table2()</code> if itâ€™s an edge list, or <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code> if it was saved in R using <code><a href="https://rdrr.io/r/base/readRDS.html">saveRDS()</a></code>), or you can make a new one.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">newgraph =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">from =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'R'</span>, <span class="st">'R'</span>, <span class="st">'p1'</span>, <span class="st">'p1'</span>), <span class="dt">to =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'p1'</span>, <span class="st">'p2'</span>, <span class="st">'p3'</span>, <span class="st">'p4'</span>))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw"><a href="../reference/plotly_graph.html">plotly_graph</a></span>(newgraph)</a></code></pre></div>
<div id="htmlwidget-69559d7e1c96a595747d" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-69559d7e1c96a595747d">{"x":{"data":[{"x":[-0.5,-1,null,-0.5,0],"y":[1,0,null,1,0],"text":["p1 -> p3","p1 -> p3",null,"p1 -> p4","p1 -> p4"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[2,1,null,2,1],"text":["R -> p1","R -> p1",null,"R -> p2","R -> p2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,-0.75,-0.25],"y":[1.5,1.5,0.5,0.5],"text":["","","",""],"hovertext":["R -> p1","R -> p2","p1 -> p3","p1 -> p4"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,0],"y":[0,0],"text":["p3","p4"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5],"y":[1],"text":"p2","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5],"y":[2,1],"text":["R","p1"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8383223406054,"r":7.30593607305936,"b":15.4912903771351,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.25,0.75],"tickmode":"array","ticktext":["-1.2","-0.8","-0.4","0.0","0.4","NA"],"tickvals":[-1.2,-0.8,-0.4,0,0.4,null],"categoryorder":"array","categoryarray":["-1.2","-0.8","-0.4","0.0","0.4","NA"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.1,2.1],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5","2.0"],"tickvals":[0,0.5,1,1.5,2],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5","2.0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"3e707fa6d43f":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"3e7021b8b592":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"3e7065989589":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}},"3e70481897b":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}}},"cur_data":"3e707fa6d43f","visdat":{"3e707fa6d43f":["function (y) ","x"],"3e7021b8b592":["function (y) ","x"],"3e7065989589":["function (y) ","x"],"3e70481897b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>You can also generate random graphs with your choice of population labels and a set number of admixture events:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">pops =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(dplyr<span class="op">::</span>starwars<span class="op">$</span>species)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">newgraph =<span class="st"> </span><span class="kw"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span>(pops, <span class="dt">numadmix =</span> <span class="dv">15</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw"><a href="../reference/plotly_graph.html">plotly_graph</a></span>(newgraph)</a></code></pre></div>
<div id="htmlwidget-056378076706ac501115" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-056378076706ac501115">{"x":{"data":[{"x":[-7.201171875,-7.888671875],"y":[-1,-2],"text":"admix7b -> admix7","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,137,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[13.298828125,1.298828125,null,-1.701171875,-9.701171875],"y":[0,-1,null,0,-1],"text":["admix8b -> admix8","admix8b -> admix8",null,"admix9b -> admix9","admix9b -> admix9"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(196,154,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.201171875,-3.701171875,null,8.798828125,8.798828125,null,13.798828125,8.798828125],"y":[1,0,null,1,-1,null,1,-1],"text":["admix2b -> admix2","admix2b -> admix2",null,"admix3a -> admix3","admix3a -> admix3",null,"admix3b -> admix3","admix3b -> admix3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(153,168,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-10.701171875,5.298828125,null,14.298828125,7.298828125],"y":[2,1,null,2,1],"text":["admix11b -> admix11","admix11b -> admix11",null,"admix15a -> admix15","admix15a -> admix15"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(83,180,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.298828125,15.798828125,null,-9.701171875,-9.701171875,null,19.798828125,17.298828125,null,12.798828125,-8.201171875,null,-0.701171875,4.298828125,null,14.798828125,20.798828125],"y":[3,2,null,3,-1,null,3,2,null,3,2,null,3,2,null,3,2],"text":["admix5b -> admix5","admix5b -> admix5",null,"admix9a -> admix9","admix9a -> admix9",null,"admix10b -> admix10","admix10b -> admix10",null,"admix12b -> admix12","admix12b -> admix12",null,"admix13a -> admix13","admix13a -> admix13",null,"admix14b -> admix14","admix14b -> admix14"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,188,86,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[13.298828125,11.298828125,null,-3.701171875,-3.701171875,null,15.798828125,15.798828125,null,-8.201171875,-8.201171875],"y":[4,3,null,4,0,null,4,2,null,4,2],"text":["admix1a -> admix1","admix1a -> admix1",null,"admix2a -> admix2","admix2a -> admix2",null,"admix5a -> admix5","admix5a -> admix5",null,"admix12a -> admix12","admix12a -> admix12"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,192,148,1)","dash":"dot"},"hoveron":"points","name":"(admix,4)","legendgroup":"(admix,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.298828125,9.298828125,null,4.298828125,4.298828125,null,20.798828125,20.798828125,null,7.298828125,7.298828125],"y":[5,4,null,5,2,null,5,2,null,5,1],"text":["admix4b -> admix4","admix4b -> admix4",null,"admix13b -> admix13","admix13b -> admix13",null,"admix14a -> admix14","admix14a -> admix14",null,"admix15b -> admix15","admix15b -> admix15"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,5)","legendgroup":"(admix,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[11.298828125,11.298828125,null,9.298828125,9.298828125,null,17.298828125,17.298828125,null,5.298828125,5.298828125],"y":[6,3,null,6,4,null,6,2,null,6,1],"text":["admix1b -> admix1","admix1b -> admix1",null,"admix4a -> admix4","admix4a -> admix4",null,"admix10a -> admix10","admix10a -> admix10",null,"admix11a -> admix11","admix11a -> admix11"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,182,235,1)","dash":"dot"},"hoveron":"points","name":"(admix,6)","legendgroup":"(admix,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.298828125,-6.888671875,null,1.298828125,1.298828125],"y":[7,6,null,7,-1],"text":["admix6b -> admix6","admix6b -> admix6",null,"admix8a -> admix8","admix8a -> admix8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(6,164,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,7)","legendgroup":"(admix,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.888671875,-7.888671875],"y":[8,-2],"text":"admix7a -> admix7","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(165,138,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,8)","legendgroup":"(admix,8)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-6.888671875,-6.888671875],"y":[9,6],"text":"admix6a -> admix6","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(223,112,248,1)","dash":"dot"},"hoveron":"points","name":"(admix,9)","legendgroup":"(admix,9)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.888671875,-7.888671875],"y":[-2,-3],"text":"admix7 -> Twi'lek","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8.798828125,8.798828125,null,1.298828125,1.298828125,null,-9.701171875,-9.701171875],"y":[-1,-2,null,-1,-2,null,-1,-2],"text":["admix3 -> Besalisk","admix3 -> Besalisk",null,"admix8 -> Iktotchi","admix8 -> Iktotchi",null,"admix9 -> Tholothian","admix9 -> Tholothian"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,137,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.701171875,-3.701171875,null,-7.701171875,-8.201171875,null,-7.701171875,-7.201171875],"y":[0,-1,null,0,-1,null,0,-1],"text":["admix2 -> Togruta","admix2 -> Togruta",null,"Rrlrlrlrx -> Toydarian","Rrlrlrlrx -> Toydarian",null,"Rrlrlrlrx -> admix7b","Rrlrlrlrx -> admix7b"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(196,154,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-8.201171875,-8.701171875,null,-8.201171875,-7.701171875,null,17.298828125,16.798828125,null,17.298828125,17.798828125,null,12.798828125,12.298828125,null,12.798828125,13.298828125,null,-2.201171875,-2.701171875,null,-2.201171875,-1.701171875,null,5.298828125,5.298828125,null,7.298828125,7.298828125],"y":[1,0,null,1,0,null,1,0,null,1,0,null,1,0,null,1,0,null,1,0,null,1,0,null,1,0,null,1,0],"text":["Rrlrlrlr -> Mon Calamari","Rrlrlrlr -> Mon Calamari",null,"Rrlrlrlr -> Rrlrlrlrx","Rrlrlrlr -> Rrlrlrlrx",null,"Rrrrll -> Kel Dor","Rrrrll -> Kel Dor",null,"Rrrrll -> Hutt","Rrrrll -> Hutt",null,"Rrrrlrrlxx -> Chagrian","Rrrrlrrlxx -> Chagrian",null,"Rrrrlrrlxx -> admix8b","Rrrrlrrlxx -> admix8b",null,"Rrlrllllrx -> Droid","Rrlrllllrx -> Droid",null,"Rrlrllllrx -> admix9b","Rrlrllllrx -> admix9b",null,"admix11 -> Skakoan","admix11 -> Skakoan",null,"admix15 -> Neimodian","admix15 -> Neimodian"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(153,168,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.701171875,-3.201171875,null,-2.701171875,-2.201171875,null,-6.201171875,-6.701171875,null,-6.201171875,-5.701171875,null,8.298828125,7.798828125,null,8.298828125,8.798828125,null,10.298828125,9.798828125,null,10.298828125,10.798828125,null,-0.701171875,-1.201171875,null,-0.701171875,-0.201171875,null,13.298828125,12.798828125,null,13.298828125,13.798828125,null,15.798828125,15.798828125,null,17.298828125,17.298828125,null,-8.201171875,-8.201171875,null,4.298828125,4.298828125,null,20.798828125,20.798828125],"y":[2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1,null,2,1],"text":["Rrlrllllr -> Vulptereen","Rrlrllllr -> Vulptereen",null,"Rrlrllllr -> Rrlrllllrx","Rrlrllllr -> Rrlrllllrx",null,"Rrlrlrrlll -> Wookiee","Rrlrlrrlll -> Wookiee",null,"Rrlrlrrlll -> Geonosian","Rrlrlrrlll -> Geonosian",null,"Rrrlrrl -> Mirialan","Rrrlrrl -> Mirialan",null,"Rrrlrrl -> admix3a","Rrrlrrl -> admix3a",null,"Rrrlrrr -> Cerean","Rrrlrrr -> Cerean",null,"Rrrlrrr -> NA","Rrrlrrr -> NA",null,"Rrlrllllx -> Kaleesh","Rrlrllllx -> Kaleesh",null,"Rrlrllllx -> admix2b","Rrlrllllx -> admix2b",null,"Rrrrlrrlx -> Rrrrlrrlxx","Rrrrlrrlx -> Rrrrlrrlxx",null,"Rrrrlrrlx -> admix3b","Rrrrlrrlx -> admix3b",null,"admix5 -> Gungan","admix5 -> Gungan",null,"admix10 -> Rrrrll","admix10 -> Rrrrll",null,"admix12 -> Rrlrlrlr","admix12 -> Rrlrlrlr",null,"admix13 -> Clawdite","admix13 -> Clawdite",null,"admix14 -> Kaminoan","admix14 -> Kaminoan"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(83,180,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.701171875,-2.701171875,null,-1.701171875,-0.701171875,null,-5.701171875,-6.201171875,null,-5.701171875,-5.201171875,null,9.298828125,8.298828125,null,9.298828125,10.298828125,null,13.798828125,13.298828125,null,13.798828125,14.298828125,null,11.298828125,11.298828125,null,-11.201171875,-11.701171875,null,-11.201171875,-10.701171875],"y":[3,2,null,3,2,null,3,2,null,3,2,null,3,2,null,3,2,null,3,2,null,3,2,null,3,2,null,3,2,null,3,2],"text":["Rrlrllll -> Rrlrllllr","Rrlrllll -> Rrlrllllr",null,"Rrlrllll -> Rrlrllllx","Rrlrllll -> Rrlrllllx",null,"Rrlrlrrll -> Rrlrlrrlll","Rrlrlrrll -> Rrlrlrrlll",null,"Rrlrlrrll -> Dug","Rrlrlrrll -> Dug",null,"Rrrlrr -> Rrrlrrl","Rrrlrr -> Rrrlrrl",null,"Rrrlrr -> Rrrlrrr","Rrrlrr -> Rrrlrrr",null,"Rrrrlrrl -> Rrrrlrrlx","Rrrrlrrl -> Rrrrlrrlx",null,"Rrrrlrrl -> admix15a","Rrrrlrrl -> admix15a",null,"admix1 -> Xexto","admix1 -> Xexto",null,"Rrlrlrllx -> Trandoshan","Rrlrlrllx -> Trandoshan",null,"Rrlrlrllx -> admix11b","Rrlrlrllx -> admix11b"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,188,86,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.201171875,-1.701171875,null,-1.201171875,-0.701171875,null,-10.451171875,-11.201171875,null,-10.451171875,-9.701171875,null,-5.201171875,-5.701171875,null,-5.201171875,-4.701171875,null,9.298828125,9.298828125,null,2.798828125,2.298828125,null,2.798828125,3.298828125,null,19.298828125,18.798828125,null,19.298828125,19.798828125,null,12.298828125,11.798828125,null,12.298828125,12.798828125,null,14.298828125,13.798828125,null,14.298828125,14.798828125],"y":[4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3,null,4,3],"text":["Rrlrlll -> Rrlrllll","Rrlrlll -> Rrlrllll",null,"Rrlrlll -> admix13a","Rrlrlll -> admix13a",null,"Rrlrlrll -> Rrlrlrllx","Rrlrlrll -> Rrlrlrllx",null,"Rrlrlrll -> admix9a","Rrlrlrll -> admix9a",null,"Rrlrlrrl -> Rrlrlrrll","Rrlrlrrl -> Rrlrlrrll",null,"Rrlrlrrl -> Sullustan","Rrlrlrrl -> Sullustan",null,"admix4 -> Rrrlrr","admix4 -> Rrrlrr",null,"Rrllrx -> Toong","Rrllrx -> Toong",null,"Rrllrx -> admix5b","Rrllrx -> admix5b",null,"Rrrrrrlx -> Ewok","Rrrrrrlx -> Ewok",null,"Rrrrrrlx -> admix10b","Rrrrrrlx -> admix10b",null,"Rrrrlrlx -> Human","Rrrrlrlx -> Human",null,"Rrrrlrlx -> admix12b","Rrrrlrlx -> admix12b",null,"Rrrrlrrx -> Rrrrlrrl","Rrrrlrrx -> Rrrrlrrl",null,"Rrrrlrrx -> admix14b","Rrrrlrrx -> admix14b"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,192,148,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.298828125,1.798828125,null,2.298828125,2.798828125,null,-0.701171875,-1.201171875,null,-0.701171875,-0.201171875,null,-9.326171875,-10.451171875,null,-9.326171875,-8.201171875,null,-4.451171875,-5.201171875,null,-4.451171875,-3.701171875,null,12.798828125,12.298828125,null,12.798828125,13.298828125,null,15.048828125,14.298828125,null,15.048828125,15.798828125,null,18.798828125,18.298828125,null,18.798828125,19.298828125],"y":[5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4],"text":["Rrllr -> Aleena","Rrllr -> Aleena",null,"Rrllr -> Rrllrx","Rrllr -> Rrllrx",null,"Rrlrll -> Rrlrlll","Rrlrll -> Rrlrlll",null,"Rrlrll -> Quermian","Rrlrll -> Quermian",null,"Rrlrlrl -> Rrlrlrll","Rrlrlrl -> Rrlrlrll",null,"Rrlrlrl -> admix12a","Rrlrlrl -> admix12a",null,"Rrlrlrr -> Rrlrlrrl","Rrlrlrr -> Rrlrlrrl",null,"Rrlrlrr -> admix2a","Rrlrlrr -> admix2a",null,"Rrrrlrl -> Rrrrlrlx","Rrrrlrl -> Rrrrlrlx",null,"Rrrrlrl -> admix1a","Rrrrlrl -> admix1a",null,"Rrrrlrr -> Rrrrlrrx","Rrrrlrr -> Rrrrlrrx",null,"Rrrrlrr -> admix5a","Rrrrlrr -> admix5a",null,"Rrrrrrl -> Rodian","Rrrrrrl -> Rodian",null,"Rrrrrrl -> Rrrrrrlx","Rrrrrrl -> Rrrrrrlx"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-6.888671875,-9.326171875,null,-6.888671875,-4.451171875,null,13.923828125,12.798828125,null,13.923828125,15.048828125,null,19.798828125,18.798828125,null,19.798828125,20.798828125,null,-0.201171875,-0.701171875,null,-0.201171875,0.298828125,null,-6.888671875,-6.888671875,null,3.298828125,2.298828125,null,3.298828125,4.298828125,null,6.798828125,6.298828125,null,6.798828125,7.298828125],"y":[6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5],"text":["Rrlrlr -> Rrlrlrl","Rrlrlr -> Rrlrlrl",null,"Rrlrlr -> Rrlrlrr","Rrlrlr -> Rrlrlrr",null,"Rrrrlr -> Rrrrlrl","Rrrrlr -> Rrrrlrl",null,"Rrrrlr -> Rrrrlrr","Rrrrlr -> Rrrrlrr",null,"Rrrrrr -> Rrrrrrl","Rrrrrr -> Rrrrrrl",null,"Rrrrrr -> admix14a","Rrrrrr -> admix14a",null,"Rrlrlx -> Rrlrll","Rrlrlx -> Rrlrll",null,"Rrlrlx -> admix4b","Rrlrlx -> admix4b",null,"admix6 -> Zabrak","admix6 -> Zabrak",null,"Rrllx -> Rrllr","Rrllx -> Rrllr",null,"Rrllx -> admix13b","Rrllx -> admix13b",null,"Rrrlrx -> Muun","Rrrlrx -> Muun",null,"Rrrlrx -> admix15b","Rrrlrx -> admix15b"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,182,235,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.298828125,3.298828125,null,4.298828125,5.298828125,null,-3.544921875,-6.888671875,null,-3.544921875,-0.201171875,null,8.048828125,6.798828125,null,8.048828125,9.298828125,null,15.611328125,13.923828125,null,15.611328125,17.298828125,null,19.298828125,18.798828125,null,19.298828125,19.798828125,null,10.798828125,10.298828125,null,10.798828125,11.298828125],"y":[7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6],"text":["Rrll -> Rrllx","Rrll -> Rrllx",null,"Rrll -> admix11a","Rrll -> admix11a",null,"Rrlrl -> Rrlrlr","Rrlrl -> Rrlrlr",null,"Rrlrl -> Rrlrlx","Rrlrl -> Rrlrlx",null,"Rrrlr -> Rrrlrx","Rrrlr -> Rrrlrx",null,"Rrrlr -> admix4a","Rrrlr -> admix4a",null,"Rrrrl -> Rrrrlr","Rrrrl -> Rrrrlr",null,"Rrrrl -> admix10a","Rrrrl -> admix10a",null,"Rrrrr -> Nautolan","Rrrrr -> Nautolan",null,"Rrrrr -> Rrrrrr","Rrrrr -> Rrrrrr",null,"Rrrlx -> Yoda's species","Rrrlx -> Yoda's species",null,"Rrrlx -> admix1b","Rrrlx -> admix1b"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(6,164,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.123046875,-3.544921875,null,-1.123046875,1.298828125,null,9.423828125,8.048828125,null,9.423828125,10.798828125,null,17.455078125,15.611328125,null,17.455078125,19.298828125,null,4.798828125,4.298828125,null,4.798828125,5.298828125],"y":[8,7,null,8,7,null,8,7,null,8,7,null,8,7,null,8,7,null,8,7,null,8,7],"text":["Rrlr -> Rrlrl","Rrlr -> Rrlrl",null,"Rrlr -> admix8a","Rrlr -> admix8a",null,"Rrrl -> Rrrlr","Rrrl -> Rrrlr",null,"Rrrl -> Rrrlx","Rrrl -> Rrrlx",null,"Rrrr -> Rrrrl","Rrrr -> Rrrrl",null,"Rrrr -> Rrrrr","Rrrr -> Rrrrr",null,"Rrlx -> Rrll","Rrlx -> Rrll",null,"Rrlx -> admix6b","Rrlx -> admix6b"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(165,138,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,8)","legendgroup":"(normal,8)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-8.388671875,-8.888671875,null,-8.388671875,-7.888671875,null,1.837890625,-1.123046875,null,1.837890625,4.798828125,null,13.439453125,9.423828125,null,13.439453125,17.455078125],"y":[9,8,null,9,8,null,9,8,null,9,8,null,9,8,null,9,8],"text":["Rlr -> Pau'an","Rlr -> Pau'an",null,"Rlr -> admix7a","Rlr -> admix7a",null,"Rrl -> Rrlr","Rrl -> Rrlr",null,"Rrl -> Rrlx","Rrl -> Rrlx",null,"Rrr -> Rrrl","Rrr -> Rrrl",null,"Rrr -> Rrrr","Rrr -> Rrrr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(223,112,248,1)","dash":"solid"},"hoveron":"points","name":"(normal,9)","legendgroup":"(normal,9)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.638671875,-8.388671875,null,-7.638671875,-6.888671875,null,7.638671875,1.837890625,null,7.638671875,13.439453125],"y":[10,9,null,10,9,null,10,9,null,10,9],"text":["Rl -> Rlr","Rl -> Rlr",null,"Rl -> admix6a","Rl -> admix6a",null,"Rr -> Rrl","Rr -> Rrl",null,"Rr -> Rrr","Rr -> Rrr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(251,97,215,1)","dash":"solid"},"hoveron":"points","name":"(normal,10)","legendgroup":"(normal,10)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-7.638671875,null,0,7.638671875],"y":[11,10,null,11,10],"text":["R -> Rl","R -> Rl",null,"R -> Rr","R -> Rr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,102,168,1)","dash":"solid"},"hoveron":"points","name":"(normal,11)","legendgroup":"(normal,11)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.8193359375,3.8193359375,-8.013671875,-7.263671875,-8.638671875,-8.138671875,4.73828125,10.5390625,0.357421875,3.318359375,3.798828125,4.798828125,2.048828125,2.548828125,-2.333984375,0.087890625,-5.216796875,-1.873046875,-0.951171875,-0.451171875,-1.451171875,-0.951171875,-2.201171875,-1.201171875,-2.951171875,-2.451171875,-8.107421875,-5.669921875,-9.888671875,-8.763671875,-10.826171875,-10.076171875,-8.451171875,-7.951171875,-4.826171875,-4.076171875,-5.451171875,-4.951171875,-5.951171875,-5.451171875,-6.451171875,-5.951171875,11.431640625,15.447265625,8.736328125,10.111328125,7.423828125,8.673828125,8.798828125,9.798828125,8.048828125,8.548828125,10.048828125,10.548828125,16.533203125,18.376953125,14.767578125,16.455078125,17.048828125,17.548828125,13.361328125,14.486328125,12.548828125,13.048828125,14.673828125,15.423828125,13.548828125,14.048828125,19.048828125,19.548828125,19.298828125,20.298828125,18.548828125,19.048828125,10.548828125,11.048828125,11.298828125,-0.951171875,-0.451171875,-3.701171875,13.048828125,13.548828125,8.798828125,-0.451171875,0.048828125,9.298828125,2.548828125,3.048828125,15.798828125,4.548828125,5.048828125,-6.888671875,-7.951171875,-7.451171875,-7.888671875,12.548828125,13.048828125,1.298828125,-2.451171875,-1.951171875,-9.701171875,19.048828125,19.548828125,17.298828125,-11.451171875,-10.951171875,5.298828125,12.048828125,12.548828125,-8.201171875,2.798828125,3.798828125,4.298828125,14.048828125,14.548828125,20.798828125,6.548828125,7.048828125,7.298828125,12.298828125,11.298828125,-3.701171875,-1.951171875,8.798828125,11.298828125,9.298828125,4.798828125,15.798828125,9.548828125,-6.888671875,-0.794921875,-7.888671875,-7.544921875,1.298828125,7.298828125,-9.701171875,-5.701171875,17.298828125,18.548828125,5.298828125,-2.701171875,-8.201171875,2.298828125,1.798828125,4.298828125,20.798828125,17.798828125,10.798828125,7.298828125],"y":[10.5,10.5,9.5,9.5,8.5,8.5,9.5,9.5,8.5,8.5,6.5,6.5,4.5,4.5,7.5,7.5,6.5,6.5,4.5,4.5,3.5,3.5,2.5,2.5,1.5,1.5,5.5,5.5,4.5,4.5,3.5,3.5,0.5,0.5,4.5,4.5,3.5,3.5,2.5,2.5,1.5,1.5,8.5,8.5,7.5,7.5,6.5,6.5,2.5,2.5,1.5,1.5,1.5,1.5,7.5,7.5,6.5,6.5,0.5,0.5,5.5,5.5,4.5,4.5,4.5,4.5,2.5,2.5,6.5,6.5,5.5,5.5,4.5,4.5,6.5,6.5,2.5,1.5,1.5,-0.5,1.5,1.5,-1.5,5.5,5.5,3.5,3.5,3.5,1.5,7.5,7.5,5.5,-0.5,-0.5,-2.5,0.5,0.5,-1.5,0.5,0.5,-1.5,3.5,3.5,1.5,2.5,2.5,0.5,3.5,3.5,1.5,5.5,5.5,1.5,3.5,3.5,1.5,5.5,5.5,0.5,3.5,4.5,2,0.5,0,0,5,4.5,3,2.5,7.5,6.5,3,-1.5,3,-0.5,1,-0.5,4,2.5,3.5,1.5,3,2.5,2.5,3.5,3.5,2.5,1.5,3],"text":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"hovertext":["R -> Rl","R -> Rr","Rl -> Rlr","Rl -> admix6a","Rlr -> Pau'an","Rlr -> admix7a","Rr -> Rrl","Rr -> Rrr","Rrl -> Rrlr","Rrl -> Rrlx","Rrll -> Rrllx","Rrll -> admix11a","Rrllr -> Aleena","Rrllr -> Rrllrx","Rrlr -> Rrlrl","Rrlr -> admix8a","Rrlrl -> Rrlrlr","Rrlrl -> Rrlrlx","Rrlrll -> Rrlrlll","Rrlrll -> Quermian","Rrlrlll -> Rrlrllll","Rrlrlll -> admix13a","Rrlrllll -> Rrlrllllr","Rrlrllll -> Rrlrllllx","Rrlrllllr -> Vulptereen","Rrlrllllr -> Rrlrllllrx","Rrlrlr -> Rrlrlrl","Rrlrlr -> Rrlrlrr","Rrlrlrl -> Rrlrlrll","Rrlrlrl -> admix12a","Rrlrlrll -> Rrlrlrllx","Rrlrlrll -> admix9a","Rrlrlrlr -> Mon Calamari","Rrlrlrlr -> Rrlrlrlrx","Rrlrlrr -> Rrlrlrrl","Rrlrlrr -> admix2a","Rrlrlrrl -> Rrlrlrrll","Rrlrlrrl -> Sullustan","Rrlrlrrll -> Rrlrlrrlll","Rrlrlrrll -> Dug","Rrlrlrrlll -> Wookiee","Rrlrlrrlll -> Geonosian","Rrr -> Rrrl","Rrr -> Rrrr","Rrrl -> Rrrlr","Rrrl -> Rrrlx","Rrrlr -> Rrrlrx","Rrrlr -> admix4a","Rrrlrr -> Rrrlrrl","Rrrlrr -> Rrrlrrr","Rrrlrrl -> Mirialan","Rrrlrrl -> admix3a","Rrrlrrr -> Cerean","Rrrlrrr -> NA","Rrrr -> Rrrrl","Rrrr -> Rrrrr","Rrrrl -> Rrrrlr","Rrrrl -> admix10a","Rrrrll -> Kel Dor","Rrrrll -> Hutt","Rrrrlr -> Rrrrlrl","Rrrrlr -> Rrrrlrr","Rrrrlrl -> Rrrrlrlx","Rrrrlrl -> admix1a","Rrrrlrr -> Rrrrlrrx","Rrrrlrr -> admix5a","Rrrrlrrl -> Rrrrlrrlx","Rrrrlrrl -> admix15a","Rrrrr -> Nautolan","Rrrrr -> Rrrrrr","Rrrrrr -> Rrrrrrl","Rrrrrr -> admix14a","Rrrrrrl -> Rodian","Rrrrrrl -> Rrrrrrlx","Rrrlx -> Yoda's species","Rrrlx -> admix1b","admix1 -> Xexto","Rrlrllllx -> Kaleesh","Rrlrllllx -> admix2b","admix2 -> Togruta","Rrrrlrrlx -> Rrrrlrrlxx","Rrrrlrrlx -> admix3b","admix3 -> Besalisk","Rrlrlx -> Rrlrll","Rrlrlx -> admix4b","admix4 -> Rrrlrr","Rrllrx -> Toong","Rrllrx -> admix5b","admix5 -> Gungan","Rrlx -> Rrll","Rrlx -> admix6b","admix6 -> Zabrak","Rrlrlrlrx -> Toydarian","Rrlrlrlrx -> admix7b","admix7 -> Twi'lek","Rrrrlrrlxx -> Chagrian","Rrrrlrrlxx -> admix8b","admix8 -> Iktotchi","Rrlrllllrx -> Droid","Rrlrllllrx -> admix9b","admix9 -> Tholothian","Rrrrrrlx -> Ewok","Rrrrrrlx -> admix10b","admix10 -> Rrrrll","Rrlrlrllx -> Trandoshan","Rrlrlrllx -> admix11b","admix11 -> Skakoan","Rrrrlrlx -> Human","Rrrrlrlx -> admix12b","admix12 -> Rrlrlrlr","Rrllx -> Rrllr","Rrllx -> admix13b","admix13 -> Clawdite","Rrrrlrrx -> Rrrrlrrl","Rrrrlrrx -> admix14b","admix14 -> Kaminoan","Rrrlrx -> Muun","Rrrlrx -> admix15b","admix15 -> Neimodian","admix1a -> admix1","admix1b -> admix1","admix2a -> admix2","admix2b -> admix2","admix3a -> admix3","admix3b -> admix3","admix4a -> admix4","admix4b -> admix4","admix5a -> admix5","admix5b -> admix5","admix6a -> admix6","admix6b -> admix6","admix7a -> admix7","admix7b -> admix7","admix8a -> admix8","admix8b -> admix8","admix9a -> admix9","admix9b -> admix9","admix10a -> admix10","admix10b -> admix10","admix11a -> admix11","admix11b -> admix11","admix12a -> admix12","admix12b -> admix12","admix13a -> admix13","admix13b -> admix13","admix14a -> admix14","admix14b -> admix14","admix15a -> admix15","admix15b -> admix15"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.888671875],"y":[-3],"text":"Twi'lek","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[8.798828125,1.298828125,-9.701171875],"y":[-2,-2,-2],"text":["Besalisk","Iktotchi","Tholothian"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(227,137,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.701171875,-8.201171875],"y":[-1,-1],"text":["Togruta","Toydarian"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(196,154,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-8.701171875,16.798828125,17.798828125,12.298828125,-2.701171875,5.298828125,7.298828125],"y":[0,0,0,0,0,0,0],"text":["Mon Calamari","Kel Dor","Hutt","Chagrian","Droid","Skakoan","Neimodian"],"hovertext":["","","","","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(153,168,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.201171875,-6.701171875,-5.701171875,7.798828125,9.798828125,10.798828125,-1.201171875,15.798828125,4.298828125,20.798828125],"y":[1,1,1,1,1,1,1,1,1,1],"text":["Vulptereen","Wookiee","Geonosian","Mirialan","Cerean","NA","Kaleesh","Gungan","Clawdite","Kaminoan"],"hovertext":["","","","","","","","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(83,180,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.201171875,11.298828125,-11.701171875],"y":[2,2,2],"text":["Dug","Xexto","Trandoshan"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,188,86,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4.701171875,2.298828125,18.798828125,11.798828125],"y":[3,3,3,3],"text":["Sullustan","Toong","Ewok","Human"],"hovertext":["","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,192,148,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.798828125,-0.201171875,18.298828125],"y":[4,4,4],"text":["Aleena","Quermian","Rodian"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(5,1)","legendgroup":"(5,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-6.888671875,6.298828125],"y":[5,5],"text":["Zabrak","Muun"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,182,235,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[18.798828125,10.298828125],"y":[6,6],"text":["Nautolan","Yoda's species"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(6,164,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-8.888671875],"y":[8],"text":"Pau'an","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(223,112,248,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(9,1)","legendgroup":"(9,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-7.638671875,-8.388671875,7.638671875,1.837890625,4.298828125,2.298828125,-1.123046875,-3.544921875,-0.701171875,-1.201171875,-1.701171875,-2.701171875,-6.888671875,-9.326171875,-10.451171875,-8.201171875,-4.451171875,-5.201171875,-5.701171875,-6.201171875,13.439453125,9.423828125,8.048828125,9.298828125,8.298828125,10.298828125,17.455078125,15.611328125,17.298828125,13.923828125,12.798828125,15.048828125,13.798828125,19.298828125,19.798828125,18.798828125,10.798828125,11.298828125,-0.701171875,-3.701171875,13.298828125,8.798828125,-0.201171875,9.298828125,2.798828125,15.798828125,4.798828125,-6.888671875,-7.701171875,-7.888671875,12.798828125,1.298828125,-2.201171875,-9.701171875,19.298828125,17.298828125,-11.201171875,5.298828125,12.298828125,-8.201171875,3.298828125,4.298828125,14.298828125,20.798828125,6.798828125,7.298828125,13.298828125,11.298828125,-3.701171875,-0.201171875,8.798828125,13.798828125,9.298828125,0.298828125,15.798828125,3.298828125,-6.888671875,5.298828125,-7.888671875,-7.201171875,1.298828125,13.298828125,-9.701171875,-1.701171875,17.298828125,19.798828125,5.298828125,-10.701171875,-8.201171875,12.798828125,-0.701171875,4.298828125,20.798828125,14.798828125,14.298828125,7.298828125],"y":[11,10,9,10,9,7,5,8,7,5,4,3,2,6,5,4,1,5,4,3,2,9,8,7,3,2,2,8,7,1,6,5,5,3,7,6,5,7,3,2,0,2,-1,6,4,4,2,8,6,0,-2,1,-1,1,-1,4,2,3,1,4,2,6,2,4,2,6,1,4,6,4,1,1,1,6,5,4,3,9,7,8,-1,7,0,3,0,6,3,6,2,4,3,3,5,5,3,2,5],"text":["R","Rl","Rlr","Rr","Rrl","Rrll","Rrllr","Rrlr","Rrlrl","Rrlrll","Rrlrlll","Rrlrllll","Rrlrllllr","Rrlrlr","Rrlrlrl","Rrlrlrll","Rrlrlrlr","Rrlrlrr","Rrlrlrrl","Rrlrlrrll","Rrlrlrrlll","Rrr","Rrrl","Rrrlr","Rrrlrr","Rrrlrrl","Rrrlrrr","Rrrr","Rrrrl","Rrrrll","Rrrrlr","Rrrrlrl","Rrrrlrr","Rrrrlrrl","Rrrrr","Rrrrrr","Rrrrrrl","Rrrlx","admix1","Rrlrllllx","admix2","Rrrrlrrlx","admix3","Rrlrlx","admix4","Rrllrx","admix5","Rrlx","admix6","Rrlrlrlrx","admix7","Rrrrlrrlxx","admix8","Rrlrllllrx","admix9","Rrrrrrlx","admix10","Rrlrlrllx","admix11","Rrrrlrlx","admix12","Rrllx","admix13","Rrrrlrrx","admix14","Rrrlrx","admix15","admix1a","admix1b","admix2a","admix2b","admix3a","admix3b","admix4a","admix4b","admix5a","admix5b","admix6a","admix6b","admix7a","admix7b","admix8a","admix8b","admix9a","admix9b","admix10a","admix10b","admix11a","admix11b","admix12a","admix12b","admix13a","admix13b","admix14a","admix14b","admix15a","admix15b"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8383223406054,"r":7.30593607305936,"b":15.4912903771351,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-15.051171875,24.148828125],"tickmode":"array","ticktext":["-10","0","10","20"],"tickvals":[-10,0,10,20],"categoryorder":"array","categoryarray":["-10","0","10","20"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.7,11.7],"tickmode":"array","ticktext":["NA","0","4","8","NA"],"tickvals":[null,0,4,8,null],"categoryorder":"array","categoryarray":["NA","0","4","8","NA"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"3e70251e79ee":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"3e7073d70b4b":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"3e702b26a457":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}},"3e7075ef61e2":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}}},"cur_data":"3e70251e79ee","visdat":{"3e70251e79ee":["function (y) ","x"],"3e7073d70b4b":["function (y) ","x"],"3e702b26a457":["function (y) ","x"],"3e7075ef61e2":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="modifying-admixture-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#modifying-admixture-graphs" class="anchor"></a>Modifying admixture graphs</h2>
<p>Admixture graphs can be modified using the following functions:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/insert_edge.html">insert_edge</a></span>(example_igraph, <span class="dt">from =</span> <span class="st">"N2N1|Vindija.DG"</span>, <span class="dt">to =</span> <span class="st">"N3N1|Denisova.DG"</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="../reference/delete_admix.html">delete_admix</a></span>(example_igraph, <span class="dt">from =</span> <span class="st">"N2N2"</span>, <span class="dt">to =</span> <span class="st">"N2N4"</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw"><a href="../reference/insert_leaf.html">insert_leaf</a></span>(example_igraph, <span class="st">"newpop"</span>, <span class="dt">from =</span> <span class="st">"N4N"</span>, <span class="dt">to =</span> <span class="st">"Switzerland_Bichon.SG"</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw"><a href="../reference/delete_leaf.html">delete_leaf</a></span>(example_igraph, <span class="st">"Switzerland_Bichon.SG"</span>)</a></code></pre></div>
<p>But itâ€™s probably easier to modify a graph interactively using the ADMIXTOOLS 2 GUI.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/run_shiny_admixtools.html">run_shiny_admixtools</a></span>()</a></code></pre></div>
<p>Below you can see how a new admixture edge is added to a graph:</p>
<p><img src="../man/figures/shinyapp1.gif"></p>
<div id="semi-automated-graph-exploration" class="section level3">
<h3 class="hasAnchor">
<a href="#semi-automated-graph-exploration" class="anchor"></a>Semi-automated graph exploration</h3>
<p>Rather than modifying admixture graphs manually and only testing a small number of models, you can start with a graph and let ADMIXTOOLS 2 generate and evaluate graphs for you.</p>
<p>The following functions take a graph and return lists of new, similar graphs:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">newgraphs =<span class="st"> </span><span class="kw"><a href="../reference/graph_plusone.html">graph_plusone</a></span>(example_graph)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">newgraphs =<span class="st"> </span><span class="kw"><a href="../reference/graph_minusone.html">graph_minusone</a></span>(example_graph)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">newgraphs =<span class="st"> </span><span class="kw"><a href="../reference/graph_minusplus.html">graph_minusplus</a></span>(example_graph)</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">newgraphs =<span class="st"> </span><span class="kw"><a href="../reference/graph_flipadmix.html">graph_flipadmix</a></span>(example_graph)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">newgraphs =<span class="st"> </span><span class="kw"><a href="../reference/graph_splittrees.html">graph_splittrees</a></span>(example_graph)</a></code></pre></div>
<p>To evaluate the new graphs, type:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">newgraphs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">  </span>rowwise <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">res =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="../reference/qpgraph.html">qpgraph</a></span>(example_f2_blocks, graph))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="st">  </span><span class="kw">unnest_wider</span>(res) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="st">  </span><span class="kw">arrange</span>(score)</a></code></pre></div>
<p>or, if you want to <a href="parallel.html">parallelize</a> this,</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">newgraphs <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">res =</span> furrr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/furrr/man/future_map.html">future_map</a></span>(graph, <span class="op">~</span><span class="kw"><a href="../reference/qpgraph.html">qpgraph</a></span>(example_f2_blocks, .))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="st">  </span><span class="kw">unnest_wider</span>(res) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="st">  </span><span class="kw">arrange</span>(score)</a></code></pre></div>
<pre><code>## # A tibble: 8 x 7
##    name graph   edges          score f2            f3            ppinv          
##   &lt;int&gt; &lt;list&gt;  &lt;list&gt;         &lt;dbl&gt; &lt;list&gt;        &lt;list&gt;        &lt;list&gt;         
## 1     6 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 19653. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 2     8 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 19653. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 3     2 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 26962. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 4     4 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 53066. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 5     3 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 62301. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 6     5 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 64137. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 7     7 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 64137. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 8     1 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 64137. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦</code></pre>
</div>
</div>
<div id="fitting-a-single-admixture-graph" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-a-single-admixture-graph" class="anchor"></a>Fitting a single admixture graph</h2>
<div id="edge-weight-optimization" class="section level3">
<h3 class="hasAnchor">
<a href="#edge-weight-optimization" class="anchor"></a>Edge weight optimization</h3>
<p><code><a href="../reference/qpgraph.html">qpgraph()</a></code> tries to find the admixture- and drift-edge weights for a given graph topology which are most consistent with the observed <span class="math inline">\(f_3\)</span>-statistics. The optimization of admixture weights requires initial values for these weights. Occasionally, the initial values have an effect on the final weight estimates because the optimization gets stuck in a local optimum. To avoid this, the <code><a href="../reference/qpgraph.html">qpgraph()</a></code> weight optimization is repeated with different randomly chosen combinations of starting weights, and the final likelihood score represents the best score out of all tries. By default, 10 different random combinations of starting weights are evaluated. Decreasing this number can speed up <code><a href="../reference/qpgraph.html">qpgraph()</a></code>, and increasing it can reduce the risk of missing the global optimum.</p>
<p>To get a better sense of how stable the edge weight optimization is, it makes sense to inspect the <code>opt</code> output of <code><a href="../reference/qpgraph.html">qpgraph()</a></code>. This data frame contains all random initial weight combinations, as well as the optimized weights, final scores (<code>value</code>) and additional information about the optimization generated by the <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> function.</p>
<p>In this example, the optimization is very stable, and the initial values do not affect the estimated weights or the score:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">example_winner<span class="op">$</span>opt[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>##            X1        X2        X3        p1        p2        p3    value fevals
## 1  0.07096771 0.5570287 0.2760519 0.3977308 0.6825699 0.2061932 4.001206     51
## 2  0.52067226 0.2790785 0.2311112 0.3977306 0.6825697 0.2061933 4.001206     13
## 3  0.04703453 0.8426236 0.1589736 0.3977306 0.6825697 0.2061933 4.001206     13
## 4  0.23402753 0.6483083 0.9764668 0.3977306 0.6825697 0.2061933 4.001206     15
## 5  0.04859723 0.2443325 0.6712799 0.3977306 0.6825697 0.2061934 4.001206     51
## 6  0.64079765 0.6574552 0.9912520 0.3977306 0.6825697 0.2061933 4.001206     12
## 7  0.97251921 0.1531614 0.2553865 0.3977306 0.6825697 0.2061933 4.001206     30
## 8  0.09519617 0.7965518 0.7882128 0.3977306 0.6825697 0.2061933 4.001206     15
## 9  0.99480784 0.2439424 0.1490095 0.3977306 0.6825697 0.2061933 4.001206     14
## 10 0.61758018 0.6886023 0.3912047 0.3977306 0.6825696 0.2061933 4.001206     10
##    gevals convergence
## 1      51          52
## 2      13           0
## 3      13           0
## 4      15           0
## 5      51          52
## 6      12           0
## 7      30           0
## 8      15           0
## 9      14           0
## 10     10           0</code></pre>
<p>Here, the optimization depends a bit more on the initial weights:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">example_qpgraph_ref_results<span class="op">$</span>opt</a></code></pre></div>
<pre><code>##       i.N2N4     i.N3N4      i.N3N8 e.N2N4 e.N3N4     e.N3N8    value fevals
## 1  0.7616225 0.34647487 0.412249106      0      0 0.00000000 19652.54      2
## 2  0.1795198 0.20519471 0.009456659      0      1 0.05947510 19219.98     27
## 3  0.5789027 0.75595585 0.173031624      0      1 0.05947507 19219.98     15
## 4  0.4161319 0.21328007 0.975338531      0      1 0.05947507 19219.98      7
## 5  0.9409036 0.96037222 0.944441426      0      0 0.00000000 19652.54      2
## 6  0.3354566 0.62811808 0.446383684      0      0 0.00000000 19652.54      2
## 7  0.6299324 0.09815806 0.213384736      0      0 0.00000000 19652.54      2
## 8  0.2220927 0.04966934 0.616733615      0      1 0.05947507 19219.98      7
## 9  0.8463281 0.83502828 0.372245495      0      0 0.00000000 19652.54      2
## 10 0.6660239 0.97142558 0.848605360      0      0 0.00000000 19652.54      2
##    gevals convergence
## 1       2           0
## 2      27           0
## 3      15           0
## 4       7           0
## 5       2           0
## 6       2           0
## 7       2           0
## 8       7           0
## 9       2           0
## 10      2           0</code></pre>
<p>The range of estimated weights for each admixture edge is also stored in the <code>low</code> and <code>high</code> columns of the <code>edges</code> data frame returned by <code><a href="../reference/qpgraph.html">qpgraph()</a></code>. The <code><a href="../reference/plot_comparison.html">plot_comparison()</a></code> function visualizes that information with grey error bars.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw"><a href="../reference/plot_comparison.html">plot_comparison</a></span>(example_qpgraph_ref_results, example_qpgraph_ref_results)</a></code></pre></div>
<p><img src="graphs_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div id="precomputed-f_3-statistics" class="section level3">
<h3 class="hasAnchor">
<a href="#precomputed-f_3-statistics" class="anchor"></a>Precomputed <span class="math inline">\(f_3\)</span>-statistics</h3>
<p>The first steps in <code><a href="../reference/qpgraph.html">qpgraph()</a></code> are computing <span class="math inline">\(f_3\)</span>-statistics from <span class="math inline">\(f_2\)</span>-statistics, and computing the inverse of the <span class="math inline">\(f_3\)</span>-statistic covariance matrix. When many graphs are evaluated for the same populations, it can be faster to run these steps only once and pass <span class="math inline">\(f_3\)</span>-statistics and the inverse of the covariance matrix to the <code><a href="../reference/qpgraph.html">qpgraph()</a></code> function. That is the purpose of the <code>f3precomp</code> and <code>ppinv</code> arguments. The <code>f3precomp</code> argument expects a list with <span class="math inline">\(f_3\)</span>-statistics and the inverse of the covariance matrix. It is used for example in <code><a href="../reference/find_graphs.html">find_graphs()</a></code>.</p>
<p>The <code>ppinv</code> argument expects only the inverse of the covariance matrix, while <span class="math inline">\(f_3\)</span>-statistics will be computed inside <code><a href="../reference/qpgraph.html">qpgraph()</a></code>. This is used in <code><a href="../reference/qpgraph_resample_multi.html">qpgraph_resample_multi()</a></code> to use an inverse covariance matrix computed on a different set of SNPs.</p>
</div>
<div id="regularization-terms" class="section level3">
<h3 class="hasAnchor">
<a href="#regularization-terms" class="anchor"></a>Regularization terms</h3>
<p>There are two regularization terms (fudge factors) used in qpGraph, which make matrix inversions more stable. One is added to the diagonal elements of the <span class="math inline">\(f_3\)</span> covariance matrix (after multiplying it by the mean of the diagonal elements). It is called <code>fudge_cov</code> and defaults to 10<sup>-5</sup>. Increasing this factor has a small effect on admixture weights and branch lengths, but will shift the likelihood scores to be <em>closer to zero</em>.</p>
<p>The other regularization terms is added to the covariance matrix of fitted branch lengths (after scaling as before). It is called <code>fudge</code> and defaults to 10<sup>-4</sup>. In the original <em>qpGraph</em> program, this parameter can be set through the <code>diag</code> parameter. Increasing <code>fudge</code> will shift the likelihood scores to be <em>further away from zero</em>. This regularization term ensures that edge weights will be evenly distributed across a set of edges whose weights could otherwise not be determined unambiguously. (As is often the case with the two edges originating in the root node.)</p>
<p>As these regularization terms affect the likelihood score, they should be kept constant whenever fits of different graphs are compared to each other.</p>
</div>
</div>
<div id="automatic-graph-optimization" class="section level2">
<h2 class="hasAnchor">
<a href="#automatic-graph-optimization" class="anchor"></a>Automatic graph optimization</h2>
<p>An advantage of being able to quickly evaluate a single model using precomputed <em>f</em>-statistics is that we can evaluate many different graphs in order to find graph topologies with good fits.</p>
<p><br></p>
<p>The function <code>find_graphs</code> attempts to automatically find admixture graphs that are compatible with the observed f-statistics. It generates and evaluates <code>numgraphs</code> admixture graphs in <code>numgen</code> generations, and in each generation selects and modifies the best graphs.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">opt_results =<span class="st"> </span><span class="kw"><a href="../reference/find_graphs.html">find_graphs</a></span>(my_f2_dir, pops, <span class="dt">outpop =</span> pops[<span class="dv">1</span>], <span class="dt">numrep =</span> <span class="dv">200</span>,</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">                          <span class="dt">numgraphs =</span> <span class="dv">100</span>, <span class="dt">numgen =</span> <span class="dv">20</span>, <span class="dt">numsel =</span> <span class="dv">5</span>, <span class="dt">numadmix =</span> <span class="dv">3</span>)</a></code></pre></div>
<p>The output of <code><a href="../reference/find_graphs.html">find_graphs()</a></code> (<code>opt_results</code>) will be a <a href="https://r4ds.had.co.nz/many-models.html#nested-data">nested data frame</a>, with each tested model in one line. Some columns in this data frame, like <code>score</code>, are regular numbers, while other columns, like <code>edges</code>, are <em>list-columns</em> where each element is another data frame.</p>
<p><br></p>
<p>The following commands will extract the best fitting model overall, and the best fitting model from each independent repeat.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">winner =<span class="st"> </span>opt_results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">1</span>, <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span>(score))</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">winners =<span class="st"> </span>opt_results <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">group_by</span>(run) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">top_n</span>(<span class="dv">1</span>, <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span>(score)) <span class="op">%&gt;%</span><span class="st"> </span>ungroup</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">winner<span class="op">$</span>score[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>## [1] 4.009599</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="../reference/plot_graph.html">plot_graph</a></span>(winner<span class="op">$</span>edges[[<span class="dv">1</span>]])</a></code></pre></div>
<p><img src="graphs_files/figure-html/unnamed-chunk-18-1.png" width="864" style="display: block; margin: auto;"></p>
<p>It can take a while until <code><a href="../reference/find_graphs.html">find_graphs()</a></code> finds graphs with good fits. To speed it up, it can be <a href="parallel.html">parallelized</a>.</p>
<p><br></p>
</div>
<div id="comparing-the-fits-of-different-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-the-fits-of-different-graphs" class="anchor"></a>Comparing the fits of different graphs</h2>
<p>If two different graphs model the same populations and the second graph has a better likelihood score than the first one, it suggests that the second graph is a better representation of the actual demographic history. Thatâ€™s generally true, but there are two complications:</p>
<ol style="list-style-type: decimal">
<li><p>If the second graph is more complex (i.e.Â if it has more admixture events), it has more degrees of freedom and thus an unfair advantage over the first one. It might get a better score even if the simpler graph is closer to the true demographic history.</p></li>
<li><p>It is possible that the difference in scores is due to chance, and not because one of the two models really fits the data better. What if we had picked different samples from each population? Or what if we had picked different SNPs? Would the second model still be preferred over the first one?</p></li>
</ol>
<p>ADMIXTOOLS 2 solves the first problem by computing out-of-sample scores, and the second problem by computing the fit of a graph using bootstrap-resampled SNP blocks.</p>
<div id="out-of-sample-scores" class="section level3">
<h3 class="hasAnchor">
<a href="#out-of-sample-scores" class="anchor"></a>Out-of-sample scores</h3>
<p><em>qpGraph</em> likelihood scores <span class="math inline">\(S\)</span> are computed by comparing estimated f3-statistics <span class="math inline">\(g\)</span> to fitted f3-statistics <span class="math inline">\(f\)</span> - those that we would expect to observe under a given admixture graph. The difference between estimated and fitted f3-statistics, the residuals, are adjusted by the inverse covariance matrix of f3-statistics <span class="math inline">\(Q\)</span>, to get the likelihood score. If this covariance matrix was the identity matrix, the scores would just be the squared sum of residuals.</p>
<p><span class="math display">\[S = -\frac{1}{2} (g - f)' Q^{-1} (g - f)\]</span></p>
<p>Under this definition likelihood scores are actually negative, but usually the minus sign is dropped and positive scores are reported instead.</p>
<p>In fitting edge weights, <em>qpGraph</em> maximizes this likelihood score (bringing it closer to 0). To avoid overfitting, we can compute a new score <span class="math inline">\(S'\)</span> after fitting the model, using SNPs (or SNP blocks) which havenâ€™t been used for fitting the model:</p>
<p><span class="math display">\[S' = -\frac{1}{2} (g_{train} - f_{test})' Q^{-1} (g_{train} - f_{test})\]</span></p>
<p>These scores tend to be further away from zero, but they allow us to fairly compare models of different complexity to each other.</p>
<p>In ADMIXTOOLS 2, you can compute out-of-sample scores by providing the <code><a href="../reference/qpgraph.html">qpgraph()</a></code> function with an <code>f2_blocks_test</code> argument.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">nblocks =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(example_f2_blocks)[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">train =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span>nblocks, <span class="kw"><a href="https://rdrr.io/r/base/Round.html">round</a></span>(nblocks<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">res =<span class="st"> </span><span class="kw"><a href="../reference/qpgraph.html">qpgraph</a></span>(<span class="dt">f2_blocks =</span> example_f2_blocks[,,train], example_graph,</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">              <span class="dt">f2_blocks_test =</span> example_f2_blocks[,,<span class="op">-</span>train])</a>
<a class="sourceLine" id="cb22-5" data-line-number="5">res<span class="op">$</span>score</a></code></pre></div>
<pre><code>## [1] 10829.22</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">res<span class="op">$</span>score_test</a></code></pre></div>
<pre><code>## [1] 11097.88</code></pre>
</div>
<div id="bootstrap-resampled-graph-fits" class="section level3">
<h3 class="hasAnchor">
<a href="#bootstrap-resampled-graph-fits" class="anchor"></a>Bootstrap-resampled graph fits</h3>
<p>Out-of-sample scores allow us to get fair comparisons for any two admixture graphs, but they still donâ€™t tell us whether a difference is significant. For that, we can use bootstrap resampling of SNP blocks: Each graph is evaluated many times on a random subset of SNP blocks. The variation among those scores tells us whether the scores of both graphs are significantly different from one another.</p>
<p>To combine this idea with out-of-sample scores to prevent overfitting, we can use the SNP blocks which were not selected in each bootstrap iteration as the out-of-sample SNP blocks.</p>
<p>The following example shows how to test whether <code>graph1</code> gives a significantly better fit than <code>graph2</code>:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1">pops =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(example_f2_blocks)[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">graph1 =<span class="st"> </span>example_winners <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(score) <span class="op">%$%</span><span class="st"> </span>igraph[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">graph2 =<span class="st"> </span>example_winners <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(score) <span class="op">%$%</span><span class="st"> </span>igraph[[<span class="dv">100</span>]]</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">fits =<span class="st"> </span><span class="kw"><a href="../reference/qpgraph_resample_multi.html">qpgraph_resample_multi</a></span>(example_f2_blocks, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(graph1, graph2), <span class="dt">nboot =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb26-5" data-line-number="5"><span class="kw"><a href="../reference/compare_fits3.html">compare_fits3</a></span>(fits[[<span class="dv">1</span>]]<span class="op">$</span>score_test, fits[[<span class="dv">2</span>]]<span class="op">$</span>score_test)</a></code></pre></div>
</div>
</div>
<div id="summarizing-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#summarizing-graphs" class="anchor"></a>Summarizing graphs</h2>
<p><br></p>
<blockquote>
<p><em>All models are wrong, but some are useful.</em> â€” George Box</p>
</blockquote>
<p><br></p>
<blockquote>
<p><em>All good models are alike; each bad model is bad in its own way.</em> â€” Leo Tolstoy</p>
</blockquote>
<p><br></p>
<p>For any set of populations there may be many graphs which can explain the data about equally well, with no significant difference in likelihood scores. Rather than declaring one of these models as the correct model, it may be more useful to find features that are shared between all models with good fits. The following function attempts to find such features by summarizing a set of graphs. It counts how often each population triple occurs in which configuration across all graphs.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">triples =<span class="st"> </span><span class="kw"><a href="../reference/summarize_triples.html">summarize_triples</a></span>(winners)</a></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">triples <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">arrange</span>(<span class="op">-</span>clade) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>)</a></code></pre></div>
<pre><code>## # A tibble: 1 x 14
##   name1 name2 name3 numgraphs   x13   x23   x31   x32 clade   x12   x21 toptopo
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;     &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  
## 1 Russâ€¦ Switâ€¦ Deniâ€¦       200 0.005 0.245 0.505  0.38 0.345  0.88 0.505 011111 
## # â€¦ with 2 more variables: toptopocnt &lt;int&gt;, topos &lt;list&gt;</code></pre>
<p>The output for this population triple (1: <code>Rus</code>, 2: <code>Swi</code>, 3: <code>Den</code>) can be read like this:</p>
<ul>
<li>
<code>numgraphs</code>: 200 graphs were compared</li>
<li>
<code>clade</code>: In 34.5% of all graphs <code>Rus</code> and <code>Swi</code> form a clade with respect to <code>Den</code>
</li>
<li>
<code>x13</code>: In 0.5% of all graphs <code>Rus</code> is closer to <code>Den</code> than <code>Swi</code> is to <code>Den</code>, with ancestors of <code>Rus</code> admixing into <code>Den</code>
</li>
<li>
<code>x31</code>: In 50.5% of all graphs <code>Rus</code> is closer to <code>Den</code> than <code>Swi</code> is to <code>Den</code>, with ancestors of <code>Den</code> admixing into <code>Rus</code>
</li>
<li>
<code>x23</code>: In 24.5% of all graphs <code>Swi</code> is closer to <code>Den</code> than <code>Rus</code> is to <code>Den</code>, with ancestors of <code>Swi</code> admixing into <code>Den</code>
</li>
<li>
<code>x32</code>: In 38.0% of all graphs <code>Swi</code> is closer to <code>Den</code> than <code>Rus</code> is to <code>Den</code>, with ancestors of <code>Den</code> admixing into <code>Swi</code>
</li>
<li>
<code>toptopo</code>: The most common topology for this triple across all graphs. <code>011111</code> specifies a topology where condition <code>x13</code> is not satisfied, but conditions <code>x23</code>, <code>x31</code>, <code>x32</code>, <code>x12</code>, and <code>x21</code> are satisfied. A topology starting with <code>0000</code> is one where the first two populations form a clade.</li>
<li>
<code>toptopocnt</code>: The number of times <code>toptopo</code> was observed</li>
<li>
<code>topos</code>: The number of times each topology was observed</li>
</ul>
<p><br></p>
</div>
<div id="finding-valid-qpadm-models" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-valid-qpadm-models" class="anchor"></a>Finding valid qpAdm models</h2>
<p>Every admixture graph maps to a specific set of valid qpAdm models. The function <code>qpadm_models</code> lists all valid qpAdm models for a graph. Models which are contained within larger valid models are not shown. The number of valid qpAdm models can be very large for big graphs, so you should only run this on small graphs.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">mygraph =<span class="st"> </span>winners <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">slice</span>(<span class="dv">6</span>) <span class="op">%$%</span><span class="st"> </span>igraph <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pluck</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw"><a href="../reference/plot_graph.html">plot_graph</a></span>(mygraph)</a></code></pre></div>
<p><img src="graphs_files/figure-html/unnamed-chunk-24-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw"><a href="../reference/qpadm_models.html">qpadm_models</a></span>(mygraph, <span class="dt">add_outgroup =</span> <span class="ot">TRUE</span>, <span class="dt">nested =</span> <span class="ot">FALSE</span>, <span class="dt">abbr =</span> <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   target left    right      
##   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;      
## 1 Den    Alt,Mbu Chi,Rus,Swi
## 2 Den    Alt,Vin Chi,Rus,Swi
## 3 Den    Mbu,Vin Chi,Rus,Swi</code></pre>
<p>The only qpAdm models which are valid under this graph have <code>Den</code> as target and <code>Chi</code>, <code>Rus</code>, and <code>Swi</code> as right populations.</p>
<p>Valid qpAdm models need to satisfy the following criteria:</p>
<ul>
<li>There have to be more right populations than left populations</li>
<li>The left populations should not form a clade with respect to any right population. This means that a qpgraph outgroup is not an informative right population, but it can be included anyway, with <code>add_outgroup</code>.</li>
<li>Each set of left populations which forms a source for the target population has to form a clade with target at the exclusion of each right population. (Note: Check if thatâ€™s correct and if it can be stated in a better way.)</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#graph-formats">Graph formats</a></li>
      <li><a href="#creating-admixture-graphs">Creating admixture graphs</a></li>
      <li><a href="#modifying-admixture-graphs">Modifying admixture graphs</a></li>
      <li><a href="#fitting-a-single-admixture-graph">Fitting a single admixture graph</a></li>
      <li><a href="#automatic-graph-optimization">Automatic graph optimization</a></li>
      <li><a href="#comparing-the-fits-of-different-graphs">Comparing the fits of different graphs</a></li>
      <li><a href="#summarizing-graphs">Summarizing graphs</a></li>
      <li><a href="#finding-valid-qpadm-models">Finding valid qpAdm models</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert Maier, Nick Patterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: '',
    indexName: 'admixtools',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
