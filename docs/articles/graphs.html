<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admixture graphs â€¢ admixtools</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- docsearch --><script src="../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><script src="../extra.js"></script><meta property="og:title" content="Admixture graphs">
<meta property="og:description" content="admixtools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-155330476-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-155330476-1');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">admixtools</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/admixtools.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fstats.html">f-statistics</a>
    </li>
    <li>
      <a href="../articles/graphs.html">Admixture graphs</a>
    </li>
    <li>
      <a href="../articles/io.html">Genotype data</a>
    </li>
    <li>
      <a href="../articles/parallel.html">Parallelization</a>
    </li>
    <li>
      <a href="../articles/plotting.html">Plotting</a>
    </li>
    <li>
      <a href="../articles/resampling.html">Standard errors</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/uqrmaie1/admixtools/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="graphs_files/header-attrs-2.5/header-attrs.js"></script><link href="graphs_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="graphs_files/anchor-sections-1.0/anchor-sections.js"></script><script src="graphs_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="graphs_files/plotly-binding-4.9.2.1/plotly.js"></script><script src="graphs_files/typedarray-0.1/typedarray.min.js"></script><script src="graphs_files/jquery-1.11.3/jquery.min.js"></script><link href="graphs_files/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet">
<script src="graphs_files/crosstalk-1.1.0.1/js/crosstalk.min.js"></script><link href="graphs_files/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet">
<script src="graphs_files/plotly-main-1.52.2/plotly-latest.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Admixture graphs</h1>
                        <h4 class="author">Robert Maier</h4>
            
            <h4 class="date">2020-12-04</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/uqrmaie1/admixtools/blob/master/vignettes/graphs.Rmd"><code>vignettes/graphs.Rmd</code></a></small>
      <div class="hidden name"><code>graphs.Rmd</code></div>

    </div>

    
    
<p><strong>Under construction</strong></p>
<p>Admixture graphs are models of the demographic history of a set of populations. <em>f</em>-statistics can be used to evaluate how well a specific admixture graph fits the data, and to estimate the drift lengths and admixture weights in a graph.</p>
<p><em>ADMIXTOOLS 2</em> makes it easy to work with admixture graphs. It allows you to read and write them in a number of different formats, create them from scratch, and modify them in several ways. You can either modify them manually, one edge or one node at a time, or automatically, by generating all possible variations of a certain type (for example all graphs that result from adding one admixture edge to the current graph).</p>
<p>The purpose of all this is to find well fitting models, and to find out which models are not compatible with the data. This is further simplified by <code><a href="../reference/find_graphs.html">find_graphs()</a></code>, a function which automatically finds well fitting graphs by repeatedly selecting the best among a set of randomly modified graphs. <em>ADMIXTOOLS 2</em> also introduces a method for testing whether one admixture graph fits the data significantly better than another.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org">magrittr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/uqrmaie1/admixtools">admixtools</a></span><span class="op">)</span></code></pre></div>
<div id="background-and-theory" class="section level2">
<h2 class="hasAnchor">
<a href="#background-and-theory" class="anchor"></a>Background and theory</h2>
<div id="f4-and-graphs" class="section level3">
<h3 class="hasAnchor">
<a href="#f4-and-graphs" class="anchor"></a>f4 and graphs</h3>
<p>Single <span class="math inline">\(f_4\)</span>-statistics and <em>D</em>-statistics tell us what an admixture graph for four populations could look like. Letâ€™s say we have four populations with these <span class="math inline">\(f_4\)</span>- or <em>D</em>-statistics (Note that all other possible <span class="math inline">\(f_4\)</span>-statistics can be computed from these two.):</p>
<p><span class="math display">\[f_4(A,B; C,D) = 0\]</span> <span class="math display">\[f_4(A,C; B,D) = 0.1\]</span></p>
<p><span class="math inline">\(f_4(A,B; C,D) = 0\)</span> suggests that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> form a clade relative to <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span>, and a significantly positive value for <span class="math inline">\(f_4(A,C; B,D)\)</span> suggests that there is some amount of genetic drift shared between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> that is not shared by <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> (If <span class="math inline">\(f_4(A,C; B,D)\)</span> were also zero, it would suggest a star phylogeny). The admixture graph connecting the four populations could therefore look like this:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'R'</span>, <span class="st">'n1'</span>, <span class="st">'R'</span>, <span class="st">'n2'</span>, <span class="st">'n1'</span>, <span class="st">'A'</span>,
             <span class="st">'n1'</span>, <span class="st">'B'</span>, <span class="st">'n2'</span>, <span class="st">'C'</span>, <span class="st">'n2'</span>, <span class="st">'D'</span><span class="op">)</span>, , <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/edges_to_igraph.html">edges_to_igraph</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-20d18f4529fe72b1f9ff" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-20d18f4529fe72b1f9ff">{"x":{"data":[{"x":[-1,-1.5,null,-1,-0.5,null,1,0.5,null,1,1.5],"y":[1,0,null,1,0,null,1,0,null,1,0],"text":["n1 -> A","n1 -> A",null,"n1 -> B","n1 -> B",null,"n2 -> C","n2 -> C",null,"n2 -> D","n2 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1,null,0,1],"y":[2,1,null,2,1],"text":["R -> n1","R -> n1",null,"R -> n2","R -> n2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1,1],"y":[2,1,1],"text":["R","n1","n2"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,0.5,-1.25,-0.75,0.75,1.25],"y":[1.5,1.5,0.5,0.5,0.5,0.5],"text":["","","","","",""],"hovertext":["R -> n1","R -> n2","n1 -> A","n1 -> B","n2 -> C","n2 -> D"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,-0.5,0.5,1.5],"y":[-0.1,-0.1,-0.1,-0.1],"text":["A","B","C","D"],"hovertext":["","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.9,1.9],"tickmode":"array","ticktext":["-1","0","1"],"tickvals":[-1,0,1],"categoryorder":"array","categoryarray":["-1","0","1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.205,2.105],"tickmode":"array","ticktext":["0.0","0.5","1.0","1.5","2.0"],"tickvals":[0,0.5,1,1.5,2],"categoryorder":"array","categoryarray":["0.0","0.5","1.0","1.5","2.0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b5b846af":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b5288e18":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b2988cc4d":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b541ce888":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b5b846af","visdat":{"870b5b846af":["function (y) ","x"],"870b5288e18":["function (y) ","x"],"870b2988cc4d":["function (y) ","x"],"870b541ce888":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The distance between the internal nodes <span class="math inline">\(n1\)</span> and <span class="math inline">\(n2\)</span> is given by <span class="math inline">\(f_4(A,C; B,D) = 0.1\)</span>.</p>
<p>An equally plausible admixture graph for this scenario is one in which <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are not a clade in the strict sense, but in the sense that there is no overlap between the path from <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> and the path from <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'R'</span>, <span class="st">'A'</span>, <span class="st">'R'</span>, <span class="st">'n1'</span>, <span class="st">'n1'</span>, <span class="st">'B'</span>,
             <span class="st">'n1'</span>, <span class="st">'n2'</span>, <span class="st">'n2'</span>, <span class="st">'C'</span>, <span class="st">'n2'</span>, <span class="st">'D'</span><span class="op">)</span>, , <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/edges_to_igraph.html">edges_to_igraph</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-f86cf6f7456be921bff9" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f86cf6f7456be921bff9">{"x":{"data":[{"x":[1,0.5,null,1,1.5],"y":[1,0,null,1,0],"text":["n2 -> C","n2 -> C",null,"n2 -> D","n2 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[2,1,null,2,1],"text":["n1 -> B","n1 -> B",null,"n1 -> n2","n1 -> n2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[3,2,null,3,2],"text":["R -> A","R -> A",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,1],"y":[3,2,1],"text":["R","n1","n2"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.25,0.75,0.75,1.25],"y":[2.5,2.5,1.5,1.5,0.5,0.5],"text":["","","","","",""],"hovertext":["R -> A","R -> n1","n1 -> B","n1 -> n2","n2 -> C","n2 -> D"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,1.5],"y":[-0.1,-0.1],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[0.9],"text":"B","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,186,56,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[1.9],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(97,156,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.8,1.8],"tickmode":"array","ticktext":["0","1"],"tickvals":[0,1],"categoryorder":"array","categoryarray":["0","1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.255,3.155],"tickmode":"array","ticktext":["0","1","2","3"],"tickvals":[0,1,2,3],"categoryorder":"array","categoryarray":["0","1","2","3"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b3ffca4a5":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b639d6d74":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b747d0dc3":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b3e12b8f4":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b3ffca4a5","visdat":{"870b3ffca4a5":["function (y) ","x"],"870b639d6d74":["function (y) ","x"],"870b747d0dc3":["function (y) ","x"],"870b3e12b8f4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>This simple example demonstrates that</p>
<ul>
<li>
<em>f</em>-statistics can be used to find plausible admixture graphs</li>
<li>multiple different admixture graphs can fit the data equally well, and that</li>
<li>both the topology, and the parameters of an admixture graph can be estimated with <em>f</em>-statistics</li>
</ul>
<p>The example also shows that <em>f</em>-statistics cannot tell us where the root of a graph should be. For that it helps to include an outgroup in the graph so we know that the root is at the correct position.</p>
</div>
<div id="graph-f2-equations" class="section level3">
<h3 class="hasAnchor">
<a href="#graph-f2-equations" class="anchor"></a>Graph f2 equations</h3>
<p>In any admixture graph, <span class="math inline">\(f_2\)</span> of two populations is simply the sum of all path lengths that lie between the populations. For example, in the two graphs above, <span class="math inline">\(f_2(C, D) = n2|C + n2|D\)</span>, where <span class="math inline">\(n2|C\)</span> is the edge going from <span class="math inline">\(n2\)</span> to <span class="math inline">\(C\)</span>.</p>
<p>More generally, an admixture graph can be described by a set of equations which relate edges of the graph to <em>f</em>-statistics. There are <span class="math inline">\(\frac{k(k-1)}{2}\)</span> equations for the <span class="math inline">\(f_2\)</span>-statistics of all population pairs (<span class="math inline">\(k\)</span> is the number of populations):</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/graph_equations.html">graph_equations</a></span><span class="op">(</span><span class="va">g</span>, substitute <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">equations</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   pop1  pop2  equation                           
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                              
## 1 A     B     (`R|A` + `R|n1` + `n1|B`)          
## 2 A     C     (`R|A` + `R|n1` + `n1|n2` + `n2|C`)
## 3 A     D     (`R|A` + `R|n1` + `n1|n2` + `n2|D`)
## 4 B     C     (`n1|B` + `n1|n2` + `n2|C`)        
## 5 B     D     (`n1|B` + `n1|n2` + `n2|D`)        
## 6 C     D     (`n2|C` + `n2|D`)</code></pre>
<p>These equations tell us that the expected <span class="math inline">\(f_2\)</span>-statistics for each pair is the sum of all edges that separate these two populations. In graphs with admixture, some population pairs will be connected through more than a single path. For those population pairs the expected <span class="math inline">\(f_2\)</span> will be a weighted sum of all paths connecting the two populations, with the weights given by the relative ancestry proportions.</p>
<p>Here is a simple graph with one admixture event:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'R'</span>, <span class="st">'O'</span>, <span class="st">'R'</span>, <span class="st">'n1'</span>, <span class="st">'n1'</span>, <span class="st">'n2'</span>, <span class="st">'n1'</span>, <span class="st">'n3'</span>, <span class="st">'n2'</span>,
              <span class="st">'B'</span>, <span class="st">'n2'</span>, <span class="st">'n4'</span>, <span class="st">'n3'</span>, <span class="st">'a'</span>, <span class="st">'n3'</span>, <span class="st">'C'</span>, <span class="st">'n4'</span>, <span class="st">'a'</span>,
              <span class="st">'n4'</span>, <span class="st">'D'</span>, <span class="st">'a'</span>, <span class="st">'A'</span><span class="op">)</span>, , <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/edges_to_igraph.html">edges_to_igraph</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-f33350a829d509d3b042" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-f33350a829d509d3b042">{"x":{"data":[{"x":[0,1],"y":[1,0],"text":"n4 -> a","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.5,1],"y":[2,0],"text":"n3 -> a","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[0,-1],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[1,0],"text":"n4 -> D","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,-1,null,-0.5,0,null,1.5,2],"y":[2,1,null,2,1,null,2,1],"text":["n2 -> B","n2 -> B",null,"n2 -> n4","n2 -> n4",null,"n3 -> C","n3 -> C"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.5,null,0.5,1.5],"y":[3,2,null,3,2],"text":["n1 -> n2","n1 -> n2",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,-0.5,1.5,0,1],"y":[4,3,2,2,1,0],"text":["R","n1","n2","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0,1,-0.75,-0.25,1.25,1.75,0.5,0,1],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1,1.5,0.5,0.5,-0.5],"text":["","","","","","","","","","",""],"hovertext":["R -> O","R -> n1","n1 -> n2","n1 -> n3","n2 -> B","n2 -> n4","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-1.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[-0.1],"text":"D","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(163,165,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,2],"y":[0.9,0.9],"text":["B","C"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,125,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.4,2.4],"tickmode":"array","ticktext":["-1","0","1","2"],"tickvals":[-1,0,1,2],"categoryorder":"array","categoryarray":["-1","0","1","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.355,4.255],"tickmode":"array","ticktext":["-1","0","1","2","3","4"],"tickvals":[-1,0,1,2,3,4],"categoryorder":"array","categoryarray":["-1","0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b537bbcb3":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b60a1b696":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b18da636a":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b29b4d0e5":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b537bbcb3","visdat":{"870b537bbcb3":["function (y) ","x"],"870b60a1b696":["function (y) ","x"],"870b18da636a":["function (y) ","x"],"870b29b4d0e5":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>To go from <span class="math inline">\(A\)</span> to <span class="math inline">\(C\)</span>, there are now two paths: A short path through the right admixture edge, and a long path through the left admixture edges. <span class="math inline">\(f_2(A, C)\)</span> is a weighted sum of these two paths:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/graph_equations.html">graph_equations</a></span><span class="op">(</span><span class="va">g</span>, substitute <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">$</span><span class="va">equations</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">pop1</span> <span class="op">==</span> <span class="st">'A'</span>, <span class="va">pop2</span> <span class="op">==</span> <span class="st">'C'</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pull</span><span class="op">(</span><span class="va">equation</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "`a` * (`n1|n2` + `n2|n4` + `a|A` + `n1|n3` + `n3|C`) + (1 - `a`) * (`a|A` + `n3|C`)"</code></pre>
<p><span class="math inline">\(a\)</span> is the proportion of admixture coming through the left admixture edge, and <span class="math inline">\(1-a\)</span> is the proportion coming from the right.</p>
</div>
<div id="graph-as-a-function" class="section level3">
<h3 class="hasAnchor">
<a href="#graph-as-a-function" class="anchor"></a>Graph as a function</h3>
<p>Another way to think about the equations describing a graph is that they represent an admixture graph as a function which maps drift and admixture weights to a set of <em>f</em>-statistics. This is a function in the sense that every combination of weights is mapped to exactly one set of <em>f</em>-statistics. We can turn a graph object to a function and see how different edge weights lead to different <em>f</em>-statistics.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mygraph</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_f2_function.html">graph_f2_function</a></span><span class="op">(</span><span class="va">g</span>, admix_default <span class="op">=</span> <span class="fl">0.5</span>, drift_default <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="fu">mygraph</span><span class="op">(</span>`a|A` <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">head</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   pop1  pop2     f2
##   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 A     B      0.25
## 2 A     C      0.25
## 3 A     D      0.25
## 4 A     O      0.35
## 5 B     C      0.4 
## 6 B     D      0.3</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mygraph</span><span class="op">(</span>`a|A` <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">head</span></code></pre></div>
<pre><code>## # A tibble: 6 x 3
##   pop1  pop2     f2
##   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 A     B      0.45
## 2 A     C      0.45
## 3 A     D      0.45
## 4 A     O      0.55
## 5 B     C      0.4 
## 6 B     D      0.3</code></pre>
<p>Similarly, we can see how <span class="math inline">\(f_4\)</span>-statistics are affected by changing one of the drift weights:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mygraph</span><span class="op">(</span>`a|A` <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/f2dat_f4dat.html">f2dat_f4dat</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">head</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   pop1  pop2  pop3  pop4       f4
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;   &lt;dbl&gt;
## 1 A     B     A     B      0.25  
## 2 A     B     A     C      0.0500
## 3 A     B     A     D      0.100 
## 4 A     B     A     O      0.1   
## 5 A     B     B     A     -0.25  
## 6 A     B     B     C     -0.2</code></pre>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mygraph</span><span class="op">(</span>`a|A` <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/f2dat_f4dat.html">f2dat_f4dat</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">head</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##   pop1  pop2  pop3  pop4     f4
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1 A     B     A     B      0.45
## 2 A     B     A     C      0.25
## 3 A     B     A     D      0.3 
## 4 A     B     A     O      0.3 
## 5 A     B     B     A     -0.45
## 6 A     B     B     C     -0.2</code></pre>
<p>Usually we observe <em>f</em>-statistics and want to estimate drift and admixture weights. Thatâ€™s the inverse of the function above, and it is what <code><a href="../reference/qpgraph.html">qpgraph()</a></code> does.</p>
</div>
<div id="f4-ratio-test" class="section level3">
<h3 class="hasAnchor">
<a href="#f4-ratio-test" class="anchor"></a>f4 ratio test</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-1f879fd916664aba6397" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1f879fd916664aba6397">{"x":{"data":[{"x":[0,1],"y":[1,0],"text":"n4 -> a","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.5,1],"y":[2,0],"text":"n3 -> a","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[0,-1],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[1,0],"text":"n4 -> D","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,-1,null,-0.5,0,null,1.5,2],"y":[2,1,null,2,1,null,2,1],"text":["n2 -> B","n2 -> B",null,"n2 -> n4","n2 -> n4",null,"n3 -> C","n3 -> C"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.5,null,0.5,1.5],"y":[3,2,null,3,2],"text":["n1 -> n2","n1 -> n2",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,-0.5,1.5,0,1],"y":[4,3,2,2,1,0],"text":["R","n1","n2","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0,1,-0.75,-0.25,1.25,1.75,0.5,0,1],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1,1.5,0.5,0.5,-0.5],"text":["","","","","","","","","","",""],"hovertext":["R -> O","R -> n1","n1 -> n2","n1 -> n3","n2 -> B","n2 -> n4","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-1.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[-0.1],"text":"D","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(163,165,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,2],"y":[0.9,0.9],"text":["B","C"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,125,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.4,2.4],"tickmode":"array","ticktext":["-1","0","1","2"],"tickvals":[-1,0,1,2],"categoryorder":"array","categoryarray":["-1","0","1","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.355,4.255],"tickmode":"array","ticktext":["-1","0","1","2","3","4"],"tickvals":[-1,0,1,2,3,4],"categoryorder":"array","categoryarray":["-1","0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b4b55f428":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b781094bb":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b894be92":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b5d6b67a4":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b4b55f428","visdat":{"870b4b55f428":["function (y) ","x"],"870b781094bb":["function (y) ","x"],"870b894be92":["function (y) ","x"],"870b5d6b67a4":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>The graph above illustrates nicely how the <span class="math inline">\(f_4\)</span>-ratio test can be used to estimate admixture weights. This test estimates an admixture weight <span class="math inline">\(a\)</span> as the ratio of two <span class="math inline">\(f_4\)</span>-statistics, in this case <span class="math inline">\(a = \frac{f_4(O,B;C,A)}{f_4(O,B;C,D)}\)</span>. <span class="math inline">\(f_4(O,B;C,D)\)</span> is exactly equal to the distance between <span class="math inline">\(n1\)</span> and <span class="math inline">\(n2\)</span>, the left blue edge. Thatâ€™s because <span class="math inline">\(O\)</span> and <span class="math inline">\(C\)</span> form a clade relative to <span class="math inline">\(B\)</span> and <span class="math inline">\(D\)</span>, and this edge is the only connection between the two clades. (They are not clades in the usual sense of the word, but in the sense that there is no overlap between the paths from <span class="math inline">\(O\)</span> to <span class="math inline">\(C\)</span> and the paths from <span class="math inline">\(B\)</span> to <span class="math inline">\(D\)</span>.) At the same time, <span class="math inline">\(f_4(O,B;C,A)\)</span> is the intersection of paths going from <span class="math inline">\(O\)</span> to <span class="math inline">\(C\)</span>, and from <span class="math inline">\(B\)</span> to <span class="math inline">\(A\)</span>. Now there are two paths going from <span class="math inline">\(B\)</span> to <span class="math inline">\(A\)</span>: A short one through the left, and a long one through the right admixture edge. Along the short path going to <span class="math inline">\(A\)</span> from the left, there is no intersection with the path from <span class="math inline">\(O\)</span> to <span class="math inline">\(C\)</span>, so the component of <span class="math inline">\(f_4(O,B;C,A)\)</span> going through that path is zero. This means that all if <span class="math inline">\(f_4(O,B;C,A)\)</span> is not equal to zero, it is only due to the long path from <span class="math inline">\(B\)</span> to <span class="math inline">\(A\)</span>. Along that path, the intersection with <span class="math inline">\(O\)</span> to <span class="math inline">\(C\)</span> is exactly the left blue edge again. We now have two expressions for the length of that path: The first expression is <span class="math inline">\(f_4(O,B;C,D)\)</span>, and the second expression is <span class="math inline">\(a \times f_4(O,B;C,A)\)</span>, and so we can estimate <span class="math inline">\(a\)</span> as <span class="math inline">\(\frac{f_4(O,B;C,A)}{f_4(O,B;C,D)}\)</span>.</p>
<p>For more complex graphs, drift lengths and admixture weights can be estimated in just the same way, although it is not always possible to express each estimated parameter as a simple ratio of two <em>f</em>-statistics. However, even without such simple expression, it is usually possible estimate graph parameters by numerically finding solutions to the system of graph equations. <code><a href="../reference/qpgraph.html">qpgraph()</a></code> is doing just that: It finds the drift and admixture weights for a given graph which minimize the squared difference between the observed and the expected <em>f</em>-statistics.</p>
</div>
<div id="why-f3" class="section level3">
<h3 class="hasAnchor">
<a href="#why-f3" class="anchor"></a>Why f3?</h3>
<p>(See also <a href="graphs.html#fitting-a-single-admixture-graph-1">this section</a>)</p>
<p><code><a href="../reference/qpgraph.html">qpgraph()</a></code> uses <span class="math inline">\(f_3\)</span>- rather than <span class="math inline">\(f_2\)</span>-statistics for modeling graphs. <span class="math inline">\(f_3\)</span>- and <span class="math inline">\(f_4\)</span>-statistics are just sums of <span class="math inline">\(f_2\)</span>-statistics, in particular</p>
<p><span class="math display">\[f_3(A; B, C) = \frac{1}{2} (f_2(A,B)+f_2(A,C)-f_2(B,C))\]</span></p>
<p>This raises the question whether it makes a difference to express a graph in terms of equations for <span class="math inline">\(f_2\)</span>-statistics or equations for <span class="math inline">\(f_3\)</span>-statistics. If there is an exact solution for one of the (<span class="math inline">\(f_2\)</span> or <span class="math inline">\(f_3\)</span>) equation system, it is also a solution for the other equation system. In a case like that, the choice of <em>f</em>-statistics used does not make a difference.</p>
<p>In practice, however, there usually is no exact solution for a given graph and set of <em>f</em>-statistics. Instead, <code><a href="../reference/qpgraph.html">qpgraph()</a></code> estimates weights which minimize the sum of squared differences between the expected and the observed <em>f</em>-statistics, and this difference is usually greater than zero. In that case, an equation system of <span class="math inline">\(f_2\)</span>-statistics can lead to different weight estimates than an equation system of <span class="math inline">\(f_3\)</span>-statistics. In particular, using <span class="math inline">\(f_3\)</span>-statistics will give more importance to the internal edges of the admixture graph, rather than the terminal edges leading to the leaf nodes. Thatâ€™s because each <span class="math inline">\(f_2\)</span>-statistic can be thought of as the distance between two leaf nodes, while most <span class="math inline">\(f_3\)</span>-statistics (all except the ones of the form <span class="math inline">\(f_3(A; B, B)\)</span>) can be thought of as the distance between one leaf node (ideally an outgroup) and some internal node (the split point of the other two populations, in the simplest case without admixture).</p>
</div>
<div id="identifiability" class="section level3">
<h3 class="hasAnchor">
<a href="#identifiability" class="anchor"></a>Identifiability</h3>
<p>Each admixture graph can be described by an equation system which relates drift lengths and admixture weights to <em>f</em>-statistics. However, it is not always possible to estimate all graph parameters at the same time. Consider the following graph, which differs from the earlier graph only in that population <span class="math inline">\(B\)</span> is missing:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'R'</span>, <span class="st">'O'</span>, <span class="st">'R'</span>, <span class="st">'n1'</span>, <span class="st">'n1'</span>, <span class="st">'n4'</span>, <span class="st">'n1'</span>, <span class="st">'n3'</span>,
              <span class="st">'n3'</span>, <span class="st">'a'</span>, <span class="st">'n3'</span>, <span class="st">'C'</span>, <span class="st">'n4'</span>, <span class="st">'a'</span>, <span class="st">'n4'</span>, <span class="st">'D'</span>, <span class="st">'a'</span>, <span class="st">'A'</span><span class="op">)</span>, , <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/edges_to_igraph.html">edges_to_igraph</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">g</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>fix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p></p>
<div id="htmlwidget-1cfb2d49c1719a029149" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1cfb2d49c1719a029149">{"x":{"data":[{"x":[1.25,0.25,null,-0.25,0.25],"y":[2,1,null,2,1],"text":["n3 -> a","n3 -> a",null,"n4 -> a","n4 -> a"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25,0.25],"y":[1,0],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,1.25,null,-0.25,-0.75],"y":[2,1,null,2,1],"text":["n3 -> C","n3 -> C",null,"n4 -> D","n4 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.25,null,0.5,1.25],"y":[3,2,null,3,2],"text":["n1 -> n4","n1 -> n4",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,1.25,-0.25,0.25],"y":[4,3,2,2,1],"text":["R","n1","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.125,0.875,0.75,1.25,0,-0.5,0.25],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1.5,1.5,0.5],"text":["","","","","","","","",""],"hovertext":["R -> O","R -> n1","n1 -> n4","n1 -> n3","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25],"y":[-0.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,-0.75],"y":[0.9,0.9],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(124,174,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.05,1.55],"tickmode":"array","ticktext":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"tickvals":[-1,-0.5,0,0.5,1,1.5],"categoryorder":"array","categoryarray":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.305,4.205],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,4],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b48b581ae":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b454ebcd":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b6344e1f3":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b3f4e4b6f":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b48b581ae","visdat":{"870b48b581ae":["function (y) ","x"],"870b454ebcd":["function (y) ","x"],"870b6344e1f3":["function (y) ","x"],"870b3f4e4b6f":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script> In contrast to the similar earlier example, there is now no <span class="math inline">\(f_4\)</span>-statistic with which we can estimate the length of an internal edge, because in this graph, no two population pairs form a clade with each other.
<p><em>ADMIXTOOLS 2</em> can tell us for any admixture graph what the unidentifiable edges are:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/unidentifiable_edges.html">unidentifiable_edges</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 8 x 3
##   from  to    type 
##   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
## 1 n4    a     admix
## 2 n3    a     admix
## 3 R     O     edge 
## 4 R     n1    edge 
## 5 n1    n4    edge 
## 6 n4    D     edge 
## 7 n1    n3    edge 
## 8 n3    C     edge</code></pre>
<p>In this graph, all of the drift lengths and admixture weights are unidentifiable.</p>
<p>To see what this means in practice, we simulate data under this admixture graph, and the test whether we can recover the correct parameters:</p>
<p>Not providing any additional simulation parameters will default to all drift edges being of equal length (except the one going to the outgroup), and all admixture nodes to be in 50/50 proportions.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_f2sim1</span> <span class="op">=</span> <span class="fu"><a href="../reference/f2_from_simulation.html">f2_from_simulation</a></span><span class="op">(</span><span class="va">g</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2sim1</span>, <span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">edges</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>fix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-36e2d59481556c6a0eca" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-36e2d59481556c6a0eca">{"x":{"data":[{"x":[1.25,0.25,null,-0.25,0.25],"y":[2,1,null,2,1],"text":["n3 -> a","n3 -> a",null,"n4 -> a","n4 -> a"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25,0.25],"y":[1,0],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,1.25,null,-0.25,-0.75],"y":[2,1,null,2,1],"text":["n3 -> C","n3 -> C",null,"n4 -> D","n4 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.25,null,0.5,1.25],"y":[3,2,null,3,2],"text":["n1 -> n4","n1 -> n4",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,1.25,-0.25,0.25],"y":[4,3,2,2,1],"text":["R","n1","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.125,0.875,0.75,1.25,0,-0.5,0.25],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1.5,1.5,0.5],"text":["116","116","38","38","49%","40","51%","40","90"],"hovertext":["R -> O","R -> n1","n1 -> n4","n1 -> n3","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25],"y":[-0.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,-0.75],"y":[0.9,0.9],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(124,174,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.05,1.55],"tickmode":"array","ticktext":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"tickvals":[-1,-0.5,0,0.5,1,1.5],"categoryorder":"array","categoryarray":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.305,4.205],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,4],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b6b0254f5":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b6617d7b5":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b2752e070":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b320ced3b":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b6b0254f5","visdat":{"870b6b0254f5":["function (y) ","x"],"870b6617d7b5":["function (y) ","x"],"870b2752e070":["function (y) ","x"],"870b320ced3b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>In this case, <code><a href="../reference/qpgraph.html">qpgraph()</a></code> seems to be able to recover most parameters very well (the weights are 50/50). However, this is because of the symmetry of this graph. Letâ€™s see what happens if we break the symmetry by setting the date of population <em>C</em> to zero:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dates</span> <span class="op">=</span> <span class="fu"><a href="../reference/pseudo_dates.html">pseudo_dates</a></span><span class="op">(</span><span class="va">g</span>, <span class="fl">1000</span><span class="op">)</span>
<span class="va">dates</span><span class="op">[</span><span class="st">'C'</span><span class="op">]</span> <span class="op">=</span> <span class="fl">0</span>
<span class="va">example_f2sim2</span> <span class="op">=</span> <span class="fu"><a href="../reference/f2_from_simulation.html">f2_from_simulation</a></span><span class="op">(</span><span class="va">g</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span>, time <span class="op">=</span> <span class="va">dates</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2sim2</span>, <span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">edges</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>fix <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-398a8ef6dea813cd5f8e" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-398a8ef6dea813cd5f8e">{"x":{"data":[{"x":[1.25,0.25,null,-0.25,0.25],"y":[2,1,null,2,1],"text":["n3 -> a","n3 -> a",null,"n4 -> a","n4 -> a"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25,0.25],"y":[1,0],"text":"a -> A","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,1.25,null,-0.25,-0.75],"y":[2,1,null,2,1],"text":["n3 -> C","n3 -> C",null,"n4 -> D","n4 -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,-0.25,null,0.5,1.25],"y":[3,2,null,3,2],"text":["n1 -> n4","n1 -> n4",null,"n1 -> n3","n1 -> n3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[4,3,null,4,3],"text":["R -> O","R -> O",null,"R -> n1","R -> n1"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,1.25,-0.25,0.25],"y":[4,3,2,2,1],"text":["R","n1","n3","n4","a"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.125,0.875,0.75,1.25,0,-0.5,0.25],"y":[3.5,3.5,2.5,2.5,1.5,1.5,1.5,1.5,0.5],"text":["106","106","23","67","26%","74","74%","47","84"],"hovertext":["R -> O","R -> n1","n1 -> n4","n1 -> n3","n3 -> a","n3 -> C","n4 -> a","n4 -> D","a -> A"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.25],"y":[-0.1],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.25,-0.75],"y":[0.9,0.9],"text":["C","D"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(124,174,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[2.9],"text":"O","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.05,1.55],"tickmode":"array","ticktext":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"tickvals":[-1,-0.5,0,0.5,1,1.5],"categoryorder":"array","categoryarray":["-1.0","-0.5","0.0","0.5","1.0","1.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-0.305,4.205],"tickmode":"array","ticktext":["0","1","2","3","4"],"tickvals":[0,1,2,3,4],"categoryorder":"array","categoryarray":["0","1","2","3","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b46ebb1f6":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b1bf0b1da":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b572c6d8a":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b25cbabbc":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b46ebb1f6","visdat":{"870b46ebb1f6":["function (y) ","x"],"870b1bf0b1da":["function (y) ","x"],"870b572c6d8a":["function (y) ","x"],"870b25cbabbc":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Now the estimated admixture weights are very far from the simulated 50/50 proportions. If we ran similar simulations for the graph which includes a fifth population <em>E</em> where all edges are identifiable, we would see that the admixture proportion estimates are not affected by changes to any other edges.</p>
<p>Unidentifiable edges can be highlighted when plotting a graph, here shown for a more complex example:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_igraph</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>highlight_unidentifiable <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-be3fd1639934e37744be" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-be3fd1639934e37744be">{"x":{"data":[{"x":[0,2],"y":[-1,-2],"text":"N3N5 -> N3N8","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,1],"y":[0,-1],"text":"N2N3 -> N2N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,0],"y":[1,0],"text":"N3N2 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[2,0],"text":"N3N3 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1,null,2,2],"y":[3,-1,null,3,-2],"text":["N2N2 -> N2N4","N2N2 -> N2N4",null,"N3N7 -> N3N8","N3N7 -> N3N8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2,2],"y":[-2,-3],"text":"N3N8 -> Russia_Ust_Ishim.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[-1,-2],"text":"N2N4 -> Mbuti.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[0,-1],"text":"N3N4 -> N3N5","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2],"y":[1,0,null,1,0],"text":["N2N1 -> Vindija.DG","N2N1 -> Vindija.DG",null,"N2N1 -> N2N3","N2N1 -> N2N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2,-2.5,null,-2,-1.5],"y":[2,1,null,2,1],"text":["N3N0 -> N2N1","N3N0 -> N2N1",null,"N3N0 -> N3N2","N3N0 -> N3N2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3,null,-2.5,-2,null,-0.5,-1,null,-0.5,0],"y":[3,2,null,3,2,null,3,2,null,3,2],"text":["N0N -> Altai_Neanderthal.DG","N0N -> Altai_Neanderthal.DG",null,"N0N -> N3N0","N0N -> N3N0",null,"N3N1 -> Denisova.DG","N3N1 -> Denisova.DG",null,"N3N1 -> N3N3","N3N1 -> N3N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,-2.5,null,-1.5,-0.5,null,1.5,1,null,1.5,2],"y":[4,3,null,4,3,null,4,3,null,4,3],"text":["N1N -> N0N","N1N -> N0N",null,"N1N -> N3N1","N1N -> N3N1",null,"N3N6 -> N2N2","N3N6 -> N2N2",null,"N3N6 -> N3N7","N3N6 -> N3N7"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1.5,null,0,1.5],"y":[5,4,null,5,4],"text":["N2N0 -> N1N","N2N0 -> N1N",null,"N2N0 -> N3N6","N2N0 -> N3N6"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[6,5,null,6,5],"text":["N4N -> N2N0","N4N -> N2N0",null,"N4N -> Switzerland_Bichon.SG","N4N -> Switzerland_Bichon.SG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[7,6,null,7,6],"text":["R -> Chimp.REF","R -> Chimp.REF",null,"R -> N4N","R -> N4N"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-2.5,-1.5,0,-2.5,1,-2,-0.5,0,1.5,2,0.5,1,-1.5,0,-2,0,2],"y":[7,3,4,5,1,-1,2,3,0,4,-2,6,3,1,-1,0,2,3],"text":["R","N0N","N1N","N2N0","N2N1","N2N4","N3N0","N3N1","N3N4","N3N6","N3N8","N4N","N2N2","N3N2","N3N5","N2N3","N3N3","N3N7"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.5,0,null,0,2,null,0,0,null,2,2],"y":[1,0,null,-1,-2,null,2,0,null,3,-2],"text":"","type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"rgba(255,0,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5,null,-2.5,-2,null,-1.5,-0.5,null,0,1.5,null,-2.5,-2,null,1,1,null,-2,-2.5,null,-2,-1.5,null,-0.5,-1,null,-0.5,0,null,0,0,null,1.5,1,null,1.5,2,null,2,2],"y":[7,6,null,7,6,null,3,2,null,4,3,null,5,4,null,1,0,null,-1,-2,null,2,1,null,2,1,null,3,2,null,3,2,null,0,-1,null,4,3,null,4,3,null,-2,-3],"text":"","type":"scatter","mode":"lines","line":{"width":3.77952755905512,"color":"rgba(255,0,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,-2.75,-2.25,-2,-1,-0.75,0.75,-2.75,-2.25,1,-2.25,-1.75,-0.75,-0.25,0,1.25,1.75,2,0.25,0.75,1,-0.75,1,-0.5,0,2],"y":[6.5,6.5,2.5,2.5,3.5,3.5,4.5,4.5,0.5,0.5,-1.5,1.5,1.5,2.5,2.5,-0.5,3.5,3.5,-2.5,5.5,5.5,1,0.5,-1.5,-0.5,1,0.5],"text":["","","","","","","","","","","","","","","","","","","","","","","","","","",""],"hovertext":["R -> Chimp.REF","R -> N4N","N0N -> Altai_Neanderthal.DG","N0N -> N3N0","N1N -> N0N","N1N -> N3N1","N2N0 -> N1N","N2N0 -> N3N6","N2N1 -> Vindija.DG","N2N1 -> N2N3","N2N4 -> Mbuti.DG","N3N0 -> N2N1","N3N0 -> N3N2","N3N1 -> Denisova.DG","N3N1 -> N3N3","N3N4 -> N3N5","N3N6 -> N2N2","N3N6 -> N3N7","N3N8 -> Russia_Ust_Ishim.DG","N4N -> N2N0","N4N -> Switzerland_Bichon.SG","N2N2 -> N2N4","N3N2 -> N3N4","N3N5 -> N3N8","N2N3 -> N2N4","N3N3 -> N3N4","N3N7 -> N3N8"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2],"y":[-3.1],"text":"Russia_Ust_Ishim.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-2.1],"text":"Mbuti.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(216,144,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3],"y":[-0.1],"text":"Vindija.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(57,182,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,-1],"y":[1.9,1.9],"text":["Altai_Neanderthal.DG","Denisova.DG"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[4.9],"text":"Switzerland_Bichon.SG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[5.9],"text":"Chimp.REF","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,98,188,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.6,2.6],"tickmode":"array","ticktext":["-2","0","2"],"tickvals":[-2,4.44089209850063e-16,2],"categoryorder":"array","categoryarray":["-2","0","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.605,7.505],"tickmode":"array","ticktext":["-2.5","0.0","2.5","5.0","7.5"],"tickvals":[-2.5,-4.44089209850063e-16,2.5,5,7.5],"categoryorder":"array","categoryarray":["-2.5","0.0","2.5","5.0","7.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b9f2793f":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870bdf61c33":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b18b55f6e":{"linetype":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{}},"870b2b8c3b6e":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b391c918":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b9f2793f","visdat":{"870b9f2793f":["function (y) ","x"],"870bdf61c33":["function (y) ","x"],"870b18b55f6e":["function (y) ","x"],"870b2b8c3b6e":["function (y) ","x"],"870b391c918":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>Two patterns in here are very common:</p>
<ol style="list-style-type: decimal">
<li><p>The two edges connected root are not identifiable. We can estimate how much drift has occurred on these two edges in combination, but it is not possible to attribute it to either of the two edges. The penalization terms that are used during the fitting of admixture graphs will ensure that both edges are always estimated to be of the same length.</p></li>
<li><p>The drift edges directly adjacent to a admixture edge can not all be estimated at the same time.</p></li>
</ol>
<p>If a graph has non-identifiable edges, it means that the estimated values for those edges should be treated with caution. However, the graph itself can still be a valid model. In particular, the fit of the graph (likelihood score or worst residual) will not be meaningfully affected by the presence of non-identifiable edges. And while unidentifiable edges</p>
<p>Even if all edges in a graph are identifiable, some estimated parameters may not be robust, for example if they rely on precise estimates of short edges in the graph. In this case, <a href="graphs.html#bootstrap-resampled-graph-fits-1">bootstrap confidence intervals</a> can be used to find out how robust the parameter estimates are.</p>
</div>
</div>
<div id="graphs-in-admixtools-2" class="section level2">
<h2 class="hasAnchor">
<a href="#graphs-in-admixtools-2" class="anchor"></a>Graphs in <em>ADMIXTOOLS 2</em>
</h2>
<p><em>ADMIXTOOLS 2</em> can read and write graphs in a number of different formats, including the format used by the original <em>ADMIXTOOLS</em> software and DOT format, but internally it uses only the following two representations of admixture graphs:</p>
<ol style="list-style-type: decimal">
<li>An edge list</li>
</ol>
<ul>
<li>This is either a matrix or a data frame where each edge is in a different row. The first column (<code>from</code>) contains the names of the source nodes, and the second column (<code>to</code>) contains the names of the target nodes. No distinction is made between admixture edges and drift edges, or between different types of nodes. Optionally, there are two more columns (<code>lower</code> and <code>upper</code>), which put constraints on the length of an edge. For admixture edges, these constraints should be between 0 and 1, and for drift edges they can range from 0 to infinity. No constraints are indicated by <code>NA</code>.</li>
</ul>
<ol start="2" style="list-style-type: decimal">
<li>An <code>igraph</code> graph object</li>
</ol>
<ul>
<li>This format is used for most operations that modify graphs, since the <a href="https://igraph.org/r/">igraph package</a> provides many useful functions for working with graphs. If not otherwise specified, functions that take graphs as input expect a graph in this format.</li>
</ul>
<p>To convert an admixture graph from one of these representations to the other, you can use the <code>igraph</code> function <code><a href="https://rdrr.io/pkg/igraph/man/graph_from_edgelist.html">igraph::graph_from_edgelist()</a></code> and <code><a href="https://rdrr.io/pkg/igraph/man/as_edgelist.html">igraph::as_edgelist()</a></code>.</p>
<div id="valid-graphs" class="section level3">
<h3 class="hasAnchor">
<a href="#valid-graphs" class="anchor"></a>Valid graphs</h3>
<p>A valid admixture graph in <em>ADMIXTOOLS 2</em> has to satisfy a number of conditions:</p>
<ol style="list-style-type: decimal">
<li>It has to be a <a href="https://en.wikipedia.org/wiki/Directed_acyclic_graph">directed, acyclic graph</a>
</li>
<li>All nodes have to be connected and there canâ€™t be any duplicated edges</li>
<li>No node should have more than two incoming or outgoing edges</li>
<li>Each terminal node should have only one incoming edge</li>
</ol>
<p>The function <code><a href="../reference/is_valid.html">is_valid()</a></code> tests whether a graph satisfies these conditions.</p>
<p>The third condition prohibits so-called multifurcations, or politomies. The function <code><a href="../reference/split_multifurcations.html">split_multifurcations()</a></code> turns a graph with multifurcations into a graph without multifurcations. At the same time, it constrains the newly introduced edges to be near zero, so that while fitting the graph, the multifurcations will be respected.</p>
<p>The last condition ensures that each terminal population can have drift which is shared with no other population.</p>
</div>
<div id="creating-and-loading-admixture-graphs" class="section level3">
<h3 class="hasAnchor">
<a href="#creating-and-loading-admixture-graphs" class="anchor"></a>Creating and loading admixture graphs</h3>
<p>The examples above show how admixture graphs can be created from scratch in R: You create a two column matrix where each row represents and edge, with the first column the origin, and the second column the destination.</p>
<p>You can also generate random graphs with your choice of population labels and a set number of admixture events:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pops</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/starwars.html">starwars</a></span><span class="op">$</span><span class="va">species</span><span class="op">)</span>
<span class="va">newgraph</span> <span class="op">=</span> <span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="va">pops</span>, numadmix <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span><span class="va">newgraph</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-28ad91f37c7cf314f771" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-28ad91f37c7cf314f771">{"x":{"data":[{"x":[0.884765625,0.384765625,null,0.884765625,1.384765625],"y":[-15,-18,null,-15,-16],"text":["Rrllrrrx -> admixg","Rrllrrrx -> admixg",null,"Rrllrrrx -> admixf","Rrllrrrx -> admixf"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(227,137,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-15)","legendgroup":"(admix,-15)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.365234375,0.384765625],"y":[-9,-13],"text":"admixwf -> admixm","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(153,168,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-9)","legendgroup":"(admix,-9)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.884765625,1.384765625,null,3.884765625,-0.365234375,null,1.884765625,-17.115234375],"y":[-7,-16,null,-7,-8,null,-7,-8],"text":["Rlllw -> admixf","Rlllw -> admixf",null,"Rllra -> admixw","Rllra -> admixw",null,"Rlllw -> admixy","Rlllw -> admixy"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(83,180,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-7)","legendgroup":"(admix,-7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.884765625,-2.615234375],"y":[-6,-7],"text":"Rlll -> admixz","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,184,35,1)","dash":"dot"},"hoveron":"points","name":"(admix,-6)","legendgroup":"(admix,-6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.115234375,-2.115234375],"y":[-1,-2],"text":"admixb -> admixp","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-13.115234375,-3.115234375,null,-12.115234375,-16.115234375],"y":[0,-1,null,0,-1],"text":["Rrlrllrrli -> admixb","Rrlrllrrli -> admixb",null,"Rrlrllrrlz -> admixs","Rrlrllrrlz -> admixs"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,188,217,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-12.615234375,0.384765625],"y":[2,-18],"text":"Rrlrllrr -> admixg","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,174,249,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-16.115234375,3.759765625,null,-5.615234375,-12.615234375,null,-8.615234375,0.384765625,null,3.759765625,3.759765625,null,-16.115234375,-16.115234375],"y":[4,-3,null,4,3,null,4,-13,null,4,-3,null,4,-1],"text":["Rrlrllln -> admix","Rrlrllln -> admix",null,"Rrlllrre -> admixd","Rrlllrre -> admixd",null,"admixa -> admixm","admixa -> admixm",null,"admixdt -> admix","admixdt -> admix",null,"Rrlrllln -> admixs","Rrlrllln -> admixs"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(118,152,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,4)","legendgroup":"(admix,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.115234375,-8.615234375,null,-3.115234375,-3.115234375,null,-17.865234375,-17.115234375,null,-16.115234375,3.759765625],"y":[5,4,null,5,-1,null,5,-8,null,5,4],"text":["Rrllrr -> admixa","Rrllrr -> admixa",null,"Rrllrr -> admixb","Rrllrr -> admixb",null,"Rrlrllld -> admixy","Rrlrllld -> admixy",null,"Rrlrlllh -> admixdt","Rrlrlllh -> admixdt"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(165,138,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,5)","legendgroup":"(admix,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-13.365234375,-12.615234375,null,-8.115234375,-1.365234375,null,-2.615234375,-2.115234375,null,-11.115234375,4.759765625],"y":[6,3,null,6,5,null,6,-2,null,6,5],"text":["Rrlrllr -> admixd","Rrlrllr -> admixd",null,"Rrllll -> admixu","Rrllll -> admixu",null,"Rrllrn -> admixp","Rrllrn -> admixp",null,"Rrlrlrr -> admixyl","Rrlrlrr -> admixyl"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,6)","legendgroup":"(admix,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-9.115234375,-8.615234375],"y":[8,4],"text":"Rrlru -> admixa","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(241,102,233,1)","dash":"dot"},"hoveron":"points","name":"(admix,8)","legendgroup":"(admix,8)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4.052734375,-2.615234375],"y":[9,-7],"text":"Rrlh -> admixz","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(251,97,215,1)","dash":"dot"},"hoveron":"points","name":"(admix,9)","legendgroup":"(admix,9)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.865234375,-1.365234375,null,-0.865234375,-0.365234375],"y":[10,5,null,10,-8],"text":["Rrld -> admixu","Rrld -> admixu",null,"Rrld -> admixw","Rrld -> admixw"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,193,1)","dash":"dot"},"hoveron":"points","name":"(admix,10)","legendgroup":"(admix,10)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.259765625,3.759765625,null,4.259765625,4.759765625],"y":[11,4,null,11,5],"text":["Rx -> admixdt","Rx -> admixdt",null,"Rx -> admixyl","Rx -> admixyl"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,102,168,1)","dash":"dot"},"hoveron":"points","name":"(admix,11)","legendgroup":"(admix,11)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.384765625,0.384765625],"y":[-18,-19],"text":"admixg -> Ewok","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-18)","legendgroup":"(normal,-18)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.384765625,1.384765625],"y":[-16,-17],"text":"admixf -> Kel Dor","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(239,127,70,1)","dash":"solid"},"hoveron":"points","name":"(normal,-16)","legendgroup":"(normal,-16)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.384765625,-0.115234375,null,0.384765625,0.884765625],"y":[-14,-15,null,-14,-15],"text":["Rrllrrr -> Rodian","Rrllrrr -> Rodian",null,"Rrllrrr -> Rrllrrrx","Rrllrrr -> Rrllrrrx"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(213,145,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-14)","legendgroup":"(normal,-14)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.384765625,0.384765625],"y":[-13,-14],"text":"admixm -> Rrllrrr","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(196,154,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-13)","legendgroup":"(normal,-13)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.115234375,-1.615234375,null,-1.115234375,-0.615234375],"y":[-10,-11,null,-10,-11],"text":["Rrr -> NA","Rrr -> NA",null,"Rrr -> Kaminoan","Rrr -> Kaminoan"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(176,161,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-10)","legendgroup":"(normal,-10)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.365234375,-1.115234375],"y":[-9,-10],"text":"admixwf -> Rrr","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(153,168,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-9)","legendgroup":"(normal,-9)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.365234375,-0.365234375,null,-17.115234375,-17.115234375],"y":[-8,-9,null,-8,-9],"text":["admixw -> admixwf","admixw -> admixwf",null,"admixy -> Neimodian","admixy -> Neimodian"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-8)","legendgroup":"(normal,-8)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.884765625,5.384765625,null,5.884765625,6.384765625,null,-2.615234375,-2.615234375,null,3.884765625,3.884765625],"y":[-7,-8,null,-7,-8,null,-7,-8,null,-7,-8],"text":["Rlrrr -> Quermian","Rlrrr -> Quermian",null,"Rlrrr -> Chagrian","Rlrrr -> Chagrian",null,"admixz -> Nautolan","admixz -> Nautolan",null,"Rllra -> Aleena","Rllra -> Aleena"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(83,180,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-7)","legendgroup":"(normal,-7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.384765625,2.884765625,null,5.384765625,4.884765625,null,5.384765625,5.884765625,null,1.884765625,1.884765625,null,3.384765625,3.884765625],"y":[-6,-7,null,-6,-7,null,-6,-7,null,-6,-7,null,-6,-7],"text":["Rllr -> Vulptereen","Rllr -> Vulptereen",null,"Rlrr -> Dug","Rlrr -> Dug",null,"Rlrr -> Rlrrr","Rlrr -> Rlrrr",null,"Rlll -> Rlllw","Rlll -> Rlllw",null,"Rllr -> Rllra","Rllr -> Rllra"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,184,35,1)","dash":"solid"},"hoveron":"points","name":"(normal,-6)","legendgroup":"(normal,-6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.634765625,1.884765625,null,2.634765625,3.384765625,null,4.884765625,4.384765625,null,4.884765625,5.384765625],"y":[-5,-6,null,-5,-6,null,-5,-6,null,-5,-6],"text":["Rll -> Rlll","Rll -> Rlll",null,"Rll -> Rllr","Rll -> Rllr",null,"Rlr -> Clawdite","Rlr -> Clawdite",null,"Rlr -> Rlrr","Rlr -> Rlrr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,188,86,1)","dash":"solid"},"hoveron":"points","name":"(normal,-5)","legendgroup":"(normal,-5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.759765625,2.634765625,null,3.759765625,4.884765625],"y":[-4,-5,null,-4,-5],"text":["Rl -> Rll","Rl -> Rll",null,"Rl -> Rlr","Rl -> Rlr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,119,1)","dash":"solid"},"hoveron":"points","name":"(normal,-4)","legendgroup":"(normal,-4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.759765625,3.759765625],"y":[-3,-4],"text":"admix -> Rl","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,192,148,1)","dash":"solid"},"hoveron":"points","name":"(normal,-3)","legendgroup":"(normal,-3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.115234375,-2.115234375],"y":[-2,-3],"text":"admixp -> Skakoan","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,193,173,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-13.115234375,-13.615234375,null,-13.115234375,-12.615234375,null,-16.115234375,-16.115234375],"y":[-1,-2,null,-1,-2,null,-1,-2],"text":["Rrlrllrrlr -> Human","Rrlrllrrlr -> Human",null,"Rrlrllrrlr -> Kaleesh","Rrlrllrrlr -> Kaleesh",null,"admixs -> Wookiee","admixs -> Wookiee"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-13.115234375,-13.115234375,null,-12.115234375,-12.115234375],"y":[0,-1,null,0,-1],"text":["Rrlrllrrli -> Rrlrllrrlr","Rrlrllrrli -> Rrlrllrrlr",null,"Rrlrllrrlz -> Zabrak","Rrlrllrrlz -> Zabrak"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,188,217,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-12.615234375,-13.115234375,null,-12.615234375,-12.115234375],"y":[1,0,null,1,0],"text":["Rrlrllrrl -> Rrlrllrrli","Rrlrllrrl -> Rrlrllrrli",null,"Rrlrllrrl -> Rrlrllrrlz","Rrlrllrrl -> Rrlrllrrlz"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,182,235,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-12.615234375,-12.615234375],"y":[2,1],"text":"Rrlrllrr -> Rrlrllrrl","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,174,249,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.615234375,-6.115234375,null,-5.615234375,-5.115234375,null,-12.615234375,-12.615234375],"y":[3,2,null,3,2,null,3,2],"text":["Rrlllrrl -> Cerean","Rrlllrrl -> Cerean",null,"Rrlllrrl -> Toydarian","Rrlllrrl -> Toydarian",null,"admixd -> Rrlrllrr","admixd -> Rrlrllrr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(6,164,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-18.615234375,-19.115234375,null,-18.615234375,-18.115234375,null,-14.615234375,-15.115234375,null,-14.615234375,-14.115234375,null,-5.615234375,-5.615234375],"y":[4,3,null,4,3,null,4,3,null,4,3,null,4,3],"text":["Rrlrllll -> Muun","Rrlrllll -> Muun",null,"Rrlrllll -> Trandoshan","Rrlrllll -> Trandoshan",null,"Rrlrllrll -> Pau'an","Rrlrllrll -> Pau'an",null,"Rrlrllrll -> Xexto","Rrlrllrll -> Xexto",null,"Rrlllrre -> Rrlllrrl","Rrlllrre -> Rrlllrrl"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(118,152,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-8.115234375,-8.615234375,null,-8.115234375,-7.615234375,null,-6.115234375,-6.615234375,null,-14.115234375,-14.615234375,null,-14.115234375,-13.615234375,null,-11.115234375,-11.615234375,null,-11.115234375,-10.615234375,null,-6.115234375,-5.615234375,null,-1.365234375,-1.365234375,null,-17.865234375,-18.615234375,null,-16.115234375,-16.115234375,null,4.759765625,4.759765625],"y":[5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4,null,5,4],"text":["Rrlllll -> Mirialan","Rrlllll -> Mirialan",null,"Rrlllll -> Sullustan","Rrlllll -> Sullustan",null,"Rrlllrr -> Tholothian","Rrlllrr -> Tholothian",null,"Rrlrllrl -> Rrlrllrll","Rrlrllrl -> Rrlrllrll",null,"Rrlrllrl -> Yoda's species","Rrlrllrl -> Yoda's species",null,"Rrlrlrrr -> Geonosian","Rrlrlrrr -> Geonosian",null,"Rrlrlrrr -> Iktotchi","Rrlrlrrr -> Iktotchi",null,"Rrlllrr -> Rrlllrre","Rrlllrr -> Rrlllrre",null,"admixu -> Mon Calamari","admixu -> Mon Calamari",null,"Rrlrllld -> Rrlrllll","Rrlrllld -> Rrlrllll",null,"Rrlrlllh -> Rrlrllln","Rrlrlllh -> Rrlrllln",null,"admixyl -> Droid","admixyl -> Droid"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(165,138,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-8.115234375,-8.115234375,null,-6.615234375,-7.115234375,null,-6.615234375,-6.115234375,null,-4.615234375,-5.115234375,null,-4.615234375,-4.115234375,null,-13.365234375,-14.115234375,null,-11.115234375,-11.115234375,null,-2.615234375,-3.115234375,null,-16.990234375,-17.865234375,null,-16.990234375,-16.115234375],"y":[6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5,null,6,5],"text":["Rrllll -> Rrlllll","Rrllll -> Rrlllll",null,"Rrlllr -> Gungan","Rrlllr -> Gungan",null,"Rrlllr -> Rrlllrr","Rrlllr -> Rrlllrr",null,"Rrllrl -> Togruta","Rrllrl -> Togruta",null,"Rrllrl -> Twi'lek","Rrllrl -> Twi'lek",null,"Rrlrllr -> Rrlrllrl","Rrlrllr -> Rrlrllrl",null,"Rrlrlrr -> Rrlrlrrr","Rrlrlrr -> Rrlrlrrr",null,"Rrllrn -> Rrllrr","Rrllrn -> Rrllrr",null,"Rrlrlll -> Rrlrllld","Rrlrlll -> Rrlrllld",null,"Rrlrlll -> Rrlrlllh","Rrlrlll -> Rrlrlllh"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.365234375,-8.115234375,null,-7.365234375,-6.615234375,null,-3.615234375,-4.615234375,null,-15.177734375,-16.990234375,null,-15.177734375,-13.365234375,null,-11.615234375,-12.115234375,null,-11.615234375,-11.115234375,null,-9.615234375,-10.115234375,null,-9.615234375,-9.115234375,null,-3.615234375,-2.615234375],"y":[7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6,null,7,6],"text":["Rrlll -> Rrllll","Rrlll -> Rrllll",null,"Rrlll -> Rrlllr","Rrlll -> Rrlllr",null,"Rrllr -> Rrllrl","Rrllr -> Rrllrl",null,"Rrlrll -> Rrlrlll","Rrlrll -> Rrlrlll",null,"Rrlrll -> Rrlrllr","Rrlrll -> Rrlrllr",null,"Rrlrlr -> Hutt","Rrlrlr -> Hutt",null,"Rrlrlr -> Rrlrlrr","Rrlrlr -> Rrlrlrr",null,"Rrlrr -> Besalisk","Rrlrr -> Besalisk",null,"Rrlrr -> Toong","Rrlrr -> Toong",null,"Rrllr -> Rrllrn","Rrllr -> Rrllrn"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(223,112,248,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-5.490234375,-7.365234375,null,-5.490234375,-3.615234375,null,-13.396484375,-15.177734375,null,-13.396484375,-11.615234375,null,-9.115234375,-9.615234375],"y":[8,7,null,8,7,null,8,7,null,8,7,null,8,7],"text":["Rrll -> Rrlll","Rrll -> Rrlll",null,"Rrll -> Rrllr","Rrll -> Rrllr",null,"Rrlrl -> Rrlrll","Rrlrl -> Rrlrll",null,"Rrlrl -> Rrlrlr","Rrlrl -> Rrlrlr",null,"Rrlru -> Rrlrr","Rrlru -> Rrlrr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(241,102,233,1)","dash":"solid"},"hoveron":"points","name":"(normal,8)","legendgroup":"(normal,8)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-11.255859375,-13.396484375,null,-11.255859375,-9.115234375,null,-4.052734375,-5.490234375],"y":[9,8,null,9,8,null,9,8],"text":["Rrlr -> Rrlrl","Rrlr -> Rrlrl",null,"Rrlr -> Rrlru","Rrlr -> Rrlru",null,"Rrlh -> Rrll","Rrlh -> Rrll"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(251,97,215,1)","dash":"solid"},"hoveron":"points","name":"(normal,9)","legendgroup":"(normal,9)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.654296875,-11.255859375,null,-7.654296875,-4.052734375],"y":[10,9,null,10,9],"text":["Rrl -> Rrlr","Rrl -> Rrlr",null,"Rrl -> Rrlh","Rrl -> Rrlh"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,193,1)","dash":"solid"},"hoveron":"points","name":"(normal,10)","legendgroup":"(normal,10)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4.259765625,-7.654296875,null,-4.259765625,-0.865234375],"y":[11,10,null,11,10],"text":["Rr -> Rrl","Rr -> Rrl",null,"Rr -> Rrld","Rr -> Rrld"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,102,168,1)","dash":"solid"},"hoveron":"points","name":"(normal,11)","legendgroup":"(normal,11)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-4.259765625,null,0,4.259765625],"y":[12,11,null,12,11],"text":["R -> Rr","R -> Rr",null,"R -> Rx","R -> Rx"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,108,145,1)","dash":"solid"},"hoveron":"points","name":"(normal,12)","legendgroup":"(normal,12)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.759765625,2.634765625,3.384765625,4.884765625,5.384765625,5.884765625,0,-4.259765625,-5.490234375,-7.365234375,-8.115234375,-8.115234375,-6.615234375,-5.615234375,-6.115234375,-3.615234375,-4.615234375,0.384765625,-7.654296875,-11.255859375,-13.396484375,-15.177734375,-18.615234375,-13.365234375,-14.115234375,-14.615234375,-12.615234375,-13.115234375,-11.615234375,-11.115234375,-11.115234375,-9.615234375,-1.115234375,3.759765625,-16.115234375,-9.115234375,-3.115234375,-12.615234375,-13.115234375,-5.615234375,-12.615234375,0.384765625,0.884765625,-4.052734375,1.884765625,-2.615234375,-1.365234375,-0.865234375,1.384765625,1.884765625,-2.615234375,-3.115234375,-2.115234375,3.884765625,-0.365234375,-0.365234375,-8.615234375,0.384765625,-16.990234375,-17.865234375,-17.115234375,-16.115234375,3.759765625,-12.115234375,-16.115234375,4.259765625,4.759765625],"y":[-4,-5,-6,-5,-6,-7,12,11,8,7,6,5,6,3,5,7,6,-14,10,9,8,7,4,6,5,4,2,-1,7,6,5,7,-10,-3,4,8,5,1,0,4,3,-18,-15,9,-6,-7,5,10,-16,-7,6,-1,-2,-7,-8,-9,4,-13,6,5,-8,5,4,0,-1,11,5],"text":["Rl","Rll","Rllr","Rlr","Rlrr","Rlrrr","R","Rr","Rrll","Rrlll","Rrllll","Rrlllll","Rrlllr","Rrlllrrl","Rrlllrr","Rrllr","Rrllrl","Rrllrrr","Rrl","Rrlr","Rrlrl","Rrlrll","Rrlrllll","Rrlrllr","Rrlrllrl","Rrlrllrll","Rrlrllrr","Rrlrllrrlr","Rrlrlr","Rrlrlrr","Rrlrlrrr","Rrlrr","Rrr","admix","Rrlrllln","Rrlru","Rrllrr","Rrlrllrrl","Rrlrllrrli","Rrlllrre","admixd","admixg","Rrllrrrx","Rrlh","Rlll","admixz","admixu","Rrld","admixf","Rlllw","Rrllrn","admixb","admixp","Rllra","admixw","admixwf","admixa","admixm","Rrlrlll","Rrlrllld","admixy","Rrlrlllh","admixdt","Rrlrllrrlz","admixs","Rx","admixyl"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[3.197265625,2.259765625,3.009765625,3.134765625,4.322265625,4.634765625,5.134765625,5.134765625,5.634765625,5.634765625,6.134765625,-2.1298828125,-5.95703125,-6.427734375,-7.740234375,-8.115234375,-8.365234375,-7.865234375,-6.990234375,-6.865234375,-6.365234375,-5.865234375,-5.365234375,-6.365234375,-4.552734375,-4.115234375,-4.865234375,-4.365234375,0.134765625,-9.455078125,-12.326171875,-14.287109375,-16.083984375,-18.865234375,-18.365234375,-14.271484375,-13.740234375,-14.365234375,-14.865234375,-14.365234375,-13.865234375,-12.615234375,-13.365234375,-12.865234375,-12.505859375,-11.865234375,-11.365234375,-11.115234375,-11.365234375,-10.865234375,-9.865234375,-9.365234375,-1.365234375,-0.865234375,3.759765625,-6.177734375,-10.185546875,-9.365234375,-5.865234375,-8.865234375,-12.865234375,-13.115234375,-3.115234375,-8.115234375,-5.865234375,-5.615234375,-12.990234375,-12.615234375,-9.115234375,0.634765625,-6.115234375,0.384765625,0.634765625,-5.853515625,-4.771484375,-0.365234375,-2.615234375,-3.333984375,-2.5625,-4.740234375,-1.365234375,-1.115234375,1.884765625,1.134765625,1.384765625,1.634765625,-3.115234375,-2.865234375,-2.615234375,-2.115234375,-2.365234375,3.634765625,3.884765625,-0.615234375,1.759765625,-0.365234375,-0.740234375,-4.115234375,0.384765625,0.009765625,-17.427734375,-18.240234375,-7.615234375,-17.115234375,-17.490234375,-16.552734375,-16.115234375,3.759765625,-6.177734375,-12.365234375,-12.115234375,-16.115234375,-16.115234375,-14.115234375,2.1298828125,4.009765625,-3.177734375,4.759765625,4.509765625],"y":[-4.5,-5.5,-5.5,-6.5,-4.5,-5.5,-5.5,-6.5,-6.5,-7.5,-7.5,11.5,10.5,7.5,6.5,5.5,4.5,4.5,6.5,5.5,5.5,2.5,2.5,4.5,7.5,6.5,5.5,5.5,-14.5,9.5,8.5,7.5,6.5,3.5,3.5,6.5,5.5,4.5,3.5,3.5,4.5,1.5,-1.5,-1.5,7.5,6.5,6.5,5.5,4.5,4.5,6.5,6.5,-10.5,-10.5,-3.5,0.5,8.5,7.5,4.5,6,0.5,-0.5,2,-0.5,4.5,3.5,4.5,2.5,3.5,-14.5,-8,-18.5,-16.5,9.5,8.5,-6.5,-7.5,1,10.5,5.5,4.5,7.5,-6.5,-15.5,-16.5,-11.5,6.5,5.5,-1.5,-2.5,2,-6.5,-7.5,1,-7.5,-8.5,-9.5,-4.5,-13.5,-11,5.5,4.5,-7.5,-8.5,-1.5,5.5,4.5,0.5,4.5,0.5,-0.5,1.5,-1.5,-0.5,11.5,7.5,5.5,4.5,8],"text":["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],"hovertext":["Rl -> Rll","Rll -> Rlll","Rll -> Rllr","Rllr -> Vulptereen","Rl -> Rlr","Rlr -> Clawdite","Rlr -> Rlrr","Rlrr -> Dug","Rlrr -> Rlrrr","Rlrrr -> Quermian","Rlrrr -> Chagrian","R -> Rr","Rr -> Rrl","Rrll -> Rrlll","Rrlll -> Rrllll","Rrllll -> Rrlllll","Rrlllll -> Mirialan","Rrlllll -> Sullustan","Rrlll -> Rrlllr","Rrlllr -> Gungan","Rrlllr -> Rrlllrr","Rrlllrrl -> Cerean","Rrlllrrl -> Toydarian","Rrlllrr -> Tholothian","Rrll -> Rrllr","Rrllr -> Rrllrl","Rrllrl -> Togruta","Rrllrl -> Twi'lek","Rrllrrr -> Rodian","Rrl -> Rrlr","Rrlr -> Rrlrl","Rrlrl -> Rrlrll","Rrlrll -> Rrlrlll","Rrlrllll -> Muun","Rrlrllll -> Trandoshan","Rrlrll -> Rrlrllr","Rrlrllr -> Rrlrllrl","Rrlrllrl -> Rrlrllrll","Rrlrllrll -> Pau'an","Rrlrllrll -> Xexto","Rrlrllrl -> Yoda's species","Rrlrllrr -> Rrlrllrrl","Rrlrllrrlr -> Human","Rrlrllrrlr -> Kaleesh","Rrlrl -> Rrlrlr","Rrlrlr -> Hutt","Rrlrlr -> Rrlrlrr","Rrlrlrr -> Rrlrlrrr","Rrlrlrrr -> Geonosian","Rrlrlrrr -> Iktotchi","Rrlrr -> Besalisk","Rrlrr -> Toong","Rrr -> NA","Rrr -> Kaminoan","admix -> Rl","Rrlrllln -> admix","Rrlr -> Rrlru","Rrlru -> Rrlrr","Rrllrr -> admixa","Rrlru -> admixa","Rrlrllrrl -> Rrlrllrrli","Rrlrllrrli -> Rrlrllrrlr","Rrllrr -> admixb","Rrlrllrrli -> admixb","Rrlllrr -> Rrlllrre","Rrlllrre -> Rrlllrrl","Rrlrllr -> admixd","admixd -> Rrlrllrr","Rrlllrre -> admixd","Rrllrrr -> Rrllrrrx","Rrlrllrr -> admixg","admixg -> Ewok","Rrllrrrx -> admixg","Rrl -> Rrlh","Rrlh -> Rrll","Rlll -> admixz","admixz -> Nautolan","Rrlh -> admixz","Rr -> Rrld","Rrllll -> admixu","admixu -> Mon Calamari","Rrld -> admixu","Rlll -> Rlllw","Rrllrrrx -> admixf","admixf -> Kel Dor","Rlllw -> admixf","Rrllr -> Rrllrn","Rrllrn -> Rrllrr","admixb -> admixp","admixp -> Skakoan","Rrllrn -> admixp","Rllr -> Rllra","Rllra -> Aleena","Rrld -> admixw","Rllra -> admixw","admixw -> admixwf","admixwf -> Rrr","admixa -> admixm","admixm -> Rrllrrr","admixwf -> admixm","Rrlrlll -> Rrlrllld","Rrlrllld -> Rrlrllll","Rlllw -> admixy","admixy -> Neimodian","Rrlrllld -> admixy","Rrlrlll -> Rrlrlllh","Rrlrlllh -> Rrlrllln","admixdt -> admix","Rrlrlllh -> admixdt","Rrlrllrrl -> Rrlrllrrlz","Rrlrllrrlz -> Zabrak","Rrlrllln -> admixs","admixs -> Wookiee","Rrlrllrrlz -> admixs","R -> Rx","Rx -> admixdt","Rrlrlrr -> admixyl","admixyl -> Droid","Rx -> admixyl"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.384765625],"y":[-19.1],"text":"Ewok","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-18,1)","legendgroup":"(-18,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.384765625],"y":[-17.1],"text":"Kel Dor","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(239,127,70,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-16,1)","legendgroup":"(-16,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.115234375],"y":[-15.1],"text":"Rodian","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(213,145,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-14,1)","legendgroup":"(-14,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.615234375,-0.615234375],"y":[-11.1,-11.1],"text":["NA","Kaminoan"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(176,161,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-10,1)","legendgroup":"(-10,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-17.115234375],"y":[-9.1],"text":"Neimodian","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(124,174,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-8,1)","legendgroup":"(-8,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[5.384765625,6.384765625,-2.615234375,3.884765625],"y":[-8.1,-8.1,-8.1,-8.1],"text":["Quermian","Chagrian","Nautolan","Aleena"],"hovertext":["","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(83,180,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-7,1)","legendgroup":"(-7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[2.884765625,4.884765625],"y":[-7.1,-7.1],"text":["Vulptereen","Dug"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,184,35,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-6,1)","legendgroup":"(-6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[4.384765625],"y":[-6.1],"text":"Clawdite","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,188,86,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-5,1)","legendgroup":"(-5,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.115234375],"y":[-3.1],"text":"Skakoan","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,193,173,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-13.615234375,-12.615234375,-16.115234375],"y":[-2.1,-2.1,-2.1],"text":["Human","Kaleesh","Wookiee"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-12.115234375],"y":[-1.1],"text":"Zabrak","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,188,217,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-6.115234375,-5.115234375],"y":[1.9,1.9],"text":["Cerean","Toydarian"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(6,164,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-19.115234375,-18.115234375,-15.115234375,-14.115234375],"y":[2.9,2.9,2.9,2.9],"text":["Muun","Trandoshan","Pau'an","Xexto"],"hovertext":["","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(118,152,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-8.615234375,-7.615234375,-6.615234375,-13.615234375,-11.615234375,-10.615234375,-1.365234375,4.759765625],"y":[3.9,3.9,3.9,3.9,3.9,3.9,3.9,3.9],"text":["Mirialan","Sullustan","Tholothian","Yoda's species","Geonosian","Iktotchi","Mon Calamari","Droid"],"hovertext":["","","","","","","",""],"textfont":{"size":9.4488188976378,"color":"rgba(165,138,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(5,1)","legendgroup":"(5,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-7.115234375,-5.115234375,-4.115234375],"y":[4.9,4.9,4.9],"text":["Gungan","Togruta","Twi'lek"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-12.115234375,-10.115234375,-9.115234375],"y":[5.9,5.9,5.9],"text":["Hutt","Besalisk","Toong"],"hovertext":["","",""],"textfont":{"size":9.4488188976378,"color":"rgba(223,112,248,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-21.765234375,9.034765625],"tickmode":"array","ticktext":["-20","-10","0"],"tickvals":[-20,-10,0],"categoryorder":"array","categoryarray":["-20","-10","0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-20.655,13.555],"tickmode":"array","ticktext":["-20","-10","0","10"],"tickvals":[-20,-10,0,10],"categoryorder":"array","categoryarray":["-20","-10","0","10"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b5e2ff95a":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b1f9bb405":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b2747c479":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b58b3f814":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b5e2ff95a","visdat":{"870b5e2ff95a":["function (y) ","x"],"870b1f9bb405":["function (y) ","x"],"870b2747c479":["function (y) ","x"],"870b58b3f814":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><p>To load an existing graph, use <code><a href="../reference/parse_qpgraph_graphfile.html">parse_qpgraph_graphfile()</a></code> if itâ€™s in the original <em>ADMIXTOOLS</em> format, <code>read_table2()</code> if itâ€™s an edge list, or <code><a href="https://rdrr.io/r/base/readRDS.html">readRDS()</a></code> if it was saved in R using <code><a href="https://rdrr.io/r/base/readRDS.html">saveRDS()</a></code>.</p>
</div>
<div id="modifying-admixture-graphs" class="section level3">
<h3 class="hasAnchor">
<a href="#modifying-admixture-graphs" class="anchor"></a>Modifying admixture graphs</h3>
<p>Admixture graphs can be modified using the following functions:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">insert_edge</span><span class="op">(</span><span class="va">example_igraph</span>, from <span class="op">=</span> <span class="st">"N2N1|Vindija.DG"</span>, to <span class="op">=</span> <span class="st">"N3N1|Denisova.DG"</span><span class="op">)</span>
<span class="fu"><a href="../reference/delete_admix.html">delete_admix</a></span><span class="op">(</span><span class="va">example_igraph</span>, from <span class="op">=</span> <span class="st">"N2N2"</span>, to <span class="op">=</span> <span class="st">"N2N4"</span><span class="op">)</span>
<span class="fu"><a href="../reference/insert_leaf.html">insert_leaf</a></span><span class="op">(</span><span class="va">example_igraph</span>, <span class="st">"newpop"</span>, from <span class="op">=</span> <span class="st">"N4N"</span>, to <span class="op">=</span> <span class="st">"Switzerland_Bichon.SG"</span><span class="op">)</span>
<span class="fu"><a href="../reference/delete_leaf.html">delete_leaf</a></span><span class="op">(</span><span class="va">example_igraph</span>, <span class="st">"Switzerland_Bichon.SG"</span><span class="op">)</span></code></pre></div>
<p>But itâ€™s probably easier to modify a graph interactively using the <em>ADMIXTOOLS 2</em> GUI.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/run_shiny_admixtools.html">run_shiny_admixtools</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Below you can see how a new admixture edge is added to a graph:</p>
<p><img src="../man/figures/shinyapp1.gif"></p>
</div>
<div id="semi-automated-graph-exploration" class="section level3">
<h3 class="hasAnchor">
<a href="#semi-automated-graph-exploration" class="anchor"></a>Semi-automated graph exploration</h3>
<p>Rather than modifying admixture graphs manually and only testing a small number of models, you can start with a graph and let <em>ADMIXTOOLS 2</em> generate and evaluate graphs for you.</p>
<p>The following functions take a graph and return lists of new, similar graphs:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_plusone.html">graph_plusone</a></span><span class="op">(</span><span class="va">example_graph</span><span class="op">)</span>
<span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_minusone.html">graph_minusone</a></span><span class="op">(</span><span class="va">example_graph</span><span class="op">)</span>
<span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_minusplus.html">graph_minusplus</a></span><span class="op">(</span><span class="va">example_graph</span><span class="op">)</span>
<span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_flipadmix.html">graph_flipadmix</a></span><span class="op">(</span><span class="va">example_graph</span><span class="op">)</span>
<span class="va">newgraphs</span> <span class="op">=</span> <span class="fu"><a href="../reference/graph_splittrees.html">graph_splittrees</a></span><span class="op">(</span><span class="va">example_graph</span><span class="op">)</span></code></pre></div>
<p>To evaluate the new graphs, type:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newgraphs</span> <span class="op">%&gt;%</span>
  <span class="va">rowwise</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">graph</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest_wider</span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">score</span><span class="op">)</span></code></pre></div>
<p>or, if you want to <a href="parallel.html">parallelize</a> this,</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">newgraphs</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>res <span class="op">=</span> <span class="fu">furrr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/furrr/man/future_map.html">future_map</a></span><span class="op">(</span><span class="va">graph</span>, <span class="op">~</span><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">unnest_wider</span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">arrange</span><span class="op">(</span><span class="va">score</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 8 x 7
##    name graph   edges          score f2            f3            ppinv          
##   &lt;int&gt; &lt;list&gt;  &lt;list&gt;         &lt;dbl&gt; &lt;list&gt;        &lt;list&gt;        &lt;list&gt;         
## 1     6 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 19653. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 2     8 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 19653. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 3     2 &lt;igrapâ€¦ &lt;tibble [18 â€¦ 26962. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 4     4 &lt;igrapâ€¦ &lt;tibble [18 â€¦ 53066. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 5     3 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 62301. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 6     5 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 64137. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 7     7 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 64137. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦
## 8     1 &lt;igrapâ€¦ &lt;tibble [12 â€¦ 64137. &lt;tibble [21 â€¦ &lt;tibble [21 â€¦ &lt;dbl[,21] [21 â€¦</code></pre>
</div>
</div>
<div id="fitting-a-single-admixture-graph" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-a-single-admixture-graph" class="anchor"></a>Fitting a single admixture graph</h2>
<div id="edge-weight-optimization" class="section level3">
<h3 class="hasAnchor">
<a href="#edge-weight-optimization" class="anchor"></a>Edge weight optimization</h3>
<p><code><a href="../reference/qpgraph.html">qpgraph()</a></code> tries to find the admixture- and drift-edge weights for a given graph topology which are most consistent with the observed <span class="math inline">\(f_3\)</span>-statistics. The optimization of admixture weights requires initial values for these weights. Occasionally, the initial values have an effect on the final weight estimates because the optimization gets stuck in a local optimum. To avoid this, the <code><a href="../reference/qpgraph.html">qpgraph()</a></code> weight optimization is repeated with different randomly chosen combinations of starting weights, and the final likelihood score represents the best score out of all tries. By default, 10 different random combinations of starting weights are evaluated. Decreasing this number can speed up <code><a href="../reference/qpgraph.html">qpgraph()</a></code>, and increasing it can reduce the risk of missing the global optimum.</p>
<p>To get a better sense of how stable the edge weight optimization is, it makes sense to inspect the <code>opt</code> output of <code><a href="../reference/qpgraph.html">qpgraph()</a></code>. This data frame contains all random initial weight combinations, as well as the optimized weights, final scores (<code>value</code>) and additional information about the optimization generated by the <code><a href="https://rdrr.io/r/stats/optim.html">optim()</a></code> function.</p>
<p>In this example, the optimization is very stable, and the initial values do not affect the estimated weights or the score:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_winner</span><span class="op">$</span><span class="va">opt</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>##            X1        X2        X3        p1        p2        p3    value fevals
## 1  0.07096771 0.5570287 0.2760519 0.3977308 0.6825699 0.2061932 4.001206     51
## 2  0.52067226 0.2790785 0.2311112 0.3977306 0.6825697 0.2061933 4.001206     13
## 3  0.04703453 0.8426236 0.1589736 0.3977306 0.6825697 0.2061933 4.001206     13
## 4  0.23402753 0.6483083 0.9764668 0.3977306 0.6825697 0.2061933 4.001206     15
## 5  0.04859723 0.2443325 0.6712799 0.3977306 0.6825697 0.2061934 4.001206     51
## 6  0.64079765 0.6574552 0.9912520 0.3977306 0.6825697 0.2061933 4.001206     12
## 7  0.97251921 0.1531614 0.2553865 0.3977306 0.6825697 0.2061933 4.001206     30
## 8  0.09519617 0.7965518 0.7882128 0.3977306 0.6825697 0.2061933 4.001206     15
## 9  0.99480784 0.2439424 0.1490095 0.3977306 0.6825697 0.2061933 4.001206     14
## 10 0.61758018 0.6886023 0.3912047 0.3977306 0.6825696 0.2061933 4.001206     10
##    gevals convergence
## 1      51          52
## 2      13           0
## 3      13           0
## 4      15           0
## 5      51          52
## 6      12           0
## 7      30           0
## 8      15           0
## 9      14           0
## 10     10           0</code></pre>
<p>Here, the optimization depends a bit more on the initial weights:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">example_qpgraph_ref_results</span><span class="op">$</span><span class="va">opt</span></code></pre></div>
<pre><code>##       i.N2N4     i.N3N4      i.N3N8 e.N2N4 e.N3N4     e.N3N8    value fevals
## 1  0.7616225 0.34647487 0.412249106      0      0 0.00000000 19652.54      2
## 2  0.1795198 0.20519471 0.009456659      0      1 0.05947510 19219.98     27
## 3  0.5789027 0.75595585 0.173031624      0      1 0.05947507 19219.98     15
## 4  0.4161319 0.21328007 0.975338531      0      1 0.05947507 19219.98      7
## 5  0.9409036 0.96037222 0.944441426      0      0 0.00000000 19652.54      2
## 6  0.3354566 0.62811808 0.446383684      0      0 0.00000000 19652.54      2
## 7  0.6299324 0.09815806 0.213384736      0      0 0.00000000 19652.54      2
## 8  0.2220927 0.04966934 0.616733615      0      1 0.05947507 19219.98      7
## 9  0.8463281 0.83502828 0.372245495      0      0 0.00000000 19652.54      2
## 10 0.6660239 0.97142558 0.848605360      0      0 0.00000000 19652.54      2
##    gevals convergence
## 1       2           0
## 2      27           0
## 3      15           0
## 4       7           0
## 5       2           0
## 6       2           0
## 7       2           0
## 8       7           0
## 9       2           0
## 10      2           0</code></pre>
<p>The range of estimated weights for each admixture edge is also stored in the <code>low</code> and <code>high</code> columns of the <code>edges</code> data frame returned by <code><a href="../reference/qpgraph.html">qpgraph()</a></code>. The <code><a href="../reference/plot_comparison.html">plot_comparison()</a></code> function visualizes that information with gray error bars.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_comparison.html">plot_comparison</a></span><span class="op">(</span><span class="va">example_qpgraph_ref_results</span>, <span class="va">example_qpgraph_ref_results</span><span class="op">)</span></code></pre></div>
<p><img src="graphs_files/figure-html/unnamed-chunk-27-1.png" width="700"></p>
<!-- ### Precomputed $f_3$-statistics -->
<!-- The first steps in `qpgraph()` are computing $f_3$-statistics from $f_2$-statistics, and computing the inverse of the $f_3$-statistic covariance matrix. When many graphs are evaluated for the same populations, it can be faster to run these steps only once and pass $f_3$-statistics and the inverse of the covariance matrix to the `qpgraph()` function. That is the purpose of the `f3precomp` and `ppinv` arguments. The `f3precomp` argument expects a list with $f_3$-statistics and the inverse of the covariance matrix. It is used for example in `find_graphs()`. -->
<!-- The `ppinv` argument expects only the inverse of the covariance matrix, while $f_3$-statistics will be computed inside `qpgraph()`. This is used in `qpgraph_resample_multi()` to use an inverse covariance matrix computed on a different set of SNPs. -->
</div>
<div id="regularization-terms" class="section level3">
<h3 class="hasAnchor">
<a href="#regularization-terms" class="anchor"></a>Regularization terms</h3>
<p>There are two regularization terms used in <em>qpGraph</em>, which make matrix inversions more stable.</p>
<p>One is called <code>diag</code> and is added to the covariance matrix of fitted branch lengths (after multiplying it by the mean of the diagonal elements). It is the same as the <code>diag</code> parameter in the original <em>qpGraph</em> program and defaults to 10<sup>-4</sup>. Increasing <code>diag</code> will shift the likelihood scores to be <em>further away from zero</em>. This regularization term ensures that edge weights will be evenly distributed across a set of edges whose weights could otherwise not be determined unambiguously. (As is often the case with the two edges originating in the root node.)</p>
<p>The other regularization term is added to the diagonal elements of the <span class="math inline">\(f_3\)</span> covariance matrix (after multiplying it by the mean of the diagonal elements). It is called <code>diag_f3</code> and defaults to 10<sup>-5</sup>. In the original <em>qpGraph</em> program it is fixed at that value. Increasing this factor has a small effect on admixture weights and branch lengths, and will shift the likelihood scores to be <em>closer to zero</em>.</p>
<p>The regularization terms affect the likelihood score, so they should be kept constant whenever fits of different graphs are compared to each other.</p>
</div>
<div id="edge-constraints" class="section level3">
<h3 class="hasAnchor">
<a href="#edge-constraints" class="anchor"></a>Edge constraints</h3>
</div>
</div>
<div id="automatic-graph-optimization" class="section level2">
<h2 class="hasAnchor">
<a href="#automatic-graph-optimization" class="anchor"></a>Automatic graph optimization</h2>
<p>An advantage of being able to quickly evaluate a single model using precomputed <em>f</em>-statistics is that we can evaluate many different graphs in order to find graph topologies with good fits.</p>
<p><br></p>
<p>The function <code><a href="../reference/find_graphs.html">find_graphs()</a></code> attempts to automatically find admixture graphs that are compatible with the observed f-statistics. It generates and evaluates <code>numgraphs</code> admixture graphs in <code>numgen</code> generations, and in each generation selects and modifies the best graphs.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">opt_results</span> <span class="op">=</span> <span class="fu"><a href="../reference/find_graphs.html">find_graphs</a></span><span class="op">(</span><span class="va">f2_blocks</span>, <span class="va">pops</span>, outpop <span class="op">=</span> <span class="va">pops</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, numrep <span class="op">=</span> <span class="fl">200</span>,
                          numgraphs <span class="op">=</span> <span class="fl">100</span>, numgen <span class="op">=</span> <span class="fl">20</span>, numsel <span class="op">=</span> <span class="fl">5</span>, numadmix <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>The output of <code><a href="../reference/find_graphs.html">find_graphs()</a></code> (<code>opt_results</code>) will be a <a href="https://r4ds.had.co.nz/many-models.html#nested-data">nested data frame</a>, with each tested model in one line. Some columns in this data frame, like <code>score</code>, are regular numbers, while other columns, like <code>edges</code>, are <em>list-columns</em> where each element is another data frame.</p>
<p><br></p>
<p>The following commands will extract the best fitting model overall, and the best fitting model from each independent repeat.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">winner</span> <span class="op">=</span> <span class="va">opt_results</span> <span class="op">%&gt;%</span> <span class="fu">top_n</span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span><span class="op">)</span>
<span class="va">winners</span> <span class="op">=</span> <span class="va">opt_results</span> <span class="op">%&gt;%</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">run</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">top_n</span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span><span class="op">(</span><span class="va">score</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ungroup</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">winner</span><span class="op">$</span><span class="va">score</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 4.009599</code></pre>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/plot_graph.html">plot_graph</a></span><span class="op">(</span><span class="va">winner</span><span class="op">$</span><span class="va">edges</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="graphs_files/figure-html/unnamed-chunk-31-1.png" width="864" style="display: block; margin: auto;"></p>
<p>It can take a while until <code><a href="../reference/find_graphs.html">find_graphs()</a></code> finds graphs with good fits. To speed it up, it can be <a href="parallel.html">parallelized</a>.</p>
<p><br></p>
<div id="constraining-the-search-space" class="section level3">
<h3 class="hasAnchor">
<a href="#constraining-the-search-space" class="anchor"></a>Constraining the search space</h3>
</div>
</div>
<div id="comparing-the-fits-of-different-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-the-fits-of-different-graphs" class="anchor"></a>Comparing the fits of different graphs</h2>
<p>If two different graphs model the same populations and the second graph has a better likelihood score than the first one, it suggests that the second graph is a better representation of the actual demographic history. Thatâ€™s generally true, but there are two complications:</p>
<ol style="list-style-type: decimal">
<li><p>If the second graph is more complex (i.e.Â if it has more admixture events), it has more degrees of freedom and thus an unfair advantage over the first one. It might get a better score even if the simpler graph is closer to the true demographic history.</p></li>
<li><p>It is possible that the difference in scores is due to chance, and not because one of the two models really fits the data better. What if we had picked different samples from each population? Or what if we had picked different SNPs? Would the second model still be preferred over the first one?</p></li>
</ol>
<p><em>ADMIXTOOLS 2</em> solves the first problem by computing out-of-sample scores, and the second problem by computing the fit of a graph using bootstrap-resampled SNP blocks.</p>
<div id="out-of-sample-scores" class="section level3">
<h3 class="hasAnchor">
<a href="#out-of-sample-scores" class="anchor"></a>Out-of-sample scores</h3>
<p><em>qpGraph</em> likelihood scores <span class="math inline">\(S\)</span> are computed by comparing estimated f3-statistics <span class="math inline">\(g\)</span> to fitted f3-statistics <span class="math inline">\(f\)</span> - those that we would expect to observe under a given admixture graph. The difference between estimated and fitted f3-statistics, the residuals, are adjusted by the inverse covariance matrix of f3-statistics <span class="math inline">\(Q\)</span>, to get the likelihood score. If this covariance matrix was the identity matrix, the scores would just be the squared sum of residuals.</p>
<p><span class="math display">\[S = -\frac{1}{2} (g - f)' Q^{-1} (g - f)\]</span></p>
<p>Under this definition likelihood scores are actually negative, but usually the minus sign is dropped and positive scores are reported instead.</p>
<p>In fitting edge weights, <em>qpGraph</em> maximizes this likelihood score (bringing it closer to 0). To avoid overfitting, we can compute a new score <span class="math inline">\(S'\)</span> after fitting the model, using SNPs (or SNP blocks) which havenâ€™t been used for fitting the model:</p>
<p><span class="math display">\[S' = -\frac{1}{2} (g_{train} - f_{test})' Q^{-1} (g_{train} - f_{test})\]</span></p>
<p>These scores tend to be further away from zero, but they allow us to fairly compare models of different complexity to each other.</p>
<p>In <em>ADMIXTOOLS 2</em>, you can compute out-of-sample scores by providing the <code><a href="../reference/qpgraph.html">qpgraph()</a></code> function with an <code>f2_blocks_test</code> argument.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">nblocks</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">example_f2_blocks</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>
<span class="va">train</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">nblocks</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="va">nblocks</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">example_f2_blocks</span><span class="op">[</span>,,<span class="va">train</span><span class="op">]</span>, <span class="va">example_graph</span>,
              f2_blocks_test <span class="op">=</span> <span class="va">example_f2_blocks</span><span class="op">[</span>,,<span class="op">-</span><span class="va">train</span><span class="op">]</span><span class="op">)</span>
<span class="va">res</span><span class="op">$</span><span class="va">score</span></code></pre></div>
<pre><code>## [1] 10036.18</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">res</span><span class="op">$</span><span class="va">score_test</span></code></pre></div>
<pre><code>## [1] 10083.84</code></pre>
</div>
<div id="bootstrap-resampled-graph-fits" class="section level3">
<h3 class="hasAnchor">
<a href="#bootstrap-resampled-graph-fits" class="anchor"></a>Bootstrap-resampled graph fits</h3>
<p>Out-of-sample scores allow us to get fair comparisons for any two admixture graphs, but they still donâ€™t tell us whether a difference is significant. For that, we can use bootstrap resampling of SNP blocks: Each graph is evaluated many times on a random subset of SNP blocks. The variation among those scores tells us whether the scores of both graphs are significantly different from one another.</p>
<p>To combine this idea with out-of-sample scores to prevent overfitting, we can use the SNP blocks which were not selected in each bootstrap iteration as the out-of-sample SNP blocks.</p>
<p>The following example shows how to test whether <code>graph1</code> gives a significantly better fit than <code>graph2</code>:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">pops</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span><span class="op">(</span><span class="va">example_f2_blocks</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">graph1</span> <span class="op">=</span> <span class="va">example_winners</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">score</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">'igraph'</span>, <span class="fl">1</span><span class="op">)</span>
<span class="va">graph2</span> <span class="op">=</span> <span class="va">example_winners</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="va">score</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">'igraph'</span>, <span class="fl">100</span><span class="op">)</span>
<span class="va">fits</span> <span class="op">=</span> <span class="fu"><a href="../reference/qpgraph_resample_multi.html">qpgraph_resample_multi</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">graph1</span>, <span class="va">graph2</span><span class="op">)</span>, nboot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="fu">compare_fits3</span><span class="op">(</span><span class="va">fits</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">score_test</span>, <span class="va">fits</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">score_test</span><span class="op">)</span></code></pre></div>
<p>Fitting a graph multiple times on different sets of SNPs is not only useful for comparing two graphs. It also allows us to put confidence intervals on the parameters estimated in a single graph.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fits</span> <span class="op">=</span> <span class="fu"><a href="../reference/resample_snps.html">qpgraph_resample_snps</a></span><span class="op">(</span><span class="va">example_f2_blocks</span>, <span class="va">example_igraph</span>, boot <span class="op">=</span> <span class="fl">100</span><span class="op">)</span>
<span class="va">fits</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/summarize_fits.html">summarize_fits</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span>print_highlow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-b6ac80da83cd172f16ad" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b6ac80da83cd172f16ad">{"x":{"data":[{"x":[-1,1],"y":[-1,-2],"text":"N3N5 -> N3N8","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,-1)","legendgroup":"(admix,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4,0],"y":[0,-1],"text":"N2N3 -> N2N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-1],"y":[1,0],"text":"N3N2 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,-1],"y":[2,0],"text":"N3N3 -> N3N4","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0,null,1,1],"y":[3,-1,null,3,-2],"text":["N2N2 -> N2N4","N2N2 -> N2N4",null,"N3N7 -> N3N8","N3N7 -> N3N8"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"dot"},"hoveron":"points","name":"(admix,3)","legendgroup":"(admix,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1,1],"y":[-2,-3],"text":"N3N8 -> Russia_Ust_Ishim.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-2)","legendgroup":"(normal,-2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0],"y":[-1,-2],"text":"N2N4 -> Mbuti.DG","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(216,144,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,-1],"y":[0,-1],"text":"N3N4 -> N3N5","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(163,165,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.5,-4,null,-3.5,-3],"y":[1,0,null,1,0],"text":["N2N1 -> N2N3","N2N1 -> N2N3",null,"N2N1 -> Vindija.DG","N2N1 -> Vindija.DG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(57,182,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3,-3.5,null,-3,-2.5],"y":[2,1,null,2,1],"text":["N3N0 -> N2N1","N3N0 -> N2N1",null,"N3N0 -> N3N2","N3N0 -> N3N2"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,125,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.5,-4,null,-3.5,-3,null,-1.5,-2,null,-1.5,-1],"y":[3,2,null,3,2,null,3,2,null,3,2],"text":["N0N -> Altai_Neanderthal.DG","N0N -> Altai_Neanderthal.DG",null,"N0N -> N3N0","N0N -> N3N0",null,"N3N1 -> Denisova.DG","N3N1 -> Denisova.DG",null,"N3N1 -> N3N3","N3N1 -> N3N3"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.5,-3.5,null,-2.5,-1.5,null,0.5,0,null,0.5,1],"y":[4,3,null,4,3,null,4,3,null,4,3],"text":["N1N -> N0N","N1N -> N0N",null,"N1N -> N3N1","N1N -> N3N1",null,"N3N6 -> N2N2","N3N6 -> N2N2",null,"N3N6 -> N3N7","N3N6 -> N3N7"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,176,246,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1,-2.5,null,-1,0.5],"y":[5,4,null,5,4],"text":["N2N0 -> N1N","N2N0 -> N1N",null,"N2N0 -> N3N6","N2N0 -> N3N6"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(149,144,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5,-1,null,-0.5,0],"y":[6,5,null,6,5],"text":["N4N -> N2N0","N4N -> N2N0",null,"N4N -> Switzerland_Bichon.SG","N4N -> Switzerland_Bichon.SG"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(231,107,243,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,null,0,-0.5],"y":[7,6,null,7,6],"text":["R -> Chimp.REF","R -> Chimp.REF",null,"R -> N4N","R -> N4N"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,98,188,1)","dash":"solid"},"hoveron":"points","name":"(normal,7)","legendgroup":"(normal,7)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.5,-2.5,-1,-3.5,0,-4,0,-3,-1.5,-2.5,-1,-1,-1,0.5,1,1,-0.5,0],"y":[3,4,5,1,3,0,-1,2,3,1,2,0,-1,4,3,-2,6,7],"text":["N0N","N1N","N2N0","N2N1","N2N2","N2N3","N2N4","N3N0","N3N1","N3N2","N3N3","N3N4","N3N5","N3N6","N3N7","N3N8","N4N","R"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3.75,-3.25,-3,-2,-1.75,-0.25,-3.75,-3.25,0,-2,0,-3.25,-2.75,-1.75,-1.25,-1.75,-1,-1,0,0.25,0.75,1,1,-0.75,-0.25,0.25,-0.25],"y":[2.5,2.5,3.5,3.5,4.5,4.5,0.5,0.5,1,-0.5,-1.5,1.5,1.5,2.5,2.5,0.5,1,-0.5,-1.5,3.5,3.5,0.5,-2.5,5.5,5.5,6.5,6.5],"text":["4<br />[1-7]","10<br />[2-15]","84<br />[78-90]","36<br />[33-40]","38<br />[34-43]","15<br />[12-18]","0<br />[0-0]","1<br />[0-4]","100%<br />[100%-100%]","0%<br />[0%-0%]","12<br />[10-15]","1<br />[0-4]","0<br />[0-0]","36<br />[33-40]","0<br />[0-0]","100%<br />[100%-100%]","0%<br />[0%-0%]","0<br />[0-0]","6%<br />[3%-9%]","12<br />[10-15]","1<br />[0-4]","94%<br />[91%-97%]","1<br />[0-4]","0<br />[0-0]","222<br />[216-228]","73<br />[71-74]","73<br />[71-74]"],"hovertext":["N0N -> Altai_Neanderthal.DG","N0N -> N3N0","N1N -> N0N","N1N -> N3N1","N2N0 -> N1N","N2N0 -> N3N6","N2N1 -> N2N3","N2N1 -> Vindija.DG","N2N2 -> N2N4","N2N3 -> N2N4","N2N4 -> Mbuti.DG","N3N0 -> N2N1","N3N0 -> N3N2","N3N1 -> Denisova.DG","N3N1 -> N3N3","N3N2 -> N3N4","N3N3 -> N3N4","N3N4 -> N3N5","N3N5 -> N3N8","N3N6 -> N2N2","N3N6 -> N3N7","N3N7 -> N3N8","N3N8 -> Russia_Ust_Ishim.DG","N4N -> N2N0","N4N -> Switzerland_Bichon.SG","R -> Chimp.REF","R -> N4N"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[-3.1],"text":"Russia_Ust_Ishim.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-2,1)","legendgroup":"(-2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[-2.1],"text":"Mbuti.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(216,144,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-3],"y":[-0.1],"text":"Vindija.DG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(57,182,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-4,-2],"y":[1.9,1.9],"text":["Altai_Neanderthal.DG","Denisova.DG"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0],"y":[4.9],"text":"Switzerland_Bichon.SG","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(231,107,243,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5],"y":[5.9],"text":"Chimp.REF","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,98,188,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(7,1)","legendgroup":"(7,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-4.6,1.6],"tickmode":"array","ticktext":["-4","-2","0"],"tickvals":[-4,-2,0],"categoryorder":"array","categoryarray":["-4","-2","0"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-3.605,7.505],"tickmode":"array","ticktext":["-2.5","0.0","2.5","5.0","7.5"],"tickvals":[-2.5,-4.44089209850063e-16,2.5,5,7.5],"categoryorder":"array","categoryarray":["-2.5","0.0","2.5","5.0","7.5"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870baf8ca24":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b539f071c":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b6d8bea27":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b7cb9dea0":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870baf8ca24","visdat":{"870baf8ca24":["function (y) ","x"],"870b539f071c":["function (y) ","x"],"870b6d8bea27":["function (y) ","x"],"870b7cb9dea0":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="summarizing-graphs" class="section level2">
<h2 class="hasAnchor">
<a href="#summarizing-graphs" class="anchor"></a>Summarizing graphs</h2>
<p>Admixture graphs for more than a few populations quickly become very complex. They contain a large amount of information about the relationship between the modeled populations, which is another way of saying that the number of possible graphs grows rapidly as the number of populations and the number of admixture events grows.</p>
<p>Often there are specific features of an admixture graph that are of primary interest. For example, whether a population is admixed or unadmixed, relative to the other modeled populations, or what the temporal order of two events is (whether one population split occurred before or after another population split).</p>
<p><em>ADMIXTOOLS 2</em> offers a number of functions that can summarize graphs by listing their features, as well as functions that can be used to test whether graphs exhibits specific features. This is useful in several contexts, for example it can constrain the search space for finding well fitting graphs, by not considering graphs with specific properties.</p>
<p>At the moment there are three types of features or constraints, and for each there is a function for listing the graph features, and a function for testing whether a graph meets certain constraints.</p>
<table class="table">
<thead><tr class="header">
<th>Feature / Constraint</th>
<th>Summarize graph</th>
<th>Test graph</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Number of admixing sources</td>
<td><code><a href="../reference/summarize_numadmix.html">summarize_numadmix()</a></code></td>
<td><code><a href="../reference/satisfies_numadmix.html">satisfies_numadmix()</a></code></td>
</tr>
<tr class="even">
<td>Order of events</td>
<td><code><a href="../reference/summarize_eventorder.html">summarize_eventorder()</a></code></td>
<td><code><a href="../reference/satisfies_eventorder.html">satisfies_eventorder()</a></code></td>
</tr>
<tr class="odd">
<td>Zero f4</td>
<td><code><a href="../reference/summarize_zerof4.html">summarize_zerof4()</a></code></td>
<td><code><a href="../reference/satisfies_zerof4.html">satisfies_zerof4()</a></code></td>
</tr>
</tbody>
</table>
<div id="number-of-admixing-sources" class="section level3">
<h3 class="hasAnchor">
<a href="#number-of-admixing-sources" class="anchor"></a>Number of admixing sources</h3>
<p>To put constraints on the number of admixtures for some of our populations, we can create a data frame with columns <code>pop</code>, <code>min</code>, <code>max</code>. The following example shows how to specify that population <em>C</em> should have at least one admixture event, while <em>D</em> should be unadmixed:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">constrain_cd</span> <span class="op">=</span> <span class="fu">tribble</span><span class="op">(</span>
  <span class="op">~</span><span class="va">pop</span>, <span class="op">~</span><span class="va">min</span>, <span class="op">~</span><span class="va">max</span>,
  <span class="st">'C'</span>, <span class="fl">1</span>, <span class="cn">NA</span>,
  <span class="st">'D'</span>, <span class="cn">NA</span>, <span class="fl">0</span><span class="op">)</span></code></pre></div>
<p>This can be used to test whether a graph meets these constraints:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="../reference/satisfies_numadmix.html">satisfies_numadmix</a></span><span class="op">(</span><span class="va">g</span>, admix_constraints <span class="op">=</span> <span class="va">constrain_cd</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>If we have a list of admixture graphs, we could select only those that meet the constraints:</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">graphlist</span> <span class="op">=</span> <span class="fu">rerun</span><span class="op">(</span><span class="fl">10</span>, <span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="va">graphlist2</span> <span class="op">=</span> <span class="va">graphlist</span> <span class="op">%&gt;%</span> <span class="fu">keep</span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="../reference/satisfies_numadmix.html">satisfies_numadmix</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">constrain_cd</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>And if we want to filter the output of <code><a href="../reference/find_graphs.html">find_graphs()</a></code>, we could do it with this expresession:</p>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results_filtered</span> <span class="op">=</span> <span class="va">results</span> <span class="op">%&gt;%</span> <span class="va">rowwise</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="../reference/satisfies_numadmix.html">satisfies_numadmix</a></span><span class="op">(</span><span class="va">igraph</span>, <span class="va">constrain_cd</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">ungroup</span></code></pre></div>
<p>We can also generate a random graph that satisfies these constraints:</p>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">2</span>, admix_constraints <span class="op">=</span> <span class="va">constrain_cd</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="va">plotly_graph</span></code></pre></div>
<div id="htmlwidget-539f41c64e90bba98176" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-539f41c64e90bba98176">{"x":{"data":[{"x":[-1.375,1.625],"y":[1,0],"text":"Rllmj -> admixp","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(183,159,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,1)","legendgroup":"(admix,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.375,-0.375],"y":[2,1],"text":"Rllm -> admix","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.125,-0.375,null,1.125,1.625],"y":[4,1,null,4,0],"text":["Rl -> admix","Rl -> admix",null,"Rr -> admixp","Rr -> admixp"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,4)","legendgroup":"(admix,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.625,1.625],"y":[0,-1],"text":"admixp -> C","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.375,-0.375,null,-1.375,-1.375],"y":[1,0,null,1,0],"text":["admix -> A","admix -> A",null,"Rllmj -> B","Rllmj -> B"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(183,159,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.375,-1.375],"y":[2,1],"text":"Rllm -> Rllmj","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.875,-2.375,null,-1.875,-1.375],"y":[3,2,null,3,2],"text":["Rll -> E","Rll -> E",null,"Rll -> Rllm","Rll -> Rllm"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.125,-1.875,null,1.125,0.625],"y":[4,3,null,4,3],"text":["Rl -> Rll","Rl -> Rll",null,"Rr -> D","Rr -> D"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1.125,null,0,1.125],"y":[5,4,null,5,4],"text":["R -> Rl","R -> Rl",null,"R -> Rr","R -> Rr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(245,100,227,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-1.125,-1.875,1.125,-0.375,-1.375,-1.375,1.625],"y":[5,4,3,4,1,2,1,0],"text":["R","Rl","Rll","Rr","admix","Rllm","Rllmj","admixp"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5625,-1.5,-2.125,0.5625,0.875,-1.625,-0.75,-0.375,-0.875,-1.375,-1.375,1.375,1.625,0.125],"y":[4.5,3.5,2.5,4.5,3.5,2.5,2.5,0.5,1.5,1.5,0.5,2,-0.5,0.5],"text":["","","","","","","","","","","","","",""],"hovertext":["R -> Rl","Rl -> Rll","Rll -> E","R -> Rr","Rr -> D","Rll -> Rllm","Rl -> admix","admix -> A","Rllm -> admix","Rllm -> Rllmj","Rllmj -> B","Rr -> admixp","admixp -> C","Rllmj -> admixp"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1.625],"y":[-1.1],"text":"C","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.375,-1.375],"y":[-0.1,-0.1],"text":["A","B"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(183,159,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"1","legendgroup":"1","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.375],"y":[1.9],"text":"E","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(0,191,196,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(3,1)","legendgroup":"(3,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.625],"y":[2.9],"text":"D","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(97,156,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(4,1)","legendgroup":"(4,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.875,2.125],"tickmode":"array","ticktext":["-2","-1","0","1","2"],"tickvals":[-2,-1,0,1,2],"categoryorder":"array","categoryarray":["-2","-1","0","1","2"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-1.405,5.305],"tickmode":"array","ticktext":["0","2","4"],"tickvals":[0,2,4],"categoryorder":"array","categoryarray":["0","2","4"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870b5c205adc":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b502d50c4":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b4f119cfb":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870bd594b4b":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870b5c205adc","visdat":{"870b5c205adc":["function (y) ","x"],"870b502d50c4":["function (y) ","x"],"870b4f119cfb":["function (y) ","x"],"870bd594b4b":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="order-of-events" class="section level3">
<h3 class="hasAnchor">
<a href="#order-of-events" class="anchor"></a>Order of events</h3>
<p>We can test whether one population split occurs before another one, and whether a leaf population branches off before or after a split event. The following example shows how we can specify that the split between <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> should occur before the split between <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span>, and further that the split between <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> should occur before the branching off of <span class="math inline">\(E\)</span>.</p>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">events</span> <span class="op">=</span> <span class="fu">tribble</span><span class="op">(</span>
  <span class="op">~</span><span class="va">earlier1</span>, <span class="op">~</span><span class="va">earlier2</span>, <span class="op">~</span><span class="va">later1</span>, <span class="op">~</span><span class="va">later2</span>,
  <span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>, <span class="st">'D'</span>,
  <span class="st">'C'</span>, <span class="st">'D'</span>, <span class="st">'E'</span>, <span class="cn">NA</span><span class="op">)</span>
<span class="fu"><a href="../reference/satisfies_eventorder.html">satisfies_eventorder</a></span><span class="op">(</span><span class="va">g</span>, eventorder <span class="op">=</span> <span class="va">events</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<p>Filtering lists of graphs and generating random graphs meeting these constraints work analogously to the example above.</p>
</div>
<div id="non-zero-f4-statistics" class="section level3">
<h3 class="hasAnchor">
<a href="#non-zero-f4-statistics" class="anchor"></a>Non-zero f4-statistics</h3>
<p>Finally, we can test whether a set of <span class="math inline">\(f_4\)</span>-statistics is zero in a graph.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sigf4</span> <span class="op">=</span> <span class="fu"><a href="../reference/qpdstat.html">f4</a></span><span class="op">(</span><span class="va">f2_blocks</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">select</span><span class="op">(</span><span class="va">pop1</span><span class="op">:</span><span class="va">pop4</span><span class="op">)</span>
<span class="fu"><a href="../reference/satisfies_zerof4.html">satisfies_zerof4</a></span><span class="op">(</span><span class="va">g</span>, nonzero_f4 <span class="op">=</span> <span class="va">sigf4</span><span class="op">)</span></code></pre></div>
<!-- For any set of populations there may be many graphs which can explain the data about equally well, with no significant difference in likelihood scores. Rather than declaring one of these models as the correct model, it may be more useful to find features that are shared between all models with good fits. The following function attempts to find such features by summarizing a set of graphs. It counts how often each population triple occurs in which configuration across all graphs. -->
<!-- ```{r, eval = FALSE} -->
<!-- triples = summarize_triples(winners) -->
<!-- ``` -->
<!-- ```{r, echo = FALSE} -->
<!-- triples = example_triples -->
<!-- ``` -->
<!-- ```{r} -->
<!-- triples %>% arrange(-clade) %>% slice(1) -->
<!-- ``` -->
<!-- The output for this population triple (1: `Rus`, 2: `Swi`, 3: `Den`) can be read like this: -->
<!-- * `numgraphs`: 200 graphs were compared -->
<!-- * `clade`: In 34.5% of all graphs `Rus` and `Swi` form a clade with respect to `Den` -->
<!-- * `x13`: In 0.5% of all graphs `Rus` is closer to `Den` than `Swi` is to `Den`, with ancestors of `Rus` admixing into `Den` -->
<!-- * `x31`: In 50.5% of all graphs `Rus` is closer to `Den` than `Swi` is to `Den`, with ancestors of `Den` admixing into `Rus` -->
<!-- * `x23`: In 24.5% of all graphs `Swi` is closer to `Den` than `Rus` is to `Den`, with ancestors of `Swi` admixing into `Den` -->
<!-- * `x32`: In 38.0% of all graphs `Swi` is closer to `Den` than `Rus` is to `Den`, with ancestors of `Den` admixing into `Swi` -->
<!-- * `toptopo`: The most common topology for this triple across all graphs. `011111` specifies a topology where condition `x13` is not satisfied, but conditions `x23`, `x31`, `x32`, `x12`, and `x21` are satisfied. A topology starting with `0000` is one where the first two populations form a clade. -->
<!-- * `toptopocnt`: The number of times `toptopo` was observed -->
<!-- * `topos`: The number of times each topology was observed -->
<!-- <br> -->
</div>
</div>
<div id="simulating-genetic-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-genetic-data" class="anchor"></a>Simulating genetic data</h2>
<p><em>ADMIXTOOLS 2</em> makes it easy to simulate genetic data under a given admixture graph with the help of <a href="https://msprime.readthedocs.io/en/stable/">msprime</a>. This requires a python installation with the <em>msprime</em> module.</p>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/uqrmaie1/admixtools">admixtools</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>
<span class="va">g</span> <span class="op">=</span> <span class="fu"><a href="../reference/random_admixturegraph.html">random_admixturegraph</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">2</span>, outpop <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotly_graph.html">plotly_graph</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></code></pre></div>
<div id="htmlwidget-4333dff4fe38e219c01c" style="width:700px;height:432.632880098888px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4333dff4fe38e219c01c">{"x":{"data":[{"x":[0.875,-0.125],"y":[0,-1],"text":"admixo -> admixn","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"dot"},"hoveron":"points","name":"(admix,0)","legendgroup":"(admix,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.125,0.875,null,-0.125,-0.125],"y":[2,1,null,2,-1],"text":["Rrlld -> admix","Rrlld -> admix",null,"Rrlld -> admixn","Rrlld -> admixn"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"dot"},"hoveron":"points","name":"(admix,2)","legendgroup":"(admix,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.875],"y":[4,1],"text":"Rrl -> admix","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"dot"},"hoveron":"points","name":"(admix,4)","legendgroup":"(admix,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.125,-0.125],"y":[-1,-2],"text":"admixn -> E","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","name":"(normal,-1)","legendgroup":"(normal,-1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.875,0.875],"y":[0,-1],"text":"admixo -> D","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(205,150,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,0)","legendgroup":"(normal,0)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.875,0.875],"y":[1,0],"text":"admix -> admixo","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(124,174,0,1)","dash":"solid"},"hoveron":"points","name":"(normal,1)","legendgroup":"(normal,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-1.625,-2.125,null,-1.625,-1.125],"y":[2,1,null,2,1],"text":["Rrllr -> F","Rrllr -> F",null,"Rrllr -> C","Rrllr -> C"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,190,103,1)","dash":"solid"},"hoveron":"points","name":"(normal,2)","legendgroup":"(normal,2)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.875,-1.625,null,-0.875,-0.125],"y":[3,2,null,3,2],"text":["Rrll -> Rrllr","Rrll -> Rrllr",null,"Rrll -> Rrlld","Rrll -> Rrlld"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,191,196,1)","dash":"solid"},"hoveron":"points","name":"(normal,3)","legendgroup":"(normal,3)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.875],"y":[4,3],"text":"Rrl -> Rrll","type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,169,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,4)","legendgroup":"(normal,4)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.5,0,null,0.5,1],"y":[5,4,null,5,4],"text":["Rr -> Rrl","Rr -> Rrl",null,"Rr -> B","Rr -> B"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(199,124,255,1)","dash":"solid"},"hoveron":"points","name":"(normal,5)","legendgroup":"(normal,5)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,-0.5,null,0,0.5],"y":[6,5,null,6,5],"text":["R -> A","R -> A",null,"R -> Rr","R -> Rr"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,204,1)","dash":"solid"},"hoveron":"points","name":"(normal,6)","legendgroup":"(normal,6)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0,0.5,0,-0.875,-1.625,-0.125,0.875,0.875,-0.125],"y":[6,5,4,3,2,2,1,0,-1],"text":["R","Rr","Rrl","Rrll","Rrllr","Rrlld","admix","admixo","admixn"],"type":"scatter","mode":"markers","marker":{"autocolorscale":false,"color":"rgba(0,0,0,1)","opacity":0,"size":5.66929133858268,"symbol":"circle","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)"}},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.25,0.25,0.25,-0.4375,-1.25,-1.875,-1.375,0.75,-0.5,0.4375,0.375,0.875,0.875,-0.125,-0.125,0.375],"y":[5.5,5.5,4.5,3.5,2.5,1.5,1.5,4.5,2.5,2.5,1.5,0.5,-0.5,0.5,-1.5,-0.5],"text":["","","","","","","","","","","","","","","",""],"hovertext":["R -> A","R -> Rr","Rr -> Rrl","Rrl -> Rrll","Rrll -> Rrllr","Rrllr -> F","Rrllr -> C","Rr -> B","Rrll -> Rrlld","Rrl -> admix","Rrlld -> admix","admix -> admixo","admixo -> D","Rrlld -> admixn","admixn -> E","admixo -> admixn"],"textfont":{"size":9.4488188976378,"color":"rgba(0,0,0,1)"},"type":"scatter","mode":"text","hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.125],"y":[-2.1],"text":"E","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(248,118,109,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(-1,1)","legendgroup":"(-1,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[0.875],"y":[-1.1],"text":"D","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(205,150,0,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(0,1)","legendgroup":"(0,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-2.125,-1.125],"y":[0.9,0.9],"text":["F","C"],"hovertext":["",""],"textfont":{"size":9.4488188976378,"color":"rgba(0,190,103,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(2,1)","legendgroup":"(2,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[1],"y":[3.9],"text":"B","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(199,124,255,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(5,1)","legendgroup":"(5,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[-0.5],"y":[4.9],"text":"A","hovertext":"","textfont":{"size":9.4488188976378,"color":"rgba(255,97,204,1)"},"type":"scatter","mode":"text","hoveron":"points","name":"(6,1)","legendgroup":"(6,1)","showlegend":true,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":27.8246364188244,"r":7.30593607305936,"b":15.4776044553541,"l":10.958904109589},"paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.5375,1.4125],"tickmode":"array","ticktext":["-2","-1","0","1"],"tickvals":[-2,-1,0,1],"categoryorder":"array","categoryarray":["-2","-1","0","1"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-2.505,6.405],"tickmode":"array","ticktext":["-2","0","2","4","6"],"tickvals":[-2,0,2,4,6],"categoryorder":"array","categoryarray":["-2","0","2","4","6"],"nticks":null,"ticks":"","tickcolor":null,"ticklen":3.65296803652968,"tickwidth":0,"showticklabels":false,"tickfont":{"color":null,"family":null,"size":0},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","showSendToCloud":false},"source":"A","attrs":{"870be8ef06a":{"linetype":{},"colour":{},"text":{},"x":{},"y":{},"xend":{},"yend":{},"from":{},"to":{},"type":"scatter"},"870b4a49c69d":{"x":{},"y":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b318e9385":{"x":{},"y":{},"label":{},"text":{},"x.1":{},"y.1":{},"xend":{},"yend":{},"from":{},"to":{}},"870b7771a2e":{"label":{},"colour":{},"from":{},"x":{},"y":{},"xend":{},"yend":{},"from.1":{},"to":{}}},"cur_data":"870be8ef06a","visdat":{"870be8ef06a":["function (y) ","x"],"870b4a49c69d":["function (y) ","x"],"870b318e9385":["function (y) ","x"],"870b7771a2e":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outprefix</span> <span class="op">=</span> <span class="st">'/my/outdir/prefix'</span>
<span class="fu"><a href="../reference/msprime_sim.html">msprime_sim</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">outprefix</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span>, ind_per_pop <span class="op">=</span> <span class="fl">100</span>, numcores <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f2_blocks</span> <span class="op">=</span> <span class="fu"><a href="../reference/f2_from_geno.html">f2_from_geno</a></span><span class="op">(</span><span class="va">outprefix</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>The last two steps can also be combined into one step with the <code>f2_from_graph()</code> function.</p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">f2_blocks</span> <span class="op">=</span> <span class="fu"><a href="../reference/f2_from_simulation.html">f2_from_simulation</a></span><span class="op">(</span><span class="va">g</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span>, ind_per_pop <span class="op">=</span> <span class="fl">100</span>, numcores <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></code></pre></div>
<p>As expected, the graph under which the data were simulated has a very good fit:</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qpgraph.html">qpgraph</a></span><span class="op">(</span><span class="va">f2_blocks</span>, <span class="va">g</span><span class="op">)</span><span class="op">$</span><span class="va">score</span></code></pre></div>
<pre><code>## [1] 525.6257</code></pre>
<p>An admixture graph only captures some of the parameters which determine the full demographic history (particularly when is hasnâ€™t been fitted and there is just a topology). Therefore, some assumptions are being made when simulations are generated by <code><a href="../reference/msprime_sim.html">msprime_sim()</a></code>:</p>
<ul>
<li>Effective population size and mutation rates are constant</li>
<li>Time points of branch splits and admixture events are proportional to the position on the y-axis of the graph representation created by <code><a href="../reference/plotly_graph.html">plotly_graph()</a></code>
</li>
<li>All admixture proportions are in 30/70 proportions</li>
<li>All SNPs are independent. This is achieved by simulating a single SNP at a time, and is justified by the fact that the block-jackknife/bootstrap method which is used throughout <em>ADMIXTOOLS 2</em> adequately controls for the effects of linked SNPs.</li>
</ul>
<p>Some of these assumptions are not realistic and are only here for convenience and to reduce the simulation run time. Feel free to e-mail me suggestions for more sensible defaults.</p>
<p>If you want to override any of the default assumptions, you can do so in three ways:</p>
<ol style="list-style-type: decimal">
<li>
<p>By supplying a fitted graph to the <code><a href="../reference/msprime_sim.html">msprime_sim()</a></code> function</p>
<p>In this case, admixture weights of the fitted graph will be directly translated into simulated admixture proportions. Fitted drift lengths represent an unknown combination of time and effective population size. <code><a href="../reference/msprime_sim.html">msprime_sim()</a></code> will simulated fitted drift lengths by adjusting effective population sizes of the relevant populations.</p>
</li>
<li>
<p>By adjusting the <code>neff</code>, <code>time</code>, or <code>ind_per_pop</code> parameters of the <code><a href="../reference/msprime_sim.html">msprime_sim()</a></code> function</p>
<p>As in this example:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/msprime_sim.html">msprime_sim</a></span><span class="op">(</span><span class="va">g</span>, <span class="va">outprefix</span>, nsnps <span class="op">=</span> <span class="fl">1e5</span>,
            <span class="co"># neff should be specified for all nodes</span>
            neff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>R <span class="op">=</span> <span class="fl">1e4</span>, Rr <span class="op">=</span> <span class="fl">1000</span>, A <span class="op">=</span> <span class="fl">10</span>, B <span class="op">=</span> <span class="fl">100</span>, C <span class="op">=</span> <span class="fl">1000</span>, <span class="va">...</span><span class="op">)</span>,
            <span class="co"># time in generations (not years) should be specified for all nodes</span>
            time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>R <span class="op">=</span> <span class="fl">10000</span>, Rr <span class="op">=</span> <span class="fl">9000</span>, A <span class="op">=</span> <span class="fl">2000</span>, B <span class="op">=</span> <span class="fl">0</span>, C <span class="op">=</span> <span class="fl">100</span>, <span class="va">...</span><span class="op">)</span>,
            <span class="co"># ind_per_pop should be specified for all leaf nodes</span>
            ind_per_pop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fl">10</span>, B <span class="op">=</span> <span class="fl">100</span>, D <span class="op">=</span> <span class="fl">10</span>, <span class="va">...</span><span class="op">)</span>
            <span class="op">)</span></code></pre></div>
</li>
<li>
<p>By manually modifying the msprime simulation python script.</p>
<p><code><a href="../reference/msprime_sim.html">msprime_sim()</a></code> will create a file <code>[outprefix].py</code> which may need to be modified before running the simulation.</p>
</li>
</ol>
</div>
<div id="finding-valid-qpadm-models" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-valid-qpadm-models" class="anchor"></a>Finding valid qpAdm models</h2>
<p>Every admixture graph maps to a specific set of valid qpAdm models. The function <code>qpadm_models</code> lists all valid qpAdm models for a graph. Models which are contained within larger valid models are not shown. The number of valid qpAdm models can be very large for big graphs, so you should only run this on small graphs.</p>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mygraph</span> <span class="op">=</span> <span class="va">winners</span> <span class="op">%&gt;%</span> <span class="fu">pluck</span><span class="op">(</span><span class="st">'igraph'</span>, <span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot_graph.html">plot_graph</a></span><span class="op">(</span><span class="va">mygraph</span><span class="op">)</span></code></pre></div>
<p><img src="graphs_files/figure-html/unnamed-chunk-52-1.png" width="864" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/qpadm_models.html">qpadm_models</a></span><span class="op">(</span><span class="va">mygraph</span>, add_outgroup <span class="op">=</span> <span class="cn">TRUE</span>, nested <span class="op">=</span> <span class="cn">FALSE</span>, abbr <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   target left    right      
##   &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;      
## 1 Den    Alt,Mbu Chi,Rus,Swi
## 2 Den    Alt,Vin Chi,Rus,Swi
## 3 Den    Mbu,Vin Chi,Rus,Swi</code></pre>
<p>The only qpAdm models which are valid under this graph have <code>Den</code> as target and <code>Chi</code>, <code>Rus</code>, and <code>Swi</code> as right populations.</p>
<p>Valid qpAdm models need to satisfy the following criteria:</p>
<ul>
<li>There have to be more right populations than left populations</li>
<li>The left populations should not form a clade with respect to any right population. This means that a qpgraph outgroup is not an informative right population, but it can be included anyway, with <code>add_outgroup</code>.</li>
<li>Each set of left populations which forms a source for the target population has to form a clade with target at the exclusion of each right population. (Note: Check if thatâ€™s correct and if it can be stated in a better way.)</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Robert Maier, Nick Patterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'c30b6be96312414d83a0ba52b94b558b',
    indexName: 'admixtools',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
