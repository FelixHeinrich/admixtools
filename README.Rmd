---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file --->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  out.width = "100%",
  fig.path = "man/figures/"
)
```


# admixtools

Lightning fast R implementations of [AdmixTools](https://github.com/DReichLab/AdmixTools) programs qpAdm, qpGraph, and more.

## Installation

To install and load `admixtools`, follow these steps:

```{r, eval=FALSE}
devtools::install_github("uqrmaie1/admixtools")
library("admixtools")
```

```{r, echo=FALSE}
library('admixtools')
```


## Usage

If you already have precomputed f2-statistics, you can fit an admixture graph like this:

```{r, eval = FALSE}
f2_dir = "/my/f2/directory/"
fit = qpgraph(f2_dir, example_graph)
plot_graph(fit$edges)
```


![example graph](man/figures/graph1.png)

Clearly not a historically accurate model, but it gets the idea across.

<br>

You can also use the f2-statistics to estimate admixture weights: 
```{r}
target = "Denisova.DG"
left = c("Altai_Neanderthal.DG", "Vindija.DG")
right = c("Chimp.REF", "Mbuti.DG", "Russia_Ust_Ishim.DG", "Switzerland_Bichon.SG")
```
```{r, eval = FALSE}
qpadm(f2_dir, target, left, right)
```
```{r, echo = FALSE}
qpadm(example_f2_blocks, target, left, right)
```

More documentation [here](https://uqrmaie1.github.io/admixtools/articles/admixtools.html).

Alternatively, you can launch an interactive browser app on your local machine:

```{r, eval = FALSE}
run_shiny_admixtools()
```

